
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>urban heat islands &#8212; space cameras and glaciers</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" href="../../../_static/customstyle.css" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="../../../_static/design-tabs.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="hyperspectral image analysis" href="week2.html" />
    <link rel="prev" title="practicals" href="index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">space cameras and glaciers</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../whataboutbob.html">
   about me
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../index.html">
   teaching and related resources
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../egm101/index.html">
     EGM101: skills toolbox
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm101/lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../egm101/practicals/index.html">
       practicals
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
      <label for="toctree-checkbox-3">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm101/practicals/week5.html">
         computation, summary statistics, and graphing in excel
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm101/practicals/week6.html">
         summarizing and graphing data in spss
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm101/practicals/week7.html">
         correlation and regression in spss
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm101/practicals/week8.html">
         hypothesis testing using spss
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm101/resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../egm310/index.html">
     EGM310: introduction to gis and remote sensing
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm310/lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm310/resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../egm702/index.html">
     EGM702: photogrammetry and advanced image analysis
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm702/lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../egm702/practicals/index.html">
       practicals
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
      <label for="toctree-checkbox-6">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/setup.html">
         software setup
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/week1.html">
         dem processing using micmac
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/week2.html">
         dem differencing
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/week3.html">
         introduction to google earth engine
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/week4.html">
         change detection in earth engine
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/week5.html">
         classification in earth engine
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm702/resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="../index.html">
     EGM703: advanced active and passive remote sensing
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="../lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3 current active has-children">
      <a class="reference internal" href="index.html">
       practicals
      </a>
      <input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
      <label for="toctree-checkbox-8">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul class="current">
       <li class="toctree-l4 current active">
        <a class="current reference internal" href="#">
         urban heat islands
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="week2.html">
         hyperspectral image analysis
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="week3.html">
         SAR image processing
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="week4.html">
         InSAR Processing
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="week5.html">
         SAR image interpretation and flood mapping
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../egm722/index.html">
     EGM722: programming for gis and remote sensing
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../egm722/setup/index.html">
       setup
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
      <label for="toctree-checkbox-10">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/setup/github.html">
         setting up github
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/setup/git.html">
         installing git
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/setup/desktop.html">
         installing github desktop
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/setup/fork.html">
         forking the repository
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/setup/clone.html">
         cloning the repository
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/setup/conda.html">
         setting up conda/anaconda
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/setup/environment.html">
         setting up a conda environment
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/setup/jupyter.html">
         configuring jupyter
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/setup/pycharm.html">
         pycharm
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm722/lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../egm722/faq/index.html">
       help! something went wrong!
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
      <label for="toctree-checkbox-11">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/faq/git.html">
         git troubleshooting
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/faq/python.html">
         python troubleshooting
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../egm722/practicals/index.html">
       practicals
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
      <label for="toctree-checkbox-12">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/practicals/week1.html">
         intro to python
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/practicals/debugging.html">
         debugging exercise
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/practicals/week2.html">
         mapping with cartopy
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/practicals/week3.html">
         vector data using shapely and geopandas
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/practicals/week4.html">
         raster data using rasterio
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/practicals/week5.html">
         vector and raster operations using python
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../egm722/project/index.html">
       programming project
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
      <label for="toctree-checkbox-13">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/project/github.html">
         creating a new github repository
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/project/environment.html">
         environment.yml
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm722/resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../gee/index.html">
   google earth engine
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../gee/tutorials/index.html">
     gee tutorials
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../gee/tutorials/getting_started/index.html">
       getting started
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
      <label for="toctree-checkbox-16">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/adding_exporting.html">
         adding and exporting images
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/spectral.html">
         spectral signatures
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/image_collections.html">
         image collections and vectors
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/mapping.html">
         manual mapping (digitizing)
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/band_maths.html">
         band maths
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/zonal_stats.html">
         zonal statistics
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../gee/tutorials/classification/index.html">
       image classification
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
      <label for="toctree-checkbox-17">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/classification/unsupervised.html">
         unsupervised classification
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/classification/pixel.html">
         pixel-based classification
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/classification/obia.html">
         object-based classification
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../gee/tutorials/change_detection/index.html">
       change detection
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
      <label for="toctree-checkbox-18">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/change_detection/multitemporal_composites.html">
         multi-temporal color composites
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/change_detection/repeat_classification.html">
         repeat classification
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/change_detection/cva.html">
         change vector analysis
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/change_detection/time_series.html">
         time series analysis
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../gee/tutorials/enhancement/index.html">
       image enhancement
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
      <label for="toctree-checkbox-19">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/enhancement/filtering.html">
         image filtering
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/enhancement/pansharpening.html">
         pansharpening
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/enhancement/edge_detection.html">
         edge detection
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/enhancement/unmixing.html">
         spectral unmixing
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/enhancement/pca.html">
         principle component analysis
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../gee/tutorials/advanced/index.html">
       advanced topics
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
      <label for="toctree-checkbox-20">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/advanced/animation.html">
         creating an animation
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../gee/exercises/index.html">
     sample exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../research/index.html">
   ongoing and past research projects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../github.html">
   github projects
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/teaching/egm703/practicals/week1.rst.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#getting-started">
   getting started
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#building-a-color-composite">
   building a color composite
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#converting-raw-images-to-top-of-atmosphere-radiance">
   converting raw images to top-of-atmosphere radiance
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#converting-raw-images-to-top-of-atmosphere-reflectance">
   converting raw images to top-of-atmosphere reflectance
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#atmospheric-correction-optional">
   atmospheric correction (optional)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculating-brightness-temperature">
   calculating brightness temperature
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculating-assigning-emissivity-values">
   calculating/assigning emissivity values
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#estimating-emissivity-using-partial-vegetation">
     estimating emissivity using partial vegetation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#optional-other-methods-of-estimating-emissivity">
   optional: other methods of estimating emissivity
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#assigning-emissivity-from-classified-images">
     assigning emissivity from classified images
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-sources-of-emissivity-data">
     other sources of emissivity data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#land-surface-temperature-calculation">
   land surface temperature calculation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#optional-profiling-using-the-qgis-profile-tool">
     optional: profiling using the QGIS profile tool
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#optional-profiling-using-arcgis-pro">
     optional: profiling using ArcGIS Pro
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#further-investigation">
   further investigation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notes">
   notes
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>urban heat islands</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#getting-started">
   getting started
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#building-a-color-composite">
   building a color composite
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#converting-raw-images-to-top-of-atmosphere-radiance">
   converting raw images to top-of-atmosphere radiance
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#converting-raw-images-to-top-of-atmosphere-reflectance">
   converting raw images to top-of-atmosphere reflectance
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#atmospheric-correction-optional">
   atmospheric correction (optional)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculating-brightness-temperature">
   calculating brightness temperature
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculating-assigning-emissivity-values">
   calculating/assigning emissivity values
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#estimating-emissivity-using-partial-vegetation">
     estimating emissivity using partial vegetation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#optional-other-methods-of-estimating-emissivity">
   optional: other methods of estimating emissivity
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#assigning-emissivity-from-classified-images">
     assigning emissivity from classified images
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-sources-of-emissivity-data">
     other sources of emissivity data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#land-surface-temperature-calculation">
   land surface temperature calculation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#optional-profiling-using-the-qgis-profile-tool">
     optional: profiling using the QGIS profile tool
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#optional-profiling-using-arcgis-pro">
     optional: profiling using ArcGIS Pro
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#further-investigation">
   further investigation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notes">
   notes
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="section" id="urban-heat-islands">
<h1>urban heat islands<a class="headerlink" href="#urban-heat-islands" title="Permalink to this headline">#</a></h1>
<p>For this week’s practical, we’ll learn the steps of processing a raw Landsat image through to Land Surface Temperature, with the purpose of investigating urban heat islands. In particular, by the end of this practical, you will be able to use QGIS or ArcGIS Pro to:</p>
<ul class="simple">
<li><p>convert DN images to radiance</p></li>
<li><p>calculate brightness temperature and land surface temperature</p></li>
<li><p>investigate the relationship between different landcover types and land surface temperature</p></li>
<li><p>see how emissivity values affect estimated land surface temperature</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following instructions were written using QGIS 3.16.3, which is also what the example images show. The instructions should be transferrable to other flavors of QGIS, and even ArcGIS Pro, though there may be some differences in naming/appearance.</p>
</div>
<div class="section" id="getting-started">
<h2>getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">#</a></h2>
<p>You can download the data used for this practical from the module page on Blackboard. If you don’t have access to the module page on Blackboard, you can still follow along with this practical by downloading the images from <a class="reference external" href="https://earthexplorer.usgs.gov">Earth Explorer</a>. The three Landsat images used for this practical are:</p>
<ul class="simple">
<li><p>LC08_L1TP_023031_20200705_20200913_02_T1</p></li>
<li><p>LE07_L1TP_023031_19990704_20200918_02_T1</p></li>
<li><p>LT05_L1TP_023031_19890630_20200916_02_T1</p></li>
</ul>
<p>These are, respectively, a Landsat 8 OLI/TIRS scene from 5 July 2020, a Landsat 7 ETM+ scene from 04 July 1999, and a Landsat 5 TM scene from 30 June 1990.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are downloading these images from Earth Explorer, you will need to make sure to set the nodata value for each band (NoData Value = 0), either using GDAL, QGIS, or ArcGIS.
If you don’t set the nodata value, your end results may look quite a bit different from what is shown here! The images provided over blackboard have also been cropped to make the
file sizes easier to store/download, but are otherwise the same as the ones provided by USGS.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Landsat 7 ETM+ image has two different files for Band 6: VCID_1 and VCID_2. This is because there are two different ways that USGS process these images: either high or low gain.
The main differences between the two are the levels where the image will be saturated, and the dynamic range of the image. For this application, VCID_1 is probably fine,
though you are welcome to complete the steps for both images to see the differences for yourself. Just make sure that you use the correct rescaling values from the metadata for the image!</p>
</div>
<p>Once you have unzipped/untarred your image data, open up your GIS software. We’ll start by adding the Landsat 8 image and creating a color composite of (almost) all of the bands for visualization - feel free to repeat this for each of the other two images, though the bands will be different for the TM/ETM+ images.</p>
</div>
<div class="section" id="building-a-color-composite">
<h2>building a color composite<a class="headerlink" href="#building-a-color-composite" title="Permalink to this headline">#</a></h2>
<p>In QGIS, the tool to use can be found under <strong>Raster</strong> &gt; <strong>Miscellaneous</strong> &gt; <strong>Build Virtual Raster</strong>:</p>
<a class="reference internal image-reference" href="../../../_images/build_virtual_raster.png"><img alt="the build virtual raster window" class="align-center" src="../../../_images/build_virtual_raster.png" style="width: 600px;" /></a>
<p><br /> In ArcGIS Pro, the tool to use is
<a class="reference external" href="https://pro.arcgis.com/en/pro-app/latest/tool-reference/data-management/composite-bands.htm">Composite Bands (Data Management)</a>.</p>
<p>Click the <code class="docutils literal notranslate"><span class="pre">...</span></code> button at the top of the window, then click <strong>Add File(s)</strong> from the right-hand panel:</p>
<a class="reference internal image-reference" href="../../../_images/bvr_select_layers.png"><img alt="the 'select layers' window" class="align-center" src="../../../_images/bvr_select_layers.png" style="width: 600px;" /></a>
<p><br /> Navigate to the folder where you have the Landsat 8 image, then select each of the individual bands
(LC08_L1TP_023031_20200705_20200913_02_T1_B1.TIF, LC08_L1TP_023031_20200705_20200913_02_T1_B2.TIF, …).</p>
<p>Be sure to check <strong>Place each input file into a separate band</strong>. Under <strong>Virtual</strong>, click the <code class="docutils literal notranslate"><span class="pre">...</span></code> button and
select <strong>Save to file</strong>. Save the file to LC08_L1TP_023031_20200705_20200913_02_T1.vrt and click <strong>Run</strong>. When the
process finishes, you should see the virtual raster loaded into the map:</p>
<a class="reference internal image-reference" href="../../../_images/image_loaded.png"><img alt="the virtual raster loaded into the map window" class="align-center" src="../../../_images/image_loaded.png" style="width: 600px;" /></a>
<p><br /> You can change the symbology by double-clicking on the layer name to open the <strong>Layer Properties</strong> window,
then selecting the <strong>Symbology</strong> tab:</p>
<a class="reference internal image-reference" href="../../../_images/symbology1.png"><img alt="the symbology window" class="align-center" src="../../../_images/symbology1.png" style="width: 600px;" /></a>
<p><br /> Change the symbology to a false-color composite of bands 6, 5, and 4 (654). You can also stretch the image by
right-clicking on the layer name and selecting <strong>Stretch Using Current Extent</strong>, which can help improve the contrast
as we look at the scene.</p>
</div>
<div class="section" id="converting-raw-images-to-top-of-atmosphere-radiance">
<h2>converting raw images to top-of-atmosphere radiance<a class="headerlink" href="#converting-raw-images-to-top-of-atmosphere-radiance" title="Permalink to this headline">#</a></h2>
<p>Now that you have the image bands loaded, we can work on the first step of calculating land surface temperature:
converting the raw images to top-of-atmosphere (TOA) spectral radiance. The equation for converting the raw image
values (DNs) to radiance <span class="math notranslate nohighlight">\(L_\lambda\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[L_\lambda = M_L Q_{\rm cal} + A_L\]</div>
<p>where <span class="math notranslate nohighlight">\(M_L\)</span> is a multiplicative rescaling factor, <span class="math notranslate nohighlight">\(Q_{\rm cal}\)</span> is the DN value, and <span class="math notranslate nohighlight">\(A_L\)</span> is an
additive rescaling factor. Both <span class="math notranslate nohighlight">\(M_L\)</span> and <span class="math notranslate nohighlight">\(A_L\)</span> can be found in the metadata (<strong>MTL.txt</strong>) file distributed
with the Landsat scene, where they are called <code class="docutils literal notranslate"><span class="pre">RADIANCE_MULT_BAND_X</span></code> and <code class="docutils literal notranslate"><span class="pre">RADIANCE_ADD_BAND_X</span></code>, respectively.</p>
<p>If you open <strong>LC08_L1TP_023031_20200705_20200913_02_T1_MTL.txt</strong> and scroll to about line 227, you should see the
following:</p>
<a class="reference internal image-reference" href="../../../_images/radiance_rescaling.png"><img alt="the radiance rescaling values" class="align-center" src="../../../_images/radiance_rescaling.png" style="width: 600px;" /></a>
<p><br /> These are the values we’ll need to use to convert the raw images to top-of-atmosphere (spectral) radiance.
Open the <strong>Raster Calculator</strong> and enter the following formula for TIRS Band 10:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">3.3420E-04</span> <span class="o">*</span> <span class="s2">&quot;LC08_L1TP_023031_20200705_20200913_02_T1@10&quot;</span> <span class="o">+</span> <span class="mf">0.1000</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../_images/radiance_rastercalc.png"><img alt="raster calculator formula for radiance" class="align-center" src="../../../_images/radiance_rastercalc.png" style="width: 600px;" /></a>
<p><br /> Save the image to your workspace as <strong>Radiance_B10.tif</strong> (or something similar), then press <strong>OK</strong>. Once the tool
is finished, load the radiance raster to your map (if it doesn’t load automatically). It should look something like this:</p>
<a class="reference internal image-reference" href="../../../_images/radiance_map.png"><img alt="radiance raster map window" class="align-center" src="../../../_images/radiance_map.png" style="width: 600px;" /></a>
<p><br /> Note that the units for this raster are the units of radiance, Watts per square meter per steradian per
micrometer (<span class="math notranslate nohighlight">\(\rm W\ m^{-2}\ srad^{-1}\ {\mu}m^{-1}\)</span>). Because this is just a rescaling of the raw image,
it should look very similar to the original image.</p>
</div>
<div class="section" id="converting-raw-images-to-top-of-atmosphere-reflectance">
<h2>converting raw images to top-of-atmosphere reflectance<a class="headerlink" href="#converting-raw-images-to-top-of-atmosphere-reflectance" title="Permalink to this headline">#</a></h2>
<p>Next, we’ll convert the raw bands to top-of-atmosphere reflectance (<span class="math notranslate nohighlight">\(\rho_\lambda\)</span>) using the metadata.
Similarly for the radiance, the formula is:</p>
<div class="math notranslate nohighlight">
\[\rho_\lambda = \frac{M_\rho Q_{\rm cal} + A_\rho}{\sin\theta_{\rm SE}}\]</div>
<p>where <span class="math notranslate nohighlight">\(M_\rho\)</span> is a multiplicative rescaling factor, <span class="math notranslate nohighlight">\(Q_{\rm cal}\)</span> is the DN value, <span class="math notranslate nohighlight">\(M_\rho\)</span> is an
additive rescaling factor, and <span class="math notranslate nohighlight">\(\theta_{\rm SE}\)</span> is the solar elevation angle. As with <span class="math notranslate nohighlight">\(M_L\)</span> and
<span class="math notranslate nohighlight">\(A_L\)</span>, <span class="math notranslate nohighlight">\(M_\rho\)</span>, <span class="math notranslate nohighlight">\(A_\rho\)</span>, and <span class="math notranslate nohighlight">\(\theta_{\rm SE}\)</span> can be found in the <strong>MTL.txt</strong> file,
where they are called <code class="docutils literal notranslate"><span class="pre">REFLECTANCE_MULT_BAND_X</span></code>, <code class="docutils literal notranslate"><span class="pre">REFLECTANCE_ADD_BAND_X</span></code>, and <code class="docutils literal notranslate"><span class="pre">SUN_ELEVATION</span></code>,
respectively.<a class="footnote-reference brackets" href="#id14" id="id1">1</a></p>
<p>Open the <strong>Raster Calculator</strong> and enter the following formula for OLI Band 4:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">2.0000E-05</span> <span class="o">*</span> <span class="s2">&quot;LC08_L1TP_023031_20200705_20200913_02_T1@4&quot;</span> <span class="o">-</span> <span class="mf">0.100000</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mf">64.21111658</span><span class="p">))</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../_images/reflectance_rastercalc.png"><img alt="reflectance raster calculator formula" class="align-center" src="../../../_images/reflectance_rastercalc.png" style="width: 600px;" /></a>
<p><br /> Save the image to your workspace as <strong>Reflectance_B4.TIF</strong>. When the tool is finished, you should see something
like this:</p>
<a class="reference internal image-reference" href="../../../_images/reflectance_map.png"><img alt="reflectance raster map window" class="align-center" src="../../../_images/reflectance_map.png" style="width: 600px;" /></a>
<p><br /> You don’t need to repeat this step for all of the bands, but you should at least do this for OLI Band 5. When
you are finished, you can either attempt to (optionally) atmospherically correct the images by following the
instructions in the box below, or you can move ahead to <a class="reference internal" href="#calculating-brightness-temperature">calculating brightness temperature</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be sure to double-check the rescaling factors for your particular image/sensor - for OLI/TIRS, they are the same
for all bands, but this is not the case for ETM+/TM.</p>
</div>
</div>
<div class="section" id="atmospheric-correction-optional">
<h2>atmospheric correction (optional)<a class="headerlink" href="#atmospheric-correction-optional" title="Permalink to this headline">#</a></h2>
<p>When calculating the NDVI, correcting for atmospheric effects is not strictly necessary, as the differences between
top-of-atmosphere NDVI and surface NDVI are generally small<a class="footnote-reference brackets" href="#id15" id="id2">2</a>. But, you might be interested in learning how to do
(one kind of) atmospheric correction for yourself.</p>
<p>We’ll use OLI Band 4 (visible red) for this example; the procedure is basically the same for any band. The method is
based on Chavez (1988)<a class="footnote-reference brackets" href="#id16" id="id3">3</a> and Chavez (1996)<a class="footnote-reference brackets" href="#id17" id="id4">4</a>; however, because we have already converted the images to TOA
reflectance, we only need to subtract the dark-object reflectance from our raster, rather than converting from raw
images to radiance to reflectance.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This does not apply for the TIRS bands, which are primarily measuring emitted, rather than reflected, energy.</p>
</div>
<p>Once you have converted Band 4 to TOA reflectance following the steps above, we need to find a <strong>dark object</strong>. This
means an object (or surface) that appears very dark in the image, either because it is in complete shadow, or because
it has very low (&lt;1%) reflectance. The assumption behind these methods is that for such an object, any radiance
measured by the sensor is due to atmospheric scattering.</p>
<p>Generally speaking, deep, dark, clear water makes for a good dark object. If you can find areas of deep shadow
(typically much easier to do in mountainous regions), these will work, too. For the sake of this tutorial, we’ll use
values from Lake Michigan (which is generally deep, dark, and clear), making sure to select pixels far offshore.</p>
<p>Looking at a true-color (Bands 4, 3, 2) composite, you should see that there’s a thin layer of fog/clouds over a
good portion of the lake - we want to try to avoid these areas, as they won’t give us an accurate dark radiance value:</p>
<a class="reference internal image-reference" href="../../../_images/true_color.png"><img alt="true color composite showing thin clouds/fog" class="align-center" src="../../../_images/true_color.png" style="width: 600px;" /></a>
<p><br /> With your <strong>Reflectance_B4</strong> layer loaded, use the <strong>Identify Features</strong> tool to find the values of some of the
pixels in the darker areas of the lake:</p>
<a class="reference internal image-reference" href="../../../_images/red_reflectance_map.png"><img alt="visible red reflectance values identified" class="align-center" src="../../../_images/red_reflectance_map.png" style="width: 600px;" /></a>
<p><br /> Here, we find values around 0.028 - 0.029.</p>
<p>Another method for selecting the dark-object radiance is to use the lowest pixel value with more than 1000 pixels.
From the <strong>Histogram</strong> tab in the <strong>Layer Properties</strong> window, we can see that for this image, this would be around
0.02845 - we’ll use this value for Band 4:</p>
<a class="reference internal image-reference" href="../../../_images/red_reflectance_hist.png"><img alt="red reflectance histogram" class="align-center" src="../../../_images/red_reflectance_hist.png" style="width: 600px;" /></a>
<p><br /> Now, we want to subtract this value from <strong>Reflectance_B4</strong> (while also making sure that we don’t have any
negative reflectance values). To do this, you can enter the following formula in the <strong>Raster Calculator</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="s2">&quot;Reflectance_B4@1&quot;</span> <span class="o">&gt;</span> <span class="mf">0.02845</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="s2">&quot;Reflectance_B4@1&quot;</span> <span class="o">-</span> <span class="mf">0.02845</span><span class="p">))</span> <span class="o">+</span> <span class="p">((</span><span class="s2">&quot;Reflectance_B4@1&quot;</span> <span class="o">&lt;=</span> <span class="mf">0.02845</span><span class="p">)</span> <span class="o">*</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../_images/reflectance_corr_rastercalc.png"><img alt="reflectance subtraction raster calculator formula" class="align-center" src="../../../_images/reflectance_corr_rastercalc.png" style="width: 600px;" /></a>
<p><br /> This will make sure that any pixel with a value greater than <code class="docutils literal notranslate"><span class="pre">0.02845</span></code> has that value subtracted, while any
value less than <code class="docutils literal notranslate"><span class="pre">0.02845</span></code> will be set to 0. Save the output to your workspace as <strong>Reflectance_B4_corr.TIF</strong>.
Repeat this step with as many bands as you like, but you should at least do it for OLI Band 5.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you have taken EGM722, this might be a great place to practice your programming skills and write a script that
will save you from having to do this for each of the other bands.</p>
</div>
</div>
<div class="section" id="calculating-brightness-temperature">
<h2>calculating brightness temperature<a class="headerlink" href="#calculating-brightness-temperature" title="Permalink to this headline">#</a></h2>
<p>Next, we can calculate the <strong>brightness temperature</strong> using the method discussed in this week’s lecture. The formula
to use will be:</p>
<div class="math notranslate nohighlight">
\[T_{\rm brightness} = \frac{K_2}{ln\left(\frac{K_1}{L_\lambda} + 1\right)}\]</div>
<p>where <span class="math notranslate nohighlight">\(K_1\)</span>, <span class="math notranslate nohighlight">\(K_2\)</span> are constants provided in the metadata. For TIRS, the values are:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(K_1\)</span>: 774.8853</p></li>
<li><p><span class="math notranslate nohighlight">\(K_2\)</span>: 1321.0789</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The formula to use here is the same for all Landsat sensors, but the values of <span class="math notranslate nohighlight">\(K_1\)</span>, <span class="math notranslate nohighlight">\(K_2\)</span> will be
different for each sensor (e.g., TM, ETM+, TIRS). <strong>Be sure to use the right values!</strong> When in doubt, you can check
the <strong>MTL.txt</strong> file provided with your Landsat scene.</p>
</div>
<p>This will return a temperature in Kelvin - to convert to ºC, subtract 273.15:</p>
<div class="math notranslate nohighlight">
\[T_{\rm b} = \frac{K_2}{ln\left(\frac{K_1}{L_\lambda} + 1\right)} - 273.15\]</div>
<p>To apply this formula, open the <strong>Raster Calculator</strong> again and enter the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">1321.0789</span> <span class="o">/</span> <span class="p">(</span><span class="n">ln</span><span class="p">((</span><span class="mf">774.8853</span> <span class="o">/</span> <span class="s2">&quot;Radiance_B10@1&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">-</span> <span class="mf">273.15</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../_images/brightnesstemp_rastercalc.png"><img alt="raster calculator formula for brightness temperature" class="align-center" src="../../../_images/brightnesstemp_rastercalc.png" style="width: 600px;" /></a>
<p><br /> Save the output to your workspace as <strong>BrightnessTemp.tif</strong>. Once the tool is finished, load the radiance raster
to your map (if it doesn’t load automatically). It should look something like this:</p>
<a class="reference internal image-reference" href="../../../_images/brightnesstemp_map.png"><img alt="brightness temperature map window" class="align-center" src="../../../_images/brightnesstemp_map.png" style="width: 600px;" /></a>
<p><br /> Have a look around the map - you might want to flip back and forth between the composite image and the brightness
temperature to investigate different features. What are the darkest objects that you can see in the image? What about
the brightest objects?</p>
</div>
<div class="section" id="calculating-assigning-emissivity-values">
<h2>calculating/assigning emissivity values<a class="headerlink" href="#calculating-assigning-emissivity-values" title="Permalink to this headline">#</a></h2>
<p>The next thing we’ll need to do is estimate the emissivity, <span class="math notranslate nohighlight">\(\varepsilon\)</span>, of each pixel in order to convert
brightness temperature to land surface temperature. As discussed in this week’s lectures and
<a class="reference external" href="https://www.zotero.org/groups/4390042/egm703/collections/6WN2LFUQ">reading</a>, there are a number of different ways
to do this; we’ll look at two examples in this practical.</p>
<div class="section" id="estimating-emissivity-using-partial-vegetation">
<h3>estimating emissivity using partial vegetation<a class="headerlink" href="#estimating-emissivity-using-partial-vegetation" title="Permalink to this headline">#</a></h3>
<p>The first method we’ll use is based on Sobrino et al. (2004)<a class="footnote-reference brackets" href="#id17" id="id5">4</a> and Avdan and Jovanovska (2016)<a class="footnote-reference brackets" href="#id18" id="id6">5</a>. It uses the
normalized difference vegetation index (NDVI) to assign an emissivity value to each pixel, based on observed
relationships between vegetation cover and land surface emissivity. To get started, we’ll need to calculate the
NDVI using the NIR (band 5) and the Visible Red (band 4) bands.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a gentle reminder that for Landsat 7 ETM+ and Landsat 4/5 TM, the band numbers will be different.
In these images, NIR is band 4 and Visible Red is band 3.</p>
</div>
<p>Enter the following formula into the raster calculator:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s2">&quot;Reflectance_B5@1&quot;</span> <span class="o">-</span> <span class="s2">&quot;Reflectance_B4@1&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="s2">&quot;Reflectance_B5@1&quot;</span> <span class="o">+</span> <span class="s2">&quot;Reflectance_B4@1&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../_images/ndvi_rastercalc.png"><img alt="ndvi raster calculator formula" class="align-center" src="../../../_images/ndvi_rastercalc.png" style="width: 600px;" /></a>
<p><br /> Now that we have the NDVI values, we can calculate the proportion of vegetation (<span class="math notranslate nohighlight">\(P_v\)</span>), which re-scales
the NDVI between values representing bare soil and total vegetation cover. To do this, we’ll need to find the
maxmimum and minimum values for the NDVI raster. You can find these under the <strong>Information</strong> tab in the
<strong>Layer Properties</strong> window (double-click on the layer name, or right-click &gt; <strong>Properties</strong>):</p>
<a class="reference internal image-reference" href="../../../_images/layer_properties.png"><img alt="layer properties information" class="align-center" src="../../../_images/layer_properties.png" style="width: 600px;" /></a>
<p><br /> For this image, the maximum NDVI value is <code class="docutils literal notranslate"><span class="pre">0.86635488271713</span></code>, and the minimum value is <code class="docutils literal notranslate"><span class="pre">-0.54606562852859</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The values for your raster may be different, so be sure to check!</p>
</div>
<p>Open the <strong>Raster Calculator</strong> and enter the following formula, making sure to replace the values using the
minimum/maximum values from your NDVI raster:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="s2">&quot;NDVI@1&quot;</span> <span class="o">-</span> <span class="o">-</span><span class="mf">0.54606562852859</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.86635488271713</span> <span class="o">-</span> <span class="o">-</span><span class="mf">0.54606562852859</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span>
</pre></div>
</div>
<p>Save the output to your workspace as <strong>PropVeg.TIF</strong>:</p>
<a class="reference internal image-reference" href="../../../_images/propveg_rastercalc.png"><img alt="proportion of vegetation raster calculator formula" class="align-center" src="../../../_images/propveg_rastercalc.png" style="width: 600px;" /></a>
<p><br /> You should see that in general, areas near the city have very low <span class="math notranslate nohighlight">\(P_v\)</span> values (they appear dark), while
areas in the surrounding rural areas tend to have much higher values (they appear bright), reflecting a pattern that
built-up areas tend to be less vegetated:</p>
<a class="reference internal image-reference" href="../../../_images/propveg_map.png"><img alt="proportion of vegetation raster in map window" class="align-center" src="../../../_images/propveg_map.png" style="width: 600px;" /></a>
<p><br /> Following Avdan and Jovanovska (2016)<a class="footnote-reference brackets" href="#id18" id="id7">5</a>, we’re going to assign emissivity values to each pixel using the NDVI
and proportion of vegetation. The set of equations looks like this:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\varepsilon_\lambda = \begin{cases} \varepsilon_{s\lambda}, &amp; {\rm NDVI} &lt; {\rm NDVI_s} \\
                                    \varepsilon_{v\lambda} P_v + \varepsilon_{s\lambda}(1 - P_v) + C, &amp; {\rm NDVI_s} \leq {\rm NDVI} \leq {\rm NDVI_v} \\
                                    \varepsilon_{v\lambda} + C , &amp; {\rm NDVI_v} &lt; {\rm NDVI}
                      \end{cases}\end{split}\]</div>
<p>What this means is:</p>
<ul class="simple">
<li><p>where NDVI values are less than the NDVI for bare soil (<span class="math notranslate nohighlight">\(\rm NDVI_s = 0.2\)</span>), we use the emissivity value for
bare soil (<span class="math notranslate nohighlight">\(\varepsilon_{s\lambda} = 0.996\)</span>).</p></li>
<li><p>where NDVI values are between the NDVI values for bare soil and vegetation (<span class="math notranslate nohighlight">\(\rm NDVI_s = 0.5\)</span>), we use a
linear scaling between the emissivity values for bare soil (<span class="math notranslate nohighlight">\(\varepsilon_{s\lambda}\)</span>) and vegetation
(<span class="math notranslate nohighlight">\(\varepsilon_{v\lambda} = 0.973\)</span>)</p></li>
<li><p>where NDVI values are greater than the <span class="math notranslate nohighlight">\(\rm NDVI_v\)</span>, we use <span class="math notranslate nohighlight">\(\varepsilon_{v\lambda}\)</span>.</p></li>
</ul>
<p>Additionally, where NDVI values are less than zero, we will use an emissivity value for water
(<span class="math notranslate nohighlight">\(\varepsilon_{v\lambda} = 0.991\)</span>). To apply this formula, open the <strong>Raster Calculator</strong> and enter the
following formula:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="s2">&quot;NDVI@1&quot;</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.991</span><span class="p">)</span> <span class="o">+</span> <span class="p">(((</span><span class="s2">&quot;NDVI@1&quot;</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">AND</span> <span class="p">(</span><span class="s2">&quot;NDVI@1&quot;</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">))</span> <span class="o">*</span> <span class="mf">0.996</span><span class="p">)</span> <span class="o">+</span> <span class="p">(((</span><span class="s2">&quot;NDVI@1&quot;</span> <span class="o">&gt;=</span> <span class="mf">0.2</span><span class="p">)</span> <span class="n">AND</span> <span class="p">(</span><span class="s2">&quot;NDVI@1&quot;</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.973</span> <span class="o">*</span> <span class="s2">&quot;PropVeg@1&quot;</span> <span class="o">+</span> <span class="mf">0.996</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="s2">&quot;PropVeg@1&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.005</span><span class="p">))</span> <span class="o">+</span> <span class="p">((</span><span class="s2">&quot;NDVI@1&quot;</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.973</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The syntax for ArcGIS Pro’s Raster Calculator is slightly different to the QGIS Raster Calculator - you’ll need
to replace ‘AND’ with ‘&amp;’ to get this to work.</p>
<p>You may also be thinking to yourself, “this is a really complicated formula”, and you would be right.
<strong>This is where programming really comes in handy</strong>, and where I insert an advertisement for EGM722 if you
haven’t already taken it. :)</p>
</div>
<a class="reference internal image-reference" href="../../../_images/emissivity_rastercalc.png"><img alt="raster calculator formula for emissivity" class="align-center" src="../../../_images/emissivity_rastercalc.png" style="width: 600px;" /></a>
<p><br /> Save the output to your workspace as <strong>Emissivity.TIF</strong>. Once the tool has finished running, you can continue
on to the section on <a class="reference internal" href="#land-surface-temperature-calculation">land surface temperature calculation</a> below.</p>
</div>
</div>
<div class="section" id="optional-other-methods-of-estimating-emissivity">
<h2>optional: other methods of estimating emissivity<a class="headerlink" href="#optional-other-methods-of-estimating-emissivity" title="Permalink to this headline">#</a></h2>
<p>The method outlined above is one way of estimating emissivity values in order to calculate land surface temperature
from brightness temperature. You can click on the tabs below to display other methods of estimating emissivity data:</p>
<div class="section" id="assigning-emissivity-from-classified-images">
<h3>assigning emissivity from classified images<a class="headerlink" href="#assigning-emissivity-from-classified-images" title="Permalink to this headline">#</a></h3>
<p>Rather than assuming that emissivity values vary between the given values for soil
(<span class="math notranslate nohighlight">\(\varepsilon_{s\lambda} = 0.996\)</span>) and vegetation (<span class="math notranslate nohighlight">\(\varepsilon_{v\lambda} = 0.973\)</span>), you can perform a
classification on the image and assign values based on each class.</p>
<p>For example, you could do a supervised classification for classes like built-up areas, water, bare soil, and different
types of vegetation. There are a number of different resources you can use to get emissivity values for different
surfaces, including the MODIS (Moderate Resolution Imaging Spectrometer)
<a class="reference external" href="https://icess.eri.ucsb.edu/modis/EMIS/html/em.html">UCSB Emissivity Library</a><a class="footnote-reference brackets" href="#id19" id="id8">6</a> and the
<a class="reference external" href="https://speclib.jpl.nasa.gov/">ECOSTRESS/ASTER spectral library</a><a class="footnote-reference brackets" href="#id20" id="id9">7</a><a class="footnote-reference brackets" href="#id21" id="id10">8</a></p>
<p>These spectral libraries contain measurements of various materials over a range of wavelengths - to apply them to a
Landsat image, you should take the average value over the wavelength range covered by your particular band
(e.g., for TIRS Band 10, this is 10.6 - 11.19 <span class="math notranslate nohighlight">\(\mu\)</span>m).</p>
<p>Some examples for different materials/landcover classes are shown in the table below:</p>
<table class="table">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>material</p></td>
<td><p>emissivity</p></td>
</tr>
<tr class="row-even"><td><p>Water</p></td>
<td><p>0.993</p></td>
</tr>
<tr class="row-odd"><td><p>Dry Grass</p></td>
<td><p>0.952</p></td>
</tr>
<tr class="row-even"><td><p>Oak Leaf</p></td>
<td><p>0.970</p></td>
</tr>
<tr class="row-odd"><td><p>Pine (New)</p></td>
<td><p>0.980</p></td>
</tr>
<tr class="row-even"><td><p>Black Asphalt</p></td>
<td><p>0.970</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="other-sources-of-emissivity-data">
<h3>other sources of emissivity data<a class="headerlink" href="#other-sources-of-emissivity-data" title="Permalink to this headline">#</a></h3>
<p>Alternatively, sensors such as MODIS or ASTER have been used to estimate global emissivity values at various spatial
resolutions.</p>
<p>The <a class="reference external" href="https://modis.gsfc.nasa.gov/data/dataprod/mod11.php">MODIS Land Surface Temperature and Emissivity dataset (MOD11)</a>
provides daily gridded values of both emissivity and land surface temperature, at either 1 km or 6 km pixel size.</p>
<p>The <a class="reference external" href="https://lpdaac.usgs.gov/products/ag100v003/">ASTER Global Emissivity Dataset</a>, or the
<a class="reference external" href="https://lpdaac.usgs.gov/products/ast_05v003/">ASTER Level-2 Surface Emissivity</a> products are produced using the
five ASTER thermal bands. The global dataset is a composite of all clear-sky ASTER pixels acquired between 2000 and
2008, while the Level-2 products are produced for each individual ASTER scene - especially useful for studies in
regions where the ground cover can change dramatically throughout the year (for example, because it snows).</p>
</div>
</div>
<div class="section" id="land-surface-temperature-calculation">
<h2>land surface temperature calculation<a class="headerlink" href="#land-surface-temperature-calculation" title="Permalink to this headline">#</a></h2>
<p>Once you have an emissivity value for each pixel, you can use the following equation to calculate the land surface
temperature, <span class="math notranslate nohighlight">\(T_s\)</span> using the brightness temperature and the emissivity:</p>
<div class="math notranslate nohighlight">
\[T_{\rm s} = \frac{T_{\rm b}}{1 + \left(\frac{\lambda T_{\rm b}}{\rho}\ln\varepsilon\right)}\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda\)</span> is the wavelength (in meters) of emittance (here, taken as the central wavelength of TIRS Band 10,
10.895 <span class="math notranslate nohighlight">\(\mu\)</span>m <span class="math notranslate nohighlight">\(= 1.0895\times 10^{-5}\)</span> m). The constant <span class="math notranslate nohighlight">\(\rho = hc/\sigma = 1.438\times 10^{-2}\)</span> m K,
where <span class="math notranslate nohighlight">\(h\)</span> is Planck’s constant, <span class="math notranslate nohighlight">\(c\)</span> is the speed of light in a vacuum, and <span class="math notranslate nohighlight">\(\sigma\)</span> is the Boltzmann
constant.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Remember that the wavelength <span class="math notranslate nohighlight">\(\lambda\)</span> will depend on the sensor <strong>and</strong> the band - it will not be the same
for TIRS Band 11, nor will it be the same for TM or ETM+ Band 6.</p>
</div>
<p>Open up the <strong>Raster Calculator</strong> and input the following equation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;BrightnessTemp@1&quot;</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">((</span><span class="mf">1.0895e-5</span> <span class="o">*</span> <span class="s2">&quot;BrightnessTemp@1&quot;</span> <span class="o">/</span> <span class="mf">1.438e-2</span><span class="p">)</span> <span class="o">*</span> <span class="n">ln</span><span class="p">(</span><span class="s2">&quot;Emissivity_Pv@1&quot;</span><span class="p">)))</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../_images/lst_rastercalc.png"><img alt="land surface temperature raster calculator formula" class="align-center" src="../../../_images/lst_rastercalc.png" style="width: 600px;" /></a>
<p><br /> Save the output to your workspace as <strong>LandSurfaceTemp.TIF</strong>. Once the tool finishes running, you should see
something like this:</p>
<a class="reference internal image-reference" href="../../../_images/lst_map.png"><img alt="land surface temperature map window" class="align-center" src="../../../_images/lst_map.png" style="width: 600px;" /></a>
<p><br /> To make this somewhat easier to interpret, we can change the symbology to <strong>Singleband pseudocolor</strong>, ranging
from 20ºC to 40ºC. Pick an appropriate colormap, then have a look around the map:</p>
<a class="reference internal image-reference" href="../../../_images/lst_colormap.png"><img alt="land surface temperature colorized" class="align-center" src="../../../_images/lst_colormap.png" style="width: 600px;" /></a>
<p><br /> You should see, for example, the bands of clouds scattered throughout the scene showing up as cold features.
You can also see the surface temperature of Lake Michigan is around 22ºC - remember that this is <strong>not</strong> necessarily
the water temperature, but rather the <a class="reference external" href="https://podaac.jpl.nasa.gov/forum/viewtopic.php?f=7&amp;t=298">skin temperature</a>
of the water - depending on the water conditions, this can vary considerably from the temperature at depth.</p>
<p>You should also see that closer to the lake, temperatures in the city are cooler than they are even a few hundred
meters inland. The same is true for areas around some of the various green belts and parks scattered
throughout the city:</p>
<a class="reference internal image-reference" href="../../../_images/lst_map_markup.png"><img alt="labeled chicago land surface temperatures" class="align-center" src="../../../_images/lst_map_markup.png" style="width: 600px;" /></a>
<p><br /></p>
<div class="section" id="optional-profiling-using-the-qgis-profile-tool">
<h3>optional: profiling using the QGIS profile tool<a class="headerlink" href="#optional-profiling-using-the-qgis-profile-tool" title="Permalink to this headline">#</a></h3>
<p>To create a profile of a raster in QGIS, you can install the <strong>Profile tool</strong> plugin. Go to <strong>Plugins</strong> &gt;
<strong>Manage and Install Plugins</strong>. Under the <strong>All</strong> tab, search for “profile tool”:</p>
<a class="reference internal image-reference" href="../../../_images/plugin_window.png"><img alt="profile tool plugin window" class="align-center" src="../../../_images/plugin_window.png" style="width: 600px;" /></a>
<p><br /> Click <strong>Install Plugin</strong> (if you haven’t already installed it), and the icon should show up in your toolbar.
Click the icon to open the tool.</p>
<p>To draw a straight-line profile, click on the map window, then double-click at another point to create the line.
Add your <strong>LandSurfaceTemp</strong> raster by selecting the layer in the <strong>Layers</strong> panel, then clicking <strong>Add Layer</strong>
in the <strong>Profile Tool</strong> - you should then see a profile of the values based on the line you’ve drawn:</p>
<a class="reference internal image-reference" href="../../../_images/qgis_profile.png"><img alt="an example of a profile drawn in the QGIS map window" class="align-center" src="../../../_images/qgis_profile.png" style="width: 600px;" /></a>
<p><br /> To draw lines with multiple nodes, you can simply start a profile with a single click, then continue clicking to
add nodes. When you have finished adding nodes, double-click to stop drawing.</p>
<p>To add additional layers, simply highlight them in the layer menu, then click <strong>Add Layer</strong>. Note that it can be
difficult to compare layers using the profile tool if they have vastly different values (e.g., it’s hard to draw a
profile of both emissivity values and land surface temperature). You can, however, export the profile values by
selecting the <strong>Table</strong> tab in the profile tool panel, then copying and pasting the values into a spreadsheet or
CSV file.</p>
</div>
<div class="section" id="optional-profiling-using-arcgis-pro">
<h3>optional: profiling using ArcGIS Pro<a class="headerlink" href="#optional-profiling-using-arcgis-pro" title="Permalink to this headline">#</a></h3>
<p>If you are using ArcGIS Pro, you can use <strong>Line Map Notes</strong> or create a <strong>Profile Graph</strong> by following the detailed
instructions <a class="reference external" href="https://pro.arcgis.com/en/pro-app/latest/help/analysis/3d-analyst/interactively-create-a-profile-graph-with-digitized-lines-on-a-surface.htm#ESRI_SECTION1_2EA3A0418D2C4A16AC9F53A1A42C3874">here</a>.</p>
</div>
</div>
<div class="section" id="further-investigation">
<h2>further investigation<a class="headerlink" href="#further-investigation" title="Permalink to this headline">#</a></h2>
<p>Now that we have a map of land surface temperature, we can conduct additional investigations. For example, repeating
the above methods for the 1990 and 1999 images provided, you can look at how these patterns have changed over time,
keeping in mind that these images represent snapshots of a single day.</p>
<p>By comparing US Census data with land surface temperatures, Huang et al. (2011)<a class="footnote-reference brackets" href="#id22" id="id11">9</a> found that land surface
temperature in Baltimore, MD, USA was “statistically higher in block groups that are characterized by low income,
high poverty, less education, more ethnic minorities, more elderly people and greater risk of crime.” In a study of
over 1,000 US counties, Benz and Burney (2021)<a class="footnote-reference brackets" href="#id23" id="id12">10</a> found that the poorest census tracts within a county were
significantly hotter than the richest areas in 76% of US counties surveyed. The reasons for these differences are
primarily physical: wealthier neighborhoods tend to have more green space and trees, while poorer neighborhoods tend
to have more pavement and other heat-trapping surfaces.</p>
<p>One option for your project in this class is to investigate the relationship between land surface temperature and
other datasets. As part of the data supplied for this practical, you will find a shapefile of census block groups with
income and demographic data from the 2019 American Community Survey 5-year data (2015-2019), provided by the National
Historical Geographic Information System (NHGIS) at the University of Minnesota (USA)<a class="footnote-reference brackets" href="#id24" id="id13">11</a>.</p>
<p>Using the <strong>RasterStats</strong> plugin in QGIS (or the
<a class="reference external" href="https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-analyst/zonal-statistics.htm">Zonal Statistics</a>
tool in ArcGIS Pro), you can extract the land surface temperature values for each of the block groups. You should be
able to use this to investigate how the average land surface temperature for each census block relates to the
different demographic data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you have already taken EGM722, you should be able to write a script to extract the temperature data <em>and</em> make
scatterplots of the land surface temperature vs. the different socioeconomic data. Check the
<a class="reference external" href="https://github.com/iamdonovan/egm722/blob/main/Week5/Practical5.ipynb">Week 5 Practical</a> tutorial for a refresher.</p>
</div>
<p>Throughout the Landsat scene, you can see a number of extremely bright, hot (<span class="math notranslate nohighlight">\(T_s\)</span> &gt; 45&amp;deg;C) objects. Can you
identify these objects? What is it about these particular objects that makes them so incredibly bright in the
thermal infrared?</p>
</div>
<div class="section" id="notes">
<h2>notes<a class="headerlink" href="#notes" title="Permalink to this headline">#</a></h2>
<dl class="footnote brackets">
<dt class="label" id="id14"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>This is actually the scene center solar elevation angle. To be completely thorough, we would first calculate
the per-pixel solar elevation angle. We’re not going to do this for this tutorial, but you can find more
information about how to do this <a class="reference external" href="https://www.usgs.gov/land-resources/nli/landsat/solar-illumination-and-sensor-viewing-angle-coefficient-files">here</a>.</p>
</dd>
<dt class="label" id="id15"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Chavez, P. S. (1988). An improved dark-object subtraction technique for atmospheric scattering correction of
multispectral data. <em>Remote Sensing of Environment</em> 24(<strong>3</strong>), 459-479. doi:
<a class="reference external" href="https://doi.org/10.1016/0034-4257(88)90019-3">10.1016/0034-4257(88)90019-3</a></p>
</dd>
<dt class="label" id="id16"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>Chavez, P. S. (1996). Image-based atmospheric corrections - revisited and improved.
<em>Photogrammetric engineering and remote sensing</em> 62(<strong>9</strong>), 1025-1035.
[<a class="reference external" href="https://www.asprs.org/wp-content/uploads/pers/1996journal/sep/1996_sep_1025-1036.pdf">PDF</a>]</p>
</dd>
<dt class="label" id="id17"><span class="brackets">4</span><span class="fn-backref">(<a href="#id4">1</a>,<a href="#id5">2</a>)</span></dt>
<dd><p>Sobrino, J. A., J. C. Jiménez-Muñoz and L. Paolini (2004). Land surface temperature retrieval from Landsat
TM 5. <em>Remote Sensing of Environment</em> 90(<strong>4</strong>), 434-440. doi:
<a class="reference external" href="https://doi.org/10.1016/j.rse.2004.02.003">10.1016/j.rse.2004.02.003</a></p>
</dd>
<dt class="label" id="id18"><span class="brackets">5</span><span class="fn-backref">(<a href="#id6">1</a>,<a href="#id7">2</a>)</span></dt>
<dd><p>Avdan, U. and G. Jovanovska (2016). Algorithm for Automated Mapping of Land Surface Temperature Using Landsat
8 Satellite Data. <em>Journal of Sensors</em> 2016. doi: <a class="reference external" href="https://doi.org/10.1155/2016/1480307">10.1155/2016/1480307</a></p>
</dd>
<dt class="label" id="id19"><span class="brackets"><a class="fn-backref" href="#id8">6</a></span></dt>
<dd><p>Snyder, W., Z. Wan, Y. Zhang, and Y.-Z. Feng (1997). Thermal Infrared (3–14 μm) bidirectional reflectance
measurements of sands and soils. <em>Remote Sensing of Environment</em> 60(<strong>1</strong>), 101-109. doi:
<a class="reference external" href="https://doi.org/10.1016/S0034-4257(96)00166-6">10.1016/S0034-4257(96)00166-6</a></p>
</dd>
<dt class="label" id="id20"><span class="brackets"><a class="fn-backref" href="#id9">7</a></span></dt>
<dd><p>Meerdink, S. K., S. J. Hook, D. A. Roberts, and E. A. Abbott (2019). The ECOSTRESS spectral library version 1.0.
<em>Remote Sensing of Environment</em> 230(<strong>1</strong>), 111196. doi:
<a class="reference external" href="https://doi.org/10.1016/j.rse.2019.05.015">10.1016/j.rse.2019.05.015</a></p>
</dd>
<dt class="label" id="id21"><span class="brackets"><a class="fn-backref" href="#id10">8</a></span></dt>
<dd><p>Baldridge, A. M., S. J. Hook, C. I. Grove, and G. Rivera (2009). The ASTER Spectral Library Version 2.0.
<em>Remote Sensing of Environment</em> 113(<strong>4</strong>), 711-715. doi:
<a class="reference external" href="https://doi.org/10.1016/j.rse.2008.11.007">10.1016/j.rse.2008.11.007</a></p>
</dd>
<dt class="label" id="id22"><span class="brackets"><a class="fn-backref" href="#id11">9</a></span></dt>
<dd><p>Huang, G., W. Zhou, and M. L. Cadenasso (2011). Is everyone hot in the city? Spatial pattern of land surface
temperatures, land cover and neighborhood socioeconomic characteristics in Baltimore, MD.
<em>Journal of Environmental Management</em> 92(<strong>7</strong>), 1753-1759. doi:
<a class="reference external" href="https://doi.org/10.1016/j.jenvman.2011.02.006">10.1016/j.jenvman.2011.02.006</a></p>
</dd>
<dt class="label" id="id23"><span class="brackets"><a class="fn-backref" href="#id12">10</a></span></dt>
<dd><p>Benz, S. A. and J. A. Burney (2021). Widespread race and class disparities in surface urban heat extremes
across the United States. <em>Earth’s Future</em> 9(<strong>7</strong>), e2021EF002016. doi:
<a class="reference external" href="https://doi.org/10.1029/2021EF002016">10.1029/2021EF002016</a></p>
</dd>
<dt class="label" id="id24"><span class="brackets"><a class="fn-backref" href="#id13">11</a></span></dt>
<dd><p>Manson, S., J. Schroeder, D. Van Riper, T. Kugler, and S. Ruggles. IPUMS National Historical Geographic
Information System: Version 16.0. Minneapolis, MN: IPUMS. 2021. doi:
<a class="reference external" href="http://doi.org/10.18128/D050.V16.0">10.18128/D050.V16.0</a>)</p>
</dd>
</dl>
</div>
</div>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="index.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">practicals</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="week2.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">hyperspectral image analysis</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Bob McNabb<br/>
  
      &copy; Copyright 2023, Bob McNabb. Licensed under Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0).<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>