
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>mapping with cartopy &#8212; space cameras and glaciers</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" href="../../../_static/customstyle.css" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="../../../_static/design-tabs.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="vector data using shapely and geopandas" href="week3.html" />
    <link rel="prev" title="debugging exercise" href="debugging.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">space cameras and glaciers</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../whataboutbob.html">
   about me
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../index.html">
   teaching
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../egm101/index.html">
     EGM101: skills toolbox
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm101/lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../egm101/practicals/index.html">
       practicals
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
      <label for="toctree-checkbox-3">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm101/practicals/week5.html">
         computation, summary statistics, and graphing in excel
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm101/practicals/week6.html">
         summarizing and graphing data in spss
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm101/practicals/week7.html">
         correlation and regression in spss
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm101/practicals/week8.html">
         hypothesis testing using spss
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm101/resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../egm310/index.html">
     EGM310: introduction to gis and remote sensing
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm310/lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm310/resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../egm702/index.html">
     EGM702: photogrammetry and advanced image analysis
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm702/lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../egm702/practicals/index.html">
       practicals
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
      <label for="toctree-checkbox-6">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/setup.html">
         software setup
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/week1.html">
         dem processing using micmac
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/week2.html">
         dem differencing
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/week3.html">
         introduction to google earth engine
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/week4.html">
         change detection in earth engine
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/week5.html">
         classification in earth engine
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm702/resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../egm703/index.html">
     EGM703: advanced active and passive remote sensing
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm703/lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../egm703/practicals/index.html">
       practicals
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
      <label for="toctree-checkbox-8">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm703/practicals/week1.html">
         urban heat islands
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm703/practicals/week2.html">
         hyperspectral image analysis
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm703/practicals/week3.html">
         SAR image processing
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm703/practicals/week4.html">
         InSAR Processing
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm703/practicals/week5.html">
         SAR image interpretation and flood mapping
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm703/resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="../index.html">
     EGM722: programming for gis and remote sensing
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../setup/index.html">
       setup
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
      <label for="toctree-checkbox-10">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/github.html">
         setting up github
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/git.html">
         installing git
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/desktop.html">
         installing github desktop
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/fork.html">
         forking the repository
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/clone.html">
         cloning the repository
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/conda.html">
         setting up conda/anaconda
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/environment.html">
         setting up a conda environment
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/jupyter.html">
         configuring jupyter
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/pycharm.html">
         pycharm
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/pip.html">
         installing packages with pip
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3 current active has-children">
      <a class="reference internal" href="index.html">
       practicals
      </a>
      <input checked="" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
      <label for="toctree-checkbox-11">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul class="current">
       <li class="toctree-l4">
        <a class="reference internal" href="week1.html">
         intro to python
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="debugging.html">
         debugging exercise
        </a>
       </li>
       <li class="toctree-l4 current active">
        <a class="current reference internal" href="#">
         mapping with cartopy
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="week3.html">
         vector data using shapely and geopandas
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="folium.html">
         interactive maps with folium
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="week4.html">
         raster data using rasterio
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="sentinelsat.html">
         searching for images with sentinelsat
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="week5.html">
         vector and raster operations using python
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../faq/index.html">
       help! something went wrong!
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
      <label for="toctree-checkbox-12">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../faq/git.html">
         git troubleshooting
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../faq/python.html">
         python troubleshooting
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../project/index.html">
       programming project
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
      <label for="toctree-checkbox-13">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../project/github.html">
         creating a new github repository
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../project/environment.html">
         environment.yml
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../gee/index.html">
   google earth engine
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../gee/tutorials/index.html">
     gee tutorials
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../gee/tutorials/getting_started/index.html">
       getting started
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
      <label for="toctree-checkbox-16">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/adding_exporting.html">
         adding and exporting images
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/spectral.html">
         spectral signatures
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/image_collections.html">
         image collections and vectors
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/mapping.html">
         manual mapping (digitizing)
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/band_maths.html">
         band maths
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/zonal_stats.html">
         zonal statistics
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../gee/tutorials/classification/index.html">
       image classification
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
      <label for="toctree-checkbox-17">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/classification/unsupervised.html">
         unsupervised classification
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/classification/pixel.html">
         pixel-based classification
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/classification/obia.html">
         object-based classification
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../gee/tutorials/change_detection/index.html">
       change detection
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
      <label for="toctree-checkbox-18">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/change_detection/multitemporal_composites.html">
         multi-temporal color composites
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/change_detection/repeat_classification.html">
         repeat classification
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/change_detection/cva.html">
         change vector analysis
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/change_detection/time_series.html">
         time series analysis
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../gee/tutorials/enhancement/index.html">
       image enhancement
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
      <label for="toctree-checkbox-19">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/enhancement/filtering.html">
         image filtering
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/enhancement/pansharpening.html">
         pansharpening
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/enhancement/edge_detection.html">
         edge detection
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/enhancement/unmixing.html">
         spectral unmixing
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/enhancement/pca.html">
         principle component analysis
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../gee/tutorials/advanced/index.html">
       advanced topics
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
      <label for="toctree-checkbox-20">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/advanced/animation.html">
         creating an animation
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../gee/exercises/index.html">
     sample exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../research/index.html">
   ongoing and past research projects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../github.html">
   github projects
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/teaching/egm722/practicals/week2.rst.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#getting-started">
   Getting started
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-the-script">
   Running the script
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ryan-gosling">
   Ryan Gosling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#objectives">
     Objectives
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     1. Getting started
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loading-the-data">
     2. Loading the data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-maps-with-matplotlib-and-cartopy">
     3. Creating maps with matplotlib and cartopy
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#adding-data-to-the-map">
       Adding data to the map
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#adding-labels-and-legends">
       Adding labels and legends
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#next-steps">
     Next steps
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>mapping with cartopy</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#getting-started">
   Getting started
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-the-script">
   Running the script
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ryan-gosling">
   Ryan Gosling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#objectives">
     Objectives
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     1. Getting started
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loading-the-data">
     2. Loading the data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-maps-with-matplotlib-and-cartopy">
     3. Creating maps with matplotlib and cartopy
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#adding-data-to-the-map">
       Adding data to the map
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#adding-labels-and-legends">
       Adding labels and legends
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#next-steps">
     Next steps
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="section" id="mapping-with-cartopy">
<h1>mapping with cartopy<a class="headerlink" href="#mapping-with-cartopy" title="Permalink to this headline">#</a></h1>
<p>In this practical, we’ll create a map using similar data to what you used in the first practical of EGM711. This time,
rather than using ArcGIS Pro, we’ll use <code class="docutils literal notranslate"><span class="pre">cartopy</span></code>, <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>, and <code class="docutils literal notranslate"><span class="pre">geopandas</span></code>, python packages used for making
maps, plotting data, and working with vector data, respectively.</p>
<p>The practical this week is provided as a Jupyter Notebook, where you can interactively work through the different steps
of plotting the data. There is a second file, <strong>practical2_script.py</strong>, which will create the same map over again. Once
you have worked through the Jupyter Notebook, you can modify the script to complete the second part of the exercise,
and experiment with the different parameters used to make the map.</p>
<div class="section" id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">#</a></h2>
<p>To get started with this week’s practical, first head to the your GitHub repository (<code class="samp docutils literal notranslate"><span class="pre">https://github.com/&lt;</span><em><span class="pre">your_username</span></em><span class="pre">&gt;/egm722</span></code>).
You should notice that this repository has 5 branches – you can click on the <strong>branch</strong> button to see all of the branches
available for a particular repository:</p>
<a class="reference internal image-reference" href="../../../_images/github.png"><img alt="the github repository" class="align-center" src="../../../_images/github.png" style="width: 720px;" /></a>
<p><br /> You should be able to see that the available branches are <code class="docutils literal notranslate"><span class="pre">main</span></code>, the default <strong>branch</strong> that we used in last
week’s practical, and branches for weeks 2 through 5.</p>
<p>If you open up the folder where you’ve <strong>cloned</strong> your repository, you should only see the <strong>Week1</strong> folder - no
<strong>Week2</strong>, <strong>Week3</strong>, and so on:</p>
<a class="reference internal image-reference" href="../../../_images/week1_folder.png"><img alt="the repository folder showing only Week 1 materials" class="align-center" src="../../../_images/week1_folder.png" style="width: 600px;" /></a>
<p><br /> We want to be able to work with each of the weeks at the same time, without having to switch branches each time.
To do this, we’ll need to add each week’s folder to the main branch.</p>
<p>Each week, we’ll see how we can <strong>merge</strong>, or integrate, that week’s branch into the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch. This week, we’ll
use <strong>GitHub Desktop</strong> to do this. In the coming weeks, we’ll also introduce other options such as the command-line
interface or
<a class="reference external" href="https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-pull-requests">Pull Requests</a>.</p>
<p>For now, open up <strong>GitHub Desktop</strong>. You should see something like this:</p>
<a class="reference internal image-reference" href="../../../_images/desktop1.png"><img alt="the github desktop window" class="align-center" src="../../../_images/desktop1.png" style="width: 600px;" /></a>
<p><br /> Click the button that shows the current branch (<strong>main</strong>) – you should see the following:</p>
<a class="reference internal image-reference" href="../../../_images/desktop_branches.png" id="desktop-branches"><img alt="the github desktop window" class="align-center" id="desktop-branches" src="../../../_images/desktop_branches.png" style="width: 600px;" /></a>
<p><br /> In addition to your <strong>local</strong> <code class="docutils literal notranslate"><span class="pre">main</span></code> branch, you should also see <strong>upstream</strong> versions of each of the branches
(<code class="docutils literal notranslate"><span class="pre">main</span></code>, <code class="docutils literal notranslate"><span class="pre">week2</span></code>–<code class="docutils literal notranslate"><span class="pre">week5</span></code>), as well as <strong>origin</strong> versions.</p>
<p>These are different things, and it’s important to keep track of the differences:</p>
<ul class="simple">
<li><p>The <strong>local</strong> branches are the versions that are stored on <em>your</em> computer, <em>local</em>ly.</p></li>
<li><p>The <strong>origin</strong> branches are the versions stored on <em>your</em> GitHub repository</p></li>
<li><p>The <strong>upstream</strong> branches are the versions that are stored in the repository that you forked from (<a class="reference external" href="https://github.com/iamdonovan/egm722">https://github.com/iamdonovan/egm722</a>)</p></li>
</ul>
<p>Right now, you should only have the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch on your machine. To work with (<strong>checkout</strong>) the <code class="docutils literal notranslate"><span class="pre">week2</span></code> branch,
we need to download it. Select the <strong>origin</strong> <code class="docutils literal notranslate"><span class="pre">week2</span></code> (<code class="docutils literal notranslate"><span class="pre">origin/week2</span></code>) branch, and <strong>GitHub Desktop</strong> will download
the files on the <code class="docutils literal notranslate"><span class="pre">week2</span></code> branch to your computer, and switch (<strong>checkout</strong>) the <code class="docutils literal notranslate"><span class="pre">week2</span></code> branch.</p>
<p>You should see that the “Current branch” has changed:</p>
<a class="reference internal image-reference" href="../../../_images/desktop_week2.png"><img alt="the github desktop window" class="align-center" src="../../../_images/desktop_week2.png" style="width: 600px;" /></a>
<p><br /> And, you can see that the contents of your repository folder have changed:</p>
<a class="reference internal image-reference" href="../../../_images/week2_folder.png"><img alt="the repository folder showing only Week 2 materials" class="align-center" src="../../../_images/week2_folder.png" style="width: 600px;" /></a>
<p><br /> Remember - <strong>the files are not gone</strong>. When you switch from one branch to another, <strong>git</strong> changes the files in
the folder to reflect the state of the branch you’re working on. Because there is no <strong>Week1</strong> folder on the <code class="docutils literal notranslate"><span class="pre">week2</span></code>
branch, it’s been temporarily removed. You can verify this by switching branches in <strong>GitHub Desktop</strong> and seeing how
the folder contents change.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Make sure that you’re on the</strong> <code class="docutils literal notranslate"><span class="pre">main</span></code> <strong>branch before continuing</strong>.</p>
<p>As good practice, you should also click the “<strong>Fetch origin</strong>” button before continuing.</p>
<p>There shouldn’t be many changes on the remote repository that aren’t on your local computer, so this won’t make
much of a difference right now. If you’re working collaboratively with others, though, it’s good to make sure that
you’re not missing important changes before merging different branches.</p>
</div>
<p>To <strong>merge</strong> the two branches, click on the <strong>Branch</strong> menu, then select <strong>Merge into current branch…</strong>. In the menu
that opens, select the <strong>local</strong> <code class="docutils literal notranslate"><span class="pre">week2</span></code> branch:</p>
<a class="reference internal image-reference" href="../../../_images/merge_week2.png"><img alt="merging the week2 branch into main using github desktop" class="align-center" src="../../../_images/merge_week2.png" style="width: 600px;" /></a>
<p><br /> You should see that a green checkmark appears, indicating that there aren’t any <strong>conflicts</strong> (files that have
been changed on both branches). The message:</p>
<blockquote>
<div><p>This will merge <strong>2 commits</strong> from <strong>week2</strong> into <strong>main</strong></p>
</div></blockquote>
<p>Tells us the number of commits that will be merged into <code class="docutils literal notranslate"><span class="pre">main</span></code>. Note that you may see a different number of commits
here - as long as you have no conflicts, this isn’t a problem.</p>
<p>Select <strong>Create a merge commit</strong> - this will create a new commit that merges the two branches together. For now, don’t
worry about the other options for merging branches together.</p>
<p>Once you’ve created the merge commit, you should see that <strong>Fetch origin</strong> has changed to <strong>Push origin</strong> - this will
<strong>push</strong> (upload) the changes you’ve made locally to your <strong>GitHub</strong> repository:</p>
<a class="reference internal image-reference" href="../../../_images/desktop_push.png"><img alt="pushing changes from the github desktop window" class="align-center" src="../../../_images/desktop_push.png" style="width: 600px;" /></a>
<p><br /> Once the changes have been pushed, go back to your <strong>GitHub</strong> repository (<code class="samp docutils literal notranslate"><span class="pre">https://github.com/&lt;</span><em><span class="pre">your_username</span></em><span class="pre">&gt;/egm722</span></code>).
You should now see that your <code class="docutils literal notranslate"><span class="pre">main</span></code> branch has both the <strong>Week1</strong> and <strong>Week2</strong> folders:</p>
<a class="reference internal image-reference" href="../../../_images/github_merged.png"><img alt="the github repository showing the merged files" class="align-center" src="../../../_images/github_merged.png" style="width: 720px;" /></a>
<p><br /> You can also confirm the changes in your <strong>local</strong> folder:</p>
<a class="reference internal image-reference" href="../../../_images/merged.png"><img alt="the repository folder showing the merged materials" class="align-center" src="../../../_images/merged.png" style="width: 600px;" /></a>
<p><br /> At this point, you should be ready to open jupyter and work your way through the Week 2 Notebook, following the
same initial steps as last week.</p>
</div>
<div class="section" id="running-the-script">
<h2>Running the script<a class="headerlink" href="#running-the-script" title="Permalink to this headline">#</a></h2>
<p>To edit the script (<strong>practical2_script.py</strong>), open it in your IDE. If your IDE has a built-in terminal/python
interpreter, you can also run the script directly from the IDE:</p>
<a class="reference internal image-reference" href="../../../_images/pycharm.png"><img alt="the script open in the pycharm IDE" class="align-center" src="../../../_images/pycharm.png" style="width: 720px;" /></a>
<p><br /> Otherwise, you can use the <strong>command prompt</strong>; the procedure will be effectively the same.</p>
<p>Launch the command prompt from <strong>Anaconda Navigator</strong>, taking care to ensure that your <code class="docutils literal notranslate"><span class="pre">egm722</span></code> environment is
selected (rather than the <code class="docutils literal notranslate"><span class="pre">base</span></code> environment). When it launches, you should see the following window:</p>
<a class="reference internal image-reference" href="../../../_images/prompt3.png"><img alt="the conda prompt" class="align-center" src="../../../_images/prompt3.png" style="width: 600px;" /></a>
<p><br /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If, instead of <code class="docutils literal notranslate"><span class="pre">(egm722)</span></code>, you see <code class="docutils literal notranslate"><span class="pre">(base)</span></code> next to the command prompt, you will need to <em>activate</em> the correct
environment by typing:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>activate<span class="w"> </span>egm722
</pre></div>
</div>
<p>and pressing <strong>ENTER</strong>.</p>
</div>
<p>Navigate to the week 2 folder using the <code class="docutils literal notranslate"><span class="pre">cd</span></code> command. You should see the jupyter-notebook file, as well as the script:</p>
<a class="reference internal image-reference" href="../../../_images/week2_dir.png"><img alt="the contents of the week 2 directory in the command prompt" class="align-center" src="../../../_images/week2_dir.png" style="width: 600px;" /></a>
<p><br /> Remember that we can use python in two ways, either interactive or script mode. We also have a choice of two
different interpreters - either <code class="docutils literal notranslate"><span class="pre">python</span></code> (the standard python interpreter) or <code class="docutils literal notranslate"><span class="pre">ipython</span></code> (an enhanced interactive
interpreter).</p>
<p>I recommend using IPython instead of the standard interpreter when using interactive mode – the interpreter highlights
syntax, it keeps track of your sessions and enables you to easily look back over your command history, enables you to
use some shell commands from within the interpreter, and also enables tab completion for commands, variable names,
and filenames.</p>
<p>You can run any script from start to finish using either interpreter by typing <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">script.py</span></code> (or
<code class="docutils literal notranslate"><span class="pre">ipython</span> <span class="pre">script.py</span></code>, although the benefits of using IPython come from running python in interactive mode rather than
script mode).</p>
<a class="reference internal image-reference" href="../../../_images/script_run3.png"><img alt="the result of running the script from the command prompt" class="align-center" src="../../../_images/script_run3.png" style="width: 600px;" /></a>
<p><br /> If you want to be able to troubleshoot the script, or run additional commands after the script has finished running,
you can also start the interpreter in interactive mode by typing <code class="docutils literal notranslate"><span class="pre">ipython</span> <span class="pre">-i</span> <span class="pre">script.py</span></code>:</p>
<a class="reference internal image-reference" href="../../../_images/ipython_script.png"><img alt="the result of running the script from the command prompt using ipython -i" class="align-center" src="../../../_images/ipython_script.png" style="width: 600px;" /></a>
<p><br /> To show the plot, use <code class="docutils literal notranslate"><span class="pre">plt.show()</span></code>:</p>
<a class="reference internal image-reference" href="../../../_images/plot.png"><img alt="the plot window open from ipython" class="align-center" src="../../../_images/plot.png" style="width: 600px;" /></a>
<p><br /> You can also turn on interactive plotting using <code class="docutils literal notranslate"><span class="pre">plt.ion()</span></code>, which will update the plot each time you run a
plotting command – similar to how it worked in the Jupyter Notebook.</p>
<p>Once you have finished the exercise, you can try adding other features to your map, work on re-creating some of the maps
that you created in EGM711, or try some of the examples shown on the
<a class="reference external" href="https://scitools.org.uk/cartopy/docs/v0.13/matplotlib/intro.html">cartopy website</a>.
Can you work out how to include a basemap to your image, based on some of the examples provided?</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Below this point is the <strong>non-interactive</strong> text of the notebook. To actually run the notebook, you’ll need to
follow the instructions above to open the notebook and run it on your own computer!</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="ryan-gosling">
<h2>Ryan Gosling<a class="headerlink" href="#ryan-gosling" title="Permalink to this headline">#</a></h2>
<p>In the first practical for EGM711, you learned how to use ArcGIS Pro to
make maps, given shapefiles of different features of interest in
Northern Ireland. In this practical, you will repeat the exercise, this
time using <code class="docutils literal notranslate"><span class="pre">cartopy</span></code>, <code class="docutils literal notranslate"><span class="pre">geopandas</span></code>, and <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>, three python
packages used for making maps, working with vector data, and making
plots, respectively.</p>
<div class="section" id="objectives">
<h3>Objectives<a class="headerlink" href="#objectives" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>become familiar with geopandas, cartopy, and matplotlib, including
reading the provided documentation</p></li>
<li><p>use list comprehensions to simplify some for loops</p></li>
</ul>
</div>
<div class="section" id="id1">
<h3>1. Getting started<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<p>First, run the cell below. It will load the python modules we’ll be
using in the practical, as well as define a few helper functions that
we’ll use later on. For now, don’t worry too much about what each
individual line does - we’ll go over these in a bit more depth as we go.
Remember also that if you get stuck, you can get help in a few ways:</p>
<ol class="arabic simple">
<li><p>the built-in help (i.e., <code class="docutils literal notranslate"><span class="pre">help(plt.text)</span></code>)</p></li>
<li><p>using ipython’s (the python interpreter used by jupyter-notebooks)
help shortcut (i.e., <code class="docutils literal notranslate"><span class="pre">plt.text?</span></code>)</p></li>
<li><p>finding the online documentation for the module (usually achieved via
option 4)</p></li>
<li><p>searching google (or your search engine of choice)</p></li>
<li><p>consulting your favorite medicine man/shaman/spiritual guide</p></li>
<li><p>asking the instructor, who will in all likelihood resort to one of
the other options (usually 5 or 4).</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this lets us use the figures interactively</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">cartopy.feature</span> <span class="kn">import</span> <span class="n">ShapelyFeature</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">mpatches</span>
<span class="kn">import</span> <span class="nn">matplotlib.lines</span> <span class="k">as</span> <span class="nn">mlines</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span> <span class="c1"># make the plotting interactive</span>

<span class="c1"># generate matplotlib handles to create a legend of the features we put in our map.</span>
<span class="k">def</span> <span class="nf">generate_handles</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">edge</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">lc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>  <span class="c1"># get the length of the color list</span>
    <span class="n">handles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)):</span>
        <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpatches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="n">lc</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">edge</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">handles</span>

<span class="c1"># create a scale bar of length 20 km in the upper right corner of the map</span>
<span class="c1"># adapted this question: https://stackoverflow.com/q/32333870</span>
<span class="c1"># answered by SO user Siyh: https://stackoverflow.com/a/35705477</span>
<span class="k">def</span> <span class="nf">scale_bar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="p">(</span><span class="mf">0.92</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">)):</span>
    <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_extent</span><span class="p">()</span>
    <span class="n">sbx</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sby</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">*</span> <span class="n">location</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">sbx</span><span class="p">,</span> <span class="n">sbx</span> <span class="o">-</span> <span class="mi">20000</span><span class="p">],</span> <span class="p">[</span><span class="n">sby</span><span class="p">,</span> <span class="n">sby</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">projection</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">sbx</span><span class="p">,</span> <span class="n">sbx</span> <span class="o">-</span> <span class="mi">10000</span><span class="p">],</span> <span class="p">[</span><span class="n">sby</span><span class="p">,</span> <span class="n">sby</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">projection</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">sbx</span><span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="n">sbx</span> <span class="o">-</span> <span class="mi">20000</span><span class="p">],</span> <span class="p">[</span><span class="n">sby</span><span class="p">,</span> <span class="n">sby</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">projection</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">sbx</span><span class="p">,</span> <span class="n">sby</span><span class="o">-</span><span class="mi">4500</span><span class="p">,</span> <span class="s1">&#39;20 km&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">projection</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">sbx</span><span class="o">-</span><span class="mi">12500</span><span class="p">,</span> <span class="n">sby</span><span class="o">-</span><span class="mi">4500</span><span class="p">,</span> <span class="s1">&#39;10 km&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">projection</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">sbx</span><span class="o">-</span><span class="mi">24500</span><span class="p">,</span> <span class="n">sby</span><span class="o">-</span><span class="mi">4500</span><span class="p">,</span> <span class="s1">&#39;0 km&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">projection</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="c1"># load the outline of Northern Ireland for a backdrop</span>
<span class="n">outline</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;data_files/NI_outline.shp&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="loading-the-data">
<h3>2. Loading the data<a class="headerlink" href="#loading-the-data" title="Permalink to this headline">#</a></h3>
<p>Great. Now that we’ve imported most of the modules we’ll be needing, and
defined a few helper functions, we can actually load our data. To load
the shapefile data, we will use <a class="reference external" href="http://geopandas.org/">GeoPandas</a>,
an open-source package designed to make working with geospatial data in
python easier.</p>
<p>GeoPandas is built off of Pandas, a powerful data analysis tool. We will
be working with both of these packages more in the weeks to come.</p>
<p>To open a shapefile, we use the <code class="docutils literal notranslate"><span class="pre">gpd.read_file()</span></code>
(<a class="reference external" href="https://geopandas.org/en/stable/docs/reference/api/geopandas.read_file.html">documentation</a>)
method:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">towns</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;data_files/Towns.shp&#39;</span><span class="p">))</span>
<span class="n">water</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;data_files/Water.shp&#39;</span><span class="p">))</span>
<span class="n">rivers</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;data_files/Rivers.shp&#39;</span><span class="p">))</span>
<span class="n">counties</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;data_files/Counties.shp&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>GeoPandas loads the data associated with a shapefile into a
GeoDataFrame, a tabular data structure that always has a column
describing a feature’s geometry. Each line in the table corresponds to a
feature in the shapefile, just like the attribute table you are familiar
with from ArcGIS/QGIS.</p>
<p>To see a subset of a GeoDataFrame, we can use the <code class="docutils literal notranslate"><span class="pre">head()</span></code>
(<a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.head.html">documentation</a>)
method:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">water</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>To select rows in the dataframe using an index, we can use <code class="docutils literal notranslate"><span class="pre">.loc</span></code>
(<a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.loc.html">documentation</a>):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">water</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># should show the row for Lough Neagh</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">.loc</span></code> is not a method, since we use square brackets:<code class="docutils literal notranslate"><span class="pre">[</span></code>
and <code class="docutils literal notranslate"><span class="pre">]</span></code>, instead of round brackets/parentheses. Instead, it’s a way to
index or slice a GeoDataFrame.</p>
<p>This means that we can also use <code class="docutils literal notranslate"><span class="pre">.loc</span></code> with conditional statements.
For example, if we wanted to select all bodies of water that are smaller
than 1 square kilometer, we could use something like this:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">water</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">water</span><span class="p">[</span><span class="s1">&#39;Area_km2&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>Note that with only a single value, <code class="docutils literal notranslate"><span class="pre">.loc</span></code> returns all columns of the
GeoDataFrame where the rows match the given index/conditional statement.</p>
<p>To select a specific column or group of columns, we can use a comma to
separate the different indexers. For example, if we want to select only
the name of the lakes that are smaller than 1 square kilometer, we can
use the following:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">water</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">water</span><span class="p">[</span><span class="s1">&#39;Area_km2&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;namespace&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Each “column” of the GeoDataFrame is an object of type Series
(<a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html">documentation</a>).</p>
<p>If a Series is filled with numeric data, we can use different methods
such as <code class="docutils literal notranslate"><span class="pre">.sum()</span></code>
(<a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.sum.html">documentation</a>)
or <code class="docutils literal notranslate"><span class="pre">.mean()</span></code>
(<a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.mean.html">documentation</a>),
to get the sum and mean of the values in the Series, respectively.</p>
<p>So, the total area (in square kilometers) of all of the lakes in the
dataset would be given by the following statement:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">water</span><span class="p">[</span><span class="s1">&#39;Area_km2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<p>We’ll work with GeoDataFrames more in next week’s practical, but for now
see if you can put these different pieces together and figure out the
total area of lakes in the <code class="docutils literal notranslate"><span class="pre">Water</span></code> dataset that are smaller than 10
square kilometers. I’ll provide two hints to get you started:</p>
<ol class="arabic simple">
<li><p>GeoDataFrames can be subset using a conditional and a column in the
GeoDataFrame, like we saw above.</p></li>
<li><p>With only a single value, <code class="docutils literal notranslate"><span class="pre">.loc</span></code> returns all columns of the
GeoDataFrame where the rows match the given index/conditional
statement. To select a specific column or group of columns, we can
use a comma to separate the different indexers.</p></li>
<li><p>The numerical columns of a GeoDataFrame (also called Series or
GeoSeries) have built-in operators such as <strong>max</strong>, <strong>min</strong>,
<strong>mean</strong>, and so on.</p></li>
</ol>
<p>That should be enough to get you started - if you get stuck, be sure to
ask for help.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># write a statement (or series of statments) to calculate the total area of lakes &lt; 10 km2 in the water dataset.</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-maps-with-matplotlib-and-cartopy">
<h3>3. Creating maps with matplotlib and cartopy<a class="headerlink" href="#creating-maps-with-matplotlib-and-cartopy" title="Permalink to this headline">#</a></h3>
<p>Now that we’re more familiar with the dataset, we can start building our
map. For this portion of the practical, we’ll be mostly using
<a class="reference external" href="https://matplotlib.org/">matplotlib</a>, a python package designed for
making plots and graphs, and
<a class="reference external" href="https://scitools.org.uk/cartopy/docs/latest/">cartopy</a>, a package
designed for making maps and representing geopatial data.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">myFig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>  <span class="c1"># create a figure of size 10x10 (representing the page size in inches)</span>

<span class="n">myCRS</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">UTM</span><span class="p">(</span><span class="n">XX</span><span class="p">)</span>  <span class="c1"># create a Universal Transverse Mercator reference system to transform our data.</span>
<span class="c1"># be sure to fill in XX above with the correct number for the UTM Zone that Northern Ireland is part of.</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">myCRS</span><span class="p">)</span>  <span class="c1"># finally, create an axes object in the figure, using a UTM projection,</span>
<span class="c1"># where we can actually plot our data.</span>
</pre></div>
</div>
<div class="section" id="adding-data-to-the-map">
<h4>Adding data to the map<a class="headerlink" href="#adding-data-to-the-map" title="Permalink to this headline">#</a></h4>
<p>Now that we’ve created a figure and axes, we can start adding data to
the map. To start, we’ll add the municipal borders.</p>
<p>In order to add these to the map, we first have to create features that
we can add to the axes using the <code class="docutils literal notranslate"><span class="pre">ShapelyFeature</span></code> class from
<code class="docutils literal notranslate"><span class="pre">cartopy.feature</span></code>. The initialization method for this class takes a
minimum of two arguments, an <strong>iterable</strong> containing the geometries that
we’re using, and a CRS representation.</p>
<p>To add the County borders, then, we would use <code class="docutils literal notranslate"><span class="pre">counties['geometry']</span></code>,
the GeoSeries of the feature geometries in our Municipalities shapefile,
and <code class="docutils literal notranslate"><span class="pre">myCRS</span></code>, the CRS object representing the UTM Zone for Northern
Ireland:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first, we just add the outline of Northern Ireland using cartopy&#39;s ShapelyFeature</span>
<span class="n">outline_feature</span> <span class="o">=</span> <span class="n">ShapelyFeature</span><span class="p">(</span><span class="n">outline</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">],</span> <span class="n">myCRS</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">outline</span><span class="o">.</span><span class="n">total_bounds</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">outline_feature</span><span class="p">)</span> <span class="c1"># add the features we&#39;ve created to the map.</span>
</pre></div>
</div>
<p>The other arguments that we pass to <code class="docutils literal notranslate"><span class="pre">ShapelyFeature</span></code> tell
<code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> how to draw the features - in this case, with an edge
color of black and a face color of gray. Once we’ve created the
features, we add them to the axes using the <code class="docutils literal notranslate"><span class="pre">add_feature</span></code> method.</p>
<p>We’ll also want to zoom the map into our area of interest using the
boundary of the shapefile features (using <code class="docutils literal notranslate"><span class="pre">ax.set_extent</span></code>). In the
example below, we’re setting the extent with a 5 km buffer around each
edge:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># using the boundary of the shapefile features, zoom the map to our area of interest</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">xmin</span><span class="o">-</span><span class="mi">5000</span><span class="p">,</span> <span class="n">xmax</span><span class="o">+</span><span class="mi">5000</span><span class="p">,</span> <span class="n">ymin</span><span class="o">-</span><span class="mi">5000</span><span class="p">,</span> <span class="n">ymax</span><span class="o">+</span><span class="mi">5000</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">myCRS</span><span class="p">)</span> <span class="c1"># because total_bounds</span>
<span class="c1"># gives output as xmin, ymin, xmax, ymax,</span>
<span class="c1"># but set_extent takes xmin, xmax, ymin, ymax, we re-order the coordinates here.</span>

<span class="n">myFig</span> <span class="c1">## re-draw the figure</span>
</pre></div>
</div>
<p>This is fine, but a bit boring. For one thing, we might want to set
different colors for the different municipalities, rather than having
them all be the same color. To do this, we’ll first have to count the
number of <strong>unique</strong> municipalities in our dataset, then select colors
to represent each of them.</p>
<p>Question: Why might we do this, rather than just use the number of
features in the dataset?</p>
<p>Run the cell below to count the number of unique municipalities in the
dataset, using the <code class="docutils literal notranslate"><span class="pre">unique</span></code> method on the <strong>CountyName</strong> GeoSeries.</p>
<p>Note that in addition to the standard indexing (i.e.,
<code class="docutils literal notranslate"><span class="pre">counties['CountyName']</span></code>), we are accessing <strong>CountyName</strong> directly as
an attribute of <code class="docutils literal notranslate"><span class="pre">counties</span></code> (i.e., <code class="docutils literal notranslate"><span class="pre">counties.CountyName</span></code>).</p>
<p>Provided that the column name follows particular rules (<a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/indexing.html#attribute-access">more on this
here</a>),
there is no difference between these two methods - they give the same
results.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the number of unique municipalities we have in the dataset</span>
<span class="n">num_counties</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">counties</span><span class="o">.</span><span class="n">CountyName</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of unique features: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_counties</span><span class="p">))</span> <span class="c1"># note how we&#39;re using {} and format here!</span>
</pre></div>
</div>
<p>Now that you’ve found the number of colors you need to choose, you can
use the image below to make a list of the colors. There are other ways
to select colors using matplotlib, including using RGB values, but
that’s for another day. If you’re interested in learning more, you can
check out the documentation
<a class="reference external" href="https://matplotlib.org/stable/api/colors_api.html">here</a>.</p>
<p><img alt="the named colors in matplotlib" src="../../../_images/named_colors.png" />
<a class="reference external" href="https://matplotlib.org/stable/gallery/color/named_colors.html">source</a></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pick colors for the individual county boundaries - make sure to add enough for each of the counties</span>
<span class="c1"># to add a color, enclose the name above (e.g., violet) with single (or double) quotes: &#39;violet&#39;</span>
<span class="c1"># remember that each colors should be separated by a comma</span>
<span class="n">county_colors</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># get a list of unique names for the county boundaries</span>
<span class="n">county_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">counties</span><span class="o">.</span><span class="n">CountyName</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">county_names</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span> <span class="c1"># sort the counties alphabetically by name</span>

<span class="c1"># next, add the municipal outlines to the map using the colors that we&#39;ve picked.</span>
<span class="c1"># here, we&#39;re iterating over the unique values in the &#39;CountyName&#39; field.</span>
<span class="c1"># we&#39;re also setting the edge color to be black, with a line width of 0.5 pt.</span>
<span class="c1"># Feel free to experiment with different colors and line widths.</span>
<span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">county_names</span><span class="p">):</span>
    <span class="n">feat</span> <span class="o">=</span> <span class="n">ShapelyFeature</span><span class="p">(</span><span class="n">counties</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">counties</span><span class="p">[</span><span class="s1">&#39;CountyName&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">name</span><span class="p">,</span> <span class="s1">&#39;geometry&#39;</span><span class="p">],</span> <span class="c1"># first argument is the geometry</span>
                          <span class="n">myCRS</span><span class="p">,</span> <span class="c1"># second argument is the CRS</span>
                          <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="c1"># outline the feature in black</span>
                          <span class="n">facecolor</span><span class="o">=</span><span class="n">county_colors</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="c1"># set the face color to the corresponding color from the list</span>
                          <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="c1"># set the outline width to be 1 pt</span>
                          <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span> <span class="c1"># set the alpha (transparency) to be 0.25 (out of 1)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">feat</span><span class="p">)</span> <span class="c1"># once we have created the feature, we have to add it to the map using ax.add_feature()</span>

<span class="n">myFig</span> <span class="c1"># to show the updated figure</span>
</pre></div>
</div>
<p>Now that we’ve done this for the municipal boundaries, we can also do
this for the water datasets. Because we want the water bodies to be the
same symbology, we add them with a single use of <strong>ShapelyFeature</strong>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># here, we&#39;re setting the edge color to be the same as the face color. Feel free to change this around,</span>
<span class="c1"># and experiment with different line widths.</span>
<span class="n">water_feat</span> <span class="o">=</span> <span class="n">ShapelyFeature</span><span class="p">(</span><span class="n">water</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">],</span> <span class="c1"># first argument is the geometry</span>
                            <span class="n">myCRS</span><span class="p">,</span> <span class="c1"># second argument is the CRS</span>
                            <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;mediumblue&#39;</span><span class="p">,</span> <span class="c1"># set the edgecolor to be mediumblue</span>
                            <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;mediumblue&#39;</span><span class="p">,</span> <span class="c1"># set the facecolor to be mediumblue</span>
                            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># set the outline width to be 1 pt</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">water_feat</span><span class="p">)</span> <span class="c1"># add the collection of features to the map</span>

<span class="n">myFig</span> <span class="c1"># to show the updated figure</span>
</pre></div>
</div>
<p>We do the same thing with the rivers. However, because these are
<strong>Line</strong> objects, not <strong>Polygon</strong>s, we don’t set the <code class="docutils literal notranslate"><span class="pre">facecolor</span></code>
property:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">river_feat</span> <span class="o">=</span> <span class="n">ShapelyFeature</span><span class="p">(</span><span class="n">rivers</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">],</span> <span class="c1"># first argument is the geometry</span>
                            <span class="n">myCRS</span><span class="p">,</span> <span class="c1"># second argument is the CRS</span>
                            <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="c1"># set the edgecolor to be royalblue</span>
                            <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span> <span class="c1"># set the linewidth to be 0.2 pt</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">river_feat</span><span class="p">)</span> <span class="c1"># add the collection of features to the map</span>

<span class="n">myFig</span> <span class="c1"># to show the updated figure</span>
</pre></div>
</div>
<p>For <strong>Point</strong> data, such as the town locations, we can use <code class="docutils literal notranslate"><span class="pre">ax.plot()</span></code>
directly.</p>
<p>The code below will add a gray (<code class="docutils literal notranslate"><span class="pre">color='0.5'</span></code>) square (<code class="docutils literal notranslate"><span class="pre">'s'</span></code>) marker
of size 6 (<code class="docutils literal notranslate"><span class="pre">ms=6</span></code>) at each x, y location:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ShapelyFeature creates a polygon, so for point data we can just use ax.plot()</span>
<span class="n">town_handle</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">towns</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">towns</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">myCRS</span><span class="p">)</span>

<span class="n">myFig</span> <span class="c1"># to show the updated figure</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-labels-and-legends">
<h4>Adding labels and legends<a class="headerlink" href="#adding-labels-and-legends" title="Permalink to this headline">#</a></h4>
<p>Now that we have different colors for each of the county boundaries and
we’ve displayed lakes, rivers, and towns, it might be good to have a
legend to keep everything straight.</p>
<p>To do this, we get handles for each of the county boundaries, using the
colors we defined earlier. Here, we’re using our helper function
<code class="docutils literal notranslate"><span class="pre">generate_handles</span></code>, which returns a list of <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> handles
(i.e., the symbol that <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> uses to display the objects in the
figure), given a list of labels and colors.</p>
<p>We then do the same for the water bodies and rivers:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># generate a list of handles for the county datasets</span>
<span class="c1"># first, we add the list of names, then the list of colors, and finally we set the transparency</span>
<span class="c1"># (since we set it in the map)</span>
<span class="n">county_handles</span> <span class="o">=</span> <span class="n">generate_handles</span><span class="p">(</span><span class="n">counties</span><span class="o">.</span><span class="n">CountyName</span><span class="o">.</span><span class="n">unique</span><span class="p">(),</span> <span class="n">county_colors</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

<span class="c1"># note: if you change the color you use to display lakes, you&#39;ll want to change it here, too</span>
<span class="n">water_handle</span> <span class="o">=</span> <span class="n">generate_handles</span><span class="p">([</span><span class="s1">&#39;Lakes&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;mediumblue&#39;</span><span class="p">])</span>

<span class="c1"># note: if you change the color you use to display rivers, you&#39;ll want to change it here, too</span>
<span class="n">river_handle</span> <span class="o">=</span> <span class="p">[</span><span class="n">mlines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p>Note that the names in our county dataset are all uppercase - that’s not
necessarily how we want to display them on the map. To change this, we
can use a string method called <strong>title()</strong>, which will capitalize the
first letter of each word in a string. We also have to do this for each
of the items in our list of names. We <em>could</em> write this as a <strong>for</strong>
loop, like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nice_names</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># initalize an empty list</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">county_names</span><span class="p">:</span>
    <span class="n">nice_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">title</span><span class="p">())</span>
</pre></div>
</div>
<p>But, python offers another, cleaner option, called a <a class="reference external" href="https://docs.python.org/3/tutorial/datastructures.html#list-comprehensions">list
comprehension</a>.
A list comprehension allows us to generate a new list from an existing
iterable. To write the same <strong>for</strong> loop above as a list comprehension
takes one line:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># update county_names to take it out of uppercase text</span>
<span class="n">nice_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">county_names</span><span class="p">]</span>
</pre></div>
</div>
<p>That’s it. This creates a new list by iterating over each of the items
in county_names, applying a method, <strong>str.title()</strong>, to each item. We’ll
work more with list comprehensions throughout the module, as they
provide a way to simplify some pretty complicated loops.</p>
<p>We can pass each of our lists of handles and labels to <code class="docutils literal notranslate"><span class="pre">plt.legend</span></code>,
to generate a legend for the municipal boundaries data. Feel free to
experiment with the placement (by changing <strong>loc</strong> and/or
<strong>bbox_to_anchor</strong>), or the font size, the title font size, and so on.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ax.legend() takes a list of handles and a list of labels corresponding to the objects</span>
<span class="c1"># you want to add to the legend</span>
<span class="n">handles</span> <span class="o">=</span> <span class="n">county_handles</span> <span class="o">+</span> <span class="n">water_handle</span> <span class="o">+</span> <span class="n">river_handle</span> <span class="o">+</span> <span class="n">town_handle</span> <span class="c1"># use &#39;+&#39; to concatenate (combine) lists</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">nice_names</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;Lakes&#39;</span><span class="p">,</span> <span class="s1">&#39;Rivers&#39;</span><span class="p">,</span> <span class="s1">&#39;Towns&#39;</span><span class="p">]</span>

<span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Legend&#39;</span><span class="p">,</span> <span class="n">title_fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">myFig</span> <span class="c1"># to show the updated figure</span>
</pre></div>
</div>
<p>Now that we have a legend, let’s go ahead and add grid lines to our
plot. I’ve chosen some default gridlines, but you can feel free to
change this.</p>
<p>What happens if you delete the first and/or last value from xlocs and
ylocs? Try it and see!</p>
<p>Can you change the labels to show only on the bottom and left side of
the map? To see, try looking at this
<a class="reference external" href="https://scitools.org.uk/cartopy/docs/latest/gallery/gridlines_and_labels/gridliner.html">example</a>,
or at the
<a class="reference external" href="https://scitools.org.uk/cartopy/docs/latest/reference/generated/cartopy.mpl.gridliner.Gridliner.html#cartopy.mpl.gridliner.Gridliner">documentation</a>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gridlines</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># draw  labels for the grid lines</span>
                         <span class="n">xlocs</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.5</span><span class="p">],</span> <span class="c1"># add longitude lines at 0.5 deg intervals</span>
                         <span class="n">ylocs</span><span class="o">=</span><span class="p">[</span><span class="mi">54</span><span class="p">,</span> <span class="mf">54.5</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mf">55.5</span><span class="p">])</span> <span class="c1"># add latitude lines at 0.5 deg intervals</span>
<span class="n">gridlines</span><span class="o">.</span><span class="n">left_labels</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># turn off the left-side labels</span>
<span class="n">gridlines</span><span class="o">.</span><span class="n">bottom_labels</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># turn off the bottom labels</span>

<span class="n">myFig</span> <span class="c1"># to show the updated figure</span>
</pre></div>
</div>
<p>Excellent. Now, let’s add text labels for each of our individual towns.
For each of the points representing our towns/cities, we can place a
text label. Look over the cell below, and make sure you understand what
each line is doing. If you’re not sure you understand, you can post your
questions on Blackboard.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">towns</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span> <span class="c1"># towns.iterrows() returns the index and row</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">y</span> <span class="c1"># get the x,y location for each town</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;TOWN_NAME&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">myCRS</span><span class="p">)</span> <span class="c1"># use plt.text to place a label at x,y</span>

<span class="n">myFig</span> <span class="c1"># to show the updated figure</span>
</pre></div>
</div>
<p>Last but not least, let’s add a scale bar to the plot. The scale_bar
function we’ve defined above will produce a scale bar with divisions at
10 and 20 km, with a location in the upper right corner as default. Try
to experiment with this a bit - can you design a scale bar with
divisions at 1, 5, and 10 km? It’s not as straightforward as it is in
ArcGIS, but it might provide an interesting challenge if you’re
interested in developing your programming skills a bit.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scale_bar</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

<span class="n">myFig</span> <span class="c1"># to show the updated figure</span>
</pre></div>
</div>
<p>Finally, we’ll save our figure. The command written below will save the
figure to the current folder, in a file called <code class="docutils literal notranslate"><span class="pre">map.png</span></code>, with no
border around the outside of the map, and with a resolution of 300 dots
per inch. As always, feel free to change these parameters.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">myFig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;map.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="next-steps">
<h3>Next steps<a class="headerlink" href="#next-steps" title="Permalink to this headline">#</a></h3>
<p>In this directory, you should also have a python script,
<strong>practical2_script.py</strong>, which will create the same map that we’ve made
here (though perhaps with different colors).</p>
<p>Note that the <strong>towns</strong> dataset has an attribute, <strong>STATUS</strong>, that
describes whether the feature represents a <strong>Town</strong> (e.g., Coleraine),
or a <strong>City</strong> (e.g., Belfast). As a further exercise, see if you can
modify the script to plot all of the <strong>Towns</strong> with one marker (e.g.,
the gray square used above), and plot all of the <strong>Cities</strong> plot with a
different marker, then add these to the legend. For more information on
the available markers and colors for matplotlib, see the
<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.plot.html">documentation</a>.</p>
</div>
</div>
</div>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="debugging.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">debugging exercise</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="week3.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">vector data using shapely and geopandas</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Bob McNabb<br/>
  
      &copy; Copyright 2023, Bob McNabb. Licensed under Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0).<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>