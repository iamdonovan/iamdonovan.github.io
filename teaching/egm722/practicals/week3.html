
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>vector data using shapely and geopandas &#8212; space cameras and glaciers</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" href="../../../_static/customstyle.css" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="../../../_static/design-tabs.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="interactive maps with folium" href="folium.html" />
    <link rel="prev" title="mapping with cartopy" href="week2.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">space cameras and glaciers</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../whataboutbob.html">
   about me
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../index.html">
   teaching
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../egm101/index.html">
     EGM101: skills toolbox
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm101/lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../egm101/practicals/index.html">
       practicals
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
      <label for="toctree-checkbox-3">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm101/practicals/week5.html">
         computation, summary statistics, and graphing in excel
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm101/practicals/week6.html">
         summarizing and graphing data in spss
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm101/practicals/week7.html">
         correlation and regression in spss
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm101/practicals/week8.html">
         hypothesis testing using spss
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm101/resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../egm310/index.html">
     EGM310: introduction to gis and remote sensing
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm310/lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm310/resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../egm702/index.html">
     EGM702: photogrammetry and advanced image analysis
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm702/lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../egm702/practicals/index.html">
       practicals
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
      <label for="toctree-checkbox-6">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/setup.html">
         software setup
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/week1.html">
         dem processing using micmac
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/week2.html">
         dem differencing
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/week3.html">
         introduction to google earth engine
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/week4.html">
         change detection in earth engine
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/week5.html">
         classification in earth engine
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm702/resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../egm703/index.html">
     EGM703: advanced active and passive remote sensing
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm703/lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../egm703/practicals/index.html">
       practicals
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
      <label for="toctree-checkbox-8">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm703/practicals/week1.html">
         urban heat islands
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm703/practicals/week2.html">
         hyperspectral image analysis
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm703/practicals/week3.html">
         SAR image processing
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm703/practicals/week4.html">
         InSAR Processing
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm703/practicals/week5.html">
         SAR image interpretation and flood mapping
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm703/resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="../index.html">
     EGM722: programming for gis and remote sensing
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../setup/index.html">
       setup
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
      <label for="toctree-checkbox-10">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/github.html">
         setting up github
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/git.html">
         installing git
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/desktop.html">
         installing github desktop
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/fork.html">
         forking the repository
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/clone.html">
         cloning the repository
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/conda.html">
         setting up conda/anaconda
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/environment.html">
         setting up a conda environment
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/jupyter.html">
         configuring jupyter
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/pycharm.html">
         pycharm
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/pip.html">
         installing packages with pip
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3 current active has-children">
      <a class="reference internal" href="index.html">
       practicals
      </a>
      <input checked="" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
      <label for="toctree-checkbox-11">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul class="current">
       <li class="toctree-l4">
        <a class="reference internal" href="week1.html">
         intro to python
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="debugging.html">
         debugging exercise
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="week2.html">
         mapping with cartopy
        </a>
       </li>
       <li class="toctree-l4 current active">
        <a class="current reference internal" href="#">
         vector data using shapely and geopandas
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="folium.html">
         interactive maps with folium
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="week4.html">
         raster data using rasterio
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="sentinelsat.html">
         searching for images with sentinelsat
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="week5.html">
         vector and raster operations using python
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../faq/index.html">
       help! something went wrong!
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
      <label for="toctree-checkbox-12">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../faq/git.html">
         git troubleshooting
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../faq/python.html">
         python troubleshooting
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../project/index.html">
       programming project
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
      <label for="toctree-checkbox-13">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../project/github.html">
         creating a new github repository
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../project/environment.html">
         environment.yml
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../unis/index.html">
     unis glaciology (AG-325)
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../unis/optical.html">
       mapping glacier area change
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../unis/dems.html">
       dem differencing and geodetic mass balance
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../r-programming/index.html">
     programming skills for phd researchers
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../r-programming/setup/index.html">
       setup
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
      <label for="toctree-checkbox-16">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../r-programming/setup/github.html">
         setting up github
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../r-programming/setup/git.html">
         installing git
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../r-programming/setup/desktop.html">
         installing github desktop
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../r-programming/setup/fork.html">
         forking the repository
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../r-programming/setup/clone.html">
         cloning the repository
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../r-programming/setup/conda.html">
         setting up conda/anaconda
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../r-programming/setup/environment.html">
         setting up a conda environment
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../r-programming/setup/jupyter.html">
         configuring jupyterlab
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../r-programming/lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../r-programming/exercises/index.html">
       exercises
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
      <label for="toctree-checkbox-17">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../r-programming/exercises/git.html">
         introduction to version control using git
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../r-programming/exercises/project.html">
         starting a new project
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../r-programming/exercises/rintro.html">
         introduction to
         <strong>
          R
         </strong>
         using jupyterlab
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../r-programming/exercises/debugging.html">
         debugging code
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../r-programming/exercises/plotting.html">
         plotting data using ggplot2
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../r-programming/exercises/transform.html">
         transforming data
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../r-programming/exercises/stats.html">
         basic statistical analysis using
         <strong>
          R
         </strong>
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../r-programming/exercises/regression.html">
         linear regression using
         <strong>
          R
         </strong>
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../r-programming/resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../gee/index.html">
   google earth engine
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../gee/tutorials/index.html">
     gee tutorials
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
    <label for="toctree-checkbox-19">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../gee/tutorials/getting_started/index.html">
       getting started
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
      <label for="toctree-checkbox-20">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/adding_exporting.html">
         adding and exporting images
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/spectral.html">
         spectral signatures
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/image_collections.html">
         image collections and vectors
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/mapping.html">
         manual mapping (digitizing)
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/band_maths.html">
         band maths
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/zonal_stats.html">
         zonal statistics
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../gee/tutorials/classification/index.html">
       image classification
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
      <label for="toctree-checkbox-21">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/classification/unsupervised.html">
         unsupervised classification
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/classification/pixel.html">
         pixel-based classification
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/classification/obia.html">
         object-based classification
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../gee/tutorials/change_detection/index.html">
       change detection
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
      <label for="toctree-checkbox-22">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/change_detection/multitemporal_composites.html">
         multi-temporal color composites
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/change_detection/repeat_classification.html">
         repeat classification
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/change_detection/cva.html">
         change vector analysis
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/change_detection/time_series.html">
         time series analysis
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../gee/tutorials/enhancement/index.html">
       image enhancement
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
      <label for="toctree-checkbox-23">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/enhancement/filtering.html">
         image filtering
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/enhancement/pansharpening.html">
         pansharpening
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/enhancement/edge_detection.html">
         edge detection
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/enhancement/unmixing.html">
         spectral unmixing
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/enhancement/pca.html">
         principle component analysis
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../gee/tutorials/advanced/index.html">
       advanced topics
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
      <label for="toctree-checkbox-24">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/advanced/animation.html">
         creating an animation
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../gee/exercises/index.html">
     sample exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../research/index.html">
   ongoing and past research projects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
  <label for="toctree-checkbox-25">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../research/dar.html">
     deplete and retreat (DaR)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../writing/index.html">
   selected writing samples
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/>
  <label for="toctree-checkbox-26">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../writing/source.html">
     source magazine (summer 2022)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../github.html">
   github projects
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/teaching/egm722/practicals/week3.rst.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#getting-started">
   Getting Started
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#next-steps">
   Next steps
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rachel-mcadams">
   Rachel McAdams
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#overview">
     Overview
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#objectives">
     Objectives
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-provided">
     Data provided
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     1. Getting started
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#shapely-geometry-types">
     2. Shapely geometry types
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#points">
       2.1 Points
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#linestrings">
       2.2. LineStrings
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#polygons">
       2.3. Polygons
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#interactions-between-geometry-objects">
       2.4 Interactions between geometry objects
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#geopandas-geodataframes">
     3. geopandas GeoDataFrames
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coordinate-reference-systems-using-proj">
       3.1 Coordinate reference systems using PROJ
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#summarizing-data-using-geopandas">
       3.2 Summarizing data using geopandas
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spatial-data-operations-using-geopandas-and-shapely">
     4. Spatial data operations using geopandas and shapely
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-and-next-steps">
     5. Exercise and next steps
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#additional-exercise-questions">
     Additional exercise questions
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>vector data using shapely and geopandas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#getting-started">
   Getting Started
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#next-steps">
   Next steps
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rachel-mcadams">
   Rachel McAdams
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#overview">
     Overview
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#objectives">
     Objectives
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-provided">
     Data provided
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     1. Getting started
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#shapely-geometry-types">
     2. Shapely geometry types
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#points">
       2.1 Points
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#linestrings">
       2.2. LineStrings
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#polygons">
       2.3. Polygons
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#interactions-between-geometry-objects">
       2.4 Interactions between geometry objects
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#geopandas-geodataframes">
     3. geopandas GeoDataFrames
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#coordinate-reference-systems-using-proj">
       3.1 Coordinate reference systems using PROJ
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#summarizing-data-using-geopandas">
       3.2 Summarizing data using geopandas
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spatial-data-operations-using-geopandas-and-shapely">
     4. Spatial data operations using geopandas and shapely
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-and-next-steps">
     5. Exercise and next steps
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#additional-exercise-questions">
     Additional exercise questions
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="section" id="vector-data-using-shapely-and-geopandas">
<h1>vector data using shapely and geopandas<a class="headerlink" href="#vector-data-using-shapely-and-geopandas" title="Permalink to this headline">#</a></h1>
<p>In this practical, you’ll gain some more experience working with vector data in python. You will learn about the different vector
data types available in the shapely package, and how we can use the geopandas package to perform different vector data
operations and analyses.</p>
<p>The practical this week is provided as a Jupyter Notebook, where you can interactively work through the different steps of
plotting the data. There is a second file, <strong>exercise_script.py</strong>, which you can modify to perform additional analyses, based on what
you’ve learned in the Jupyter Notebook and the mapping exercise in Practical 2.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the main folder, you should also see an example script, <strong>week3_example.py</strong>. Be sure to try out the exercise, and see
if you can’t figure out a solution on your own, before having a look at the (one of many possible) solution offered there.</p>
</div>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">#</a></h2>
<p><a class="reference internal" href="week2.html"><span class="doc">Last week</span></a>, we saw how we can use <strong>GitHub Desktop</strong> to merge two branches (in this case, <code class="docutils literal notranslate"><span class="pre">week2</span></code> into <code class="docutils literal notranslate"><span class="pre">main</span></code>).
This week, we’re going to see how to do this using the command line.</p>
<p>To get started with this week’s practical, open Anaconda Navigator, then launch the <strong>Command Prompt</strong> - either from
<strong>Anaconda Navigator</strong> (make sure that your egm722 environment is selected), or from the <strong>Start Menu</strong>.</p>
<p>When the <strong>Command Prompt</strong> opens, navigate to your repository folder using <code class="docutils literal notranslate"><span class="pre">cd</span></code>, then type <code class="docutils literal notranslate"><span class="pre">dir</span></code> and press <strong>Enter</strong>.
You should see something similar to the following:</p>
<a class="reference internal image-reference" href="../../../_images/main_dir.png"><img alt="the dir of the main branch" class="align-center" src="../../../_images/main_dir.png" style="width: 600px;" /></a>
<p><br /> Switch to the <code class="docutils literal notranslate"><span class="pre">week3</span></code> branch by typing:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git checkout week3
</pre></div>
</div>
<p>and pressing <strong>Enter</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you see some version of the following:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>hint: If you meant to check out a remote tracking branch on, e.g., &#39;origin&#39;,
hint: you can do so by fully qualifying the name with the --track option:
hint:
hint:     git checkout --track origin/&lt;name&gt;
hint:
hint: If you&#39;d like to always have checkouts of an ambiguous &lt;name&gt; prefer
hint: one remote, e.g. the &#39;origin&#39; remote, consider setting
hint: checkout.defaultRemote=origin in your config
</pre></div>
</div>
<p>What this is telling you is that you <em>either</em> have to explicitly specify <strong>which</strong> remote branch
you want to check out (e.g., <code class="docutils literal notranslate"><span class="pre">origin</span></code> or <code class="docutils literal notranslate"><span class="pre">upstream</span></code>), <strong>or</strong> you should set your
<code class="docutils literal notranslate"><span class="pre">defaultRemote</span></code> option using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">config</span></code>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git config --global checkout.defaultRemote origin
</pre></div>
</div>
</div>
<p>Next, type <code class="docutils literal notranslate"><span class="pre">dir</span></code> and press <strong>Enter</strong> again. You should now see this:</p>
<a class="reference internal image-reference" href="../../../_images/week3_dir.png"><img alt="the dir of the week3 branch" class="align-center" src="../../../_images/week3_dir.png" style="width: 600px;" /></a>
<p><br /> To merge the <code class="docutils literal notranslate"><span class="pre">week3</span></code> branch of our repository into <code class="docutils literal notranslate"><span class="pre">main</span></code>, we’ll use <strong>git</strong> from the command line.</p>
<p>Remember that at the <a class="reference internal" href="week2.html#desktop-branches"><span class="std std-ref">start</span></a> of last week’s practical, we discussed the difference between
<strong>local</strong>, <strong>origin</strong>, and <strong>upstream</strong> branches:</p>
<ul class="simple">
<li><p><strong>local</strong> branches are the ones stored <em>local</em>ly on your computer,</p></li>
<li><p><strong>origin</strong> branches are the branches of your repository stored on GitHub,</p></li>
<li><p><strong>upstream</strong> branches are the branches of the repository that you forked the egm722 repository from
(<a class="reference external" href="https://github.com/iamdonovan/egm722">https://github.com/iamdonovan/egm722</a>).</p></li>
</ul>
<p>Sometimes, there may be changes to the <strong>upstream</strong> repository that we want to integrate into our local version of a
repository. For example, for this module I may have added an additional exercise to the practical in one week, and you
want to make sure that you have this before you <strong>merge</strong> that week’s branch into the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch.</p>
<p>To be able to keep track of the <strong>upstream</strong> changes, we need to make sure that our local repository knows where the
<strong>upstream</strong> repository is. First, double-check what <strong>remote</strong> (not <strong>local</strong>) repositories git is keeping track of
by typing the following at the command line:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git remote -v
</pre></div>
</div>
<p>This will list the <strong>remote</strong> repositories, and their nicknames. You should see an output like this:</p>
<a class="reference internal image-reference" href="../../../_images/remote_v.png"><img alt="the remote repositories for this repository" class="align-center" src="../../../_images/remote_v.png" style="width: 600px;" /></a>
<p><br /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you only see <strong>origin</strong>, then we need to add the <strong>upstream</strong> remote location using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">remote</span> <span class="pre">add</span></code>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git remote add upstream https://github.com/iamdonovan/egm722.git
</pre></div>
</div>
<p>This adds the URL for the <strong>upstream</strong> repository (<a class="reference external" href="https://github.com/iamdonovan/egm722.git">https://github.com/iamdonovan/egm722.git</a>) to our local
configuration. You can check that this worked by typing <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">remote</span> <span class="pre">-v</span></code> again - you should now see two lines
for the <strong>upstream</strong> repository, as above.</p>
</div>
<p>Now, we can tell <strong>git</strong> to specifically <strong>pull</strong> the <strong>upstream</strong> version of a particular branch:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git pull upstream &lt;branch&gt;
</pre></div>
</div>
<p>This will <strong>pull</strong> (<strong>fetch</strong> and <strong>merge</strong>) the <strong>upstream</strong> version of &lt;<strong>branch</strong>&gt; (if it exists) into the <strong>local</strong>
version of the current branch.</p>
<p>For example, <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span> <span class="pre">upstream</span> <span class="pre">week3</span></code> would merge the <strong>upstream</strong> <code class="docutils literal notranslate"><span class="pre">week3</span></code> branch into our current branch (<code class="docutils literal notranslate"><span class="pre">week3</span></code>).
Go ahead and enter this command now:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git pull upstream week3
</pre></div>
</div>
<p>You should see the following output:</p>
<a class="reference internal image-reference" href="../../../_images/pull_upstream.png"><img alt="pulling the upstream changes into the current branch" class="align-center" src="../../../_images/pull_upstream.png" style="width: 600px;" /></a>
<p><br /> This indicates that there’s been no change to the <strong>upstream</strong> branch that isn’t already in our <strong>origin</strong> branch,
so we can safely merge the <strong>local</strong> <code class="docutils literal notranslate"><span class="pre">main</span></code> and <code class="docutils literal notranslate"><span class="pre">week3</span></code> branches.</p>
<p>Now, switch back to the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git checkout main
</pre></div>
</div>
<p>And enter the following command:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git merge week3
</pre></div>
</div>
<p>You should now see the following output in the window:</p>
<a class="reference internal image-reference" href="../../../_images/updates.png"><img alt="the updates displayed after merging week3 into main" class="align-center" src="../../../_images/updates.png" style="width: 600px;" /></a>
<p><br /> This tells us what files have been changed (<code class="docutils literal notranslate"><span class="pre">18</span> <span class="pre">files</span></code>) and how (<code class="docutils literal notranslate"><span class="pre">854</span> <span class="pre">insertions(+)</span></code>). Because none the files
in the <strong>Week3</strong> folder were present in the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch, we’ll only see additions/insertions. As you work on your
project and commit changes to existing files, you’ll also see deletions (lines that are deleted or changed).</p>
<p>You should also see Weeks 1–3 in your repository folder:</p>
<a class="reference internal image-reference" href="../../../_images/merged_week3.png"><img alt="the repository folder after merging week3 into main" class="align-center" src="../../../_images/merged_week3.png" style="width: 600px;" /></a>
<p><br /> The last thing to do now is to <strong>push</strong> these changes to your GitHub repository:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git push
</pre></div>
</div>
<p>You can confirm that the changes are now on your remote repository by heading over to GitHub:</p>
<a class="reference internal image-reference" href="../../../_images/week3_remote.png"><img alt="the github repository, with the merged changes updated" class="align-center" src="../../../_images/week3_remote.png" style="width: 720px;" /></a>
<p><br /> At this point, you can launch Jupyter Notebooks as you have in the previous weeks, and begin to work through the
practical exercise.</p>
</div>
<div class="section" id="next-steps">
<h2>Next steps<a class="headerlink" href="#next-steps" title="Permalink to this headline">#</a></h2>
<p>Once you have finished the notebook and the exercise, make sure to send me an e-mail with some ideas for your coding
project. They do not have to be completely fleshed out, but you should try to have a general idea of what you would
like to work on for the final project – ideally, this will be something related to your work, or a potential MSc thesis
topic.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Below this point is the <strong>non-interactive</strong> text of the notebook. To actually run the notebook, you’ll need to
follow the instructions above to open the notebook and run it on your own computer!</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="rachel-mcadams">
<h2>Rachel McAdams<a class="headerlink" href="#rachel-mcadams" title="Permalink to this headline">#</a></h2>
<div class="section" id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">#</a></h3>
<p>Up to now, you have gained some experience working with basic features
of python, and used cartopy and matplotlib to create a map. In each of
these practicals, you have loaded different vector datasets using a
module called geopandas. In this week’s practical, we’ll be looking at
working vector data in a bit more depth, including the different
geometry types available using shapely, analyses like spatial joins and
summarizing based on attributes, and how to reproject vector data from
one coordinate reference system to another.</p>
</div>
<div class="section" id="objectives">
<h3>Objectives<a class="headerlink" href="#objectives" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Gain experience working with different vector data types using
shapely</p></li>
<li><p>Use geopandas to re-project vector datasets from one coordinate
reference system to another</p></li>
<li><p>Summarize features using the groupby method of a GeoDataFrame</p></li>
<li><p>Learn how to perform different vector data operations using geopandas
and shapely</p></li>
</ul>
</div>
<div class="section" id="data-provided">
<h3>Data provided<a class="headerlink" href="#data-provided" title="Permalink to this headline">#</a></h3>
<p>In the data_files folder, you should have the following:</p>
<ul class="simple">
<li><p>NI_roads.shp, a shapefile of roads in Northern Ireland</p></li>
<li><p>Counties.shp, a shapefile of county outlines for Northern Ireland</p></li>
<li><p>NI_Wards.shp, a shapefile of electoral wards for Northern Ireland</p></li>
</ul>
</div>
<div class="section" id="id1">
<h3>1. Getting started<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<p>In this practical, we’ll be working with vector data. As a quick
refresher, the three main types of vector data that we will work with
are:</p>
<ul class="simple">
<li><p><strong>Point</strong>: point data represent a single point in space. For our
purposes, points are either two-dimensional (x, y) or
three-dimensional (x, y, z). In shapely, the corresponding <strong>class</strong>
of data is a <strong>Point</strong>.</p></li>
<li><p><strong>Line</strong>: lines are a sequence of at least two points that are joined
together. In shapely, the corresponding <strong>class</strong> of data is known as
a <strong>LineString</strong>.</p></li>
<li><p><strong>Polygon</strong>: polygons are a sequence of at least three points that
are connected to form a ring, as well as any additional rings that
represent holes in the polygon. In shapely, the corresponding
<strong>class</strong> of data is a <strong>Polygon</strong>.</p></li>
</ul>
<p>We can also have <strong>Collections</strong> of vector data, where each feature
represents a collection of <strong>Point</strong>, <strong>Line</strong>, or <strong>Polygon</strong> objects.
In shapely, these are represented as <strong>MultiPoint</strong>,
<strong>MultiLineString</strong>, or <strong>MultiPolygon</strong> objects.</p>
<p>To get started, run the following cell to import geopandas and shapely.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this lets us use the figures interactively</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Point</span><span class="p">,</span> <span class="n">LineString</span><span class="p">,</span> <span class="n">Polygon</span>
</pre></div>
</div>
</div>
<div class="section" id="shapely-geometry-types">
<h3>2. Shapely geometry types<a class="headerlink" href="#shapely-geometry-types" title="Permalink to this headline">#</a></h3>
<div class="section" id="points">
<h4>2.1 Points<a class="headerlink" href="#points" title="Permalink to this headline">#</a></h4>
<p>As we saw in Week 1, to create a Point, we pass x, y (and optionally, z)
coordinates to the Point class constructor:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pt</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mf">6.677</span><span class="p">,</span> <span class="mf">55.150</span><span class="p">)</span> <span class="c1"># creates a 2d point with coordinates -6.677, 55.150</span>
<span class="n">pt2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mf">6.658</span><span class="p">,</span> <span class="mf">55.213</span><span class="p">)</span> <span class="c1"># creates a 2d point with coordinates -6.658, 55.213</span>

<span class="n">pt3d</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mf">86.925278</span><span class="p">,</span> <span class="mf">27.988056</span><span class="p">,</span> <span class="mf">8848.86</span><span class="p">)</span> <span class="c1"># creates a 3d point</span>

<span class="nb">print</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="c1"># print a well-known text (WKT) representation of the Point object</span>
</pre></div>
</div>
<p>The last line, <code class="docutils literal notranslate"><span class="pre">print(pt)</span></code>, prints a
<a class="reference external" href="https://en.wikipedia.org/wiki/Well-known_text_representation_of_geometry">well-known-text</a>
(WKT) representation of the <strong>Point</strong> object. WKT is a standard
representation of vector geometry objects - most <code class="docutils literal notranslate"><span class="pre">python</span></code> libraries
and GIS softwares are able to read and/or translate WKT into other
formats, such as ESRI Shapefiles, GeoJSON, etc.</p>
<p>Remember that in python, we can find the attributes and methods for an
object by looking up the documentation (for shapely, this can be found
<a class="reference external" href="https://shapely.readthedocs.io/en/stable/manual.html">here</a>), or
using the built-in function <code class="docutils literal notranslate"><span class="pre">dir()</span></code>. To find out more about a
particular function, we can use the built-in function <code class="docutils literal notranslate"><span class="pre">help()</span></code> (or, in
jupyter notebooks/ipython, the <code class="docutils literal notranslate"><span class="pre">?</span></code> operator).</p>
<p>As an example, let’s use the built-in function <code class="docutils literal notranslate"><span class="pre">dir()</span></code> to look at the
methods and attributes associated with the <strong>Point</strong> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="nb">print</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">pt</span><span class="p">))</span>
<span class="p">[</span><span class="s1">&#39;__and__&#39;</span><span class="p">,</span> <span class="s1">&#39;__array_interface__&#39;</span><span class="p">,</span> <span class="s1">&#39;__bool__&#39;</span><span class="p">,</span> <span class="s1">&#39;__class__&#39;</span><span class="p">,</span> <span class="s1">&#39;__del__&#39;</span><span class="p">,</span> <span class="s1">&#39;__delattr__&#39;</span><span class="p">,</span> <span class="s1">&#39;__dict__&#39;</span><span class="p">,</span> <span class="s1">&#39;__dir__&#39;</span><span class="p">,</span> <span class="s1">&#39;__doc__&#39;</span><span class="p">,</span> <span class="s1">&#39;__eq__&#39;</span><span class="p">,</span> <span class="s1">&#39;__format__&#39;</span><span class="p">,</span> <span class="s1">&#39;__ge__&#39;</span><span class="p">,</span> <span class="s1">&#39;__geo_interface__&#39;</span><span class="p">,</span> <span class="s1">&#39;__geom__&#39;</span><span class="p">,</span> <span class="s1">&#39;__getattribute__&#39;</span><span class="p">,</span> <span class="s1">&#39;__gt__&#39;</span><span class="p">,</span> <span class="s1">&#39;__hash__&#39;</span><span class="p">,</span> <span class="s1">&#39;__init__&#39;</span><span class="p">,</span> <span class="s1">&#39;__init_subclass__&#39;</span><span class="p">,</span> <span class="s1">&#39;__le__&#39;</span><span class="p">,</span> <span class="s1">&#39;__lt__&#39;</span><span class="p">,</span> <span class="s1">&#39;__module__&#39;</span><span class="p">,</span> <span class="s1">&#39;__ne__&#39;</span><span class="p">,</span> <span class="s1">&#39;__new__&#39;</span><span class="p">,</span> <span class="s1">&#39;__nonzero__&#39;</span><span class="p">,</span> <span class="s1">&#39;__or__&#39;</span><span class="p">,</span> <span class="s1">&#39;__p__&#39;</span><span class="p">,</span> <span class="s1">&#39;__reduce__&#39;</span><span class="p">,</span> <span class="s1">&#39;__reduce_ex__&#39;</span><span class="p">,</span> <span class="s1">&#39;__repr__&#39;</span><span class="p">,</span> <span class="s1">&#39;__setattr__&#39;</span><span class="p">,</span> <span class="s1">&#39;__setstate__&#39;</span><span class="p">,</span> <span class="s1">&#39;__sizeof__&#39;</span><span class="p">,</span> <span class="s1">&#39;__str__&#39;</span><span class="p">,</span> <span class="s1">&#39;__sub__&#39;</span><span class="p">,</span> <span class="s1">&#39;__subclasshook__&#39;</span><span class="p">,</span> <span class="s1">&#39;__weakref__&#39;</span><span class="p">,</span> <span class="s1">&#39;__xor__&#39;</span><span class="p">,</span> <span class="s1">&#39;_crs&#39;</span><span class="p">,</span> <span class="s1">&#39;_ctypes_data&#39;</span><span class="p">,</span> <span class="s1">&#39;_geom&#39;</span><span class="p">,</span> <span class="s1">&#39;_get_coords&#39;</span><span class="p">,</span> <span class="s1">&#39;_is_empty&#39;</span><span class="p">,</span> <span class="s1">&#39;_lgeos&#39;</span><span class="p">,</span> <span class="s1">&#39;_ndim&#39;</span><span class="p">,</span> <span class="s1">&#39;_other_owned&#39;</span><span class="p">,</span> <span class="s1">&#39;_repr_svg_&#39;</span><span class="p">,</span> <span class="s1">&#39;_set_coords&#39;</span><span class="p">,</span> <span class="s1">&#39;almost_equals&#39;</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">,</span> <span class="s1">&#39;array_interface&#39;</span><span class="p">,</span> <span class="s1">&#39;array_interface_base&#39;</span><span class="p">,</span> <span class="s1">&#39;boundary&#39;</span><span class="p">,</span> <span class="s1">&#39;bounds&#39;</span><span class="p">,</span> <span class="s1">&#39;buffer&#39;</span><span class="p">,</span> <span class="s1">&#39;centroid&#39;</span><span class="p">,</span> <span class="s1">&#39;contains&#39;</span><span class="p">,</span> <span class="s1">&#39;convex_hull&#39;</span><span class="p">,</span> <span class="s1">&#39;coords&#39;</span><span class="p">,</span> <span class="s1">&#39;covers&#39;</span><span class="p">,</span> <span class="s1">&#39;crosses&#39;</span><span class="p">,</span> <span class="s1">&#39;ctypes&#39;</span><span class="p">,</span> <span class="s1">&#39;difference&#39;</span><span class="p">,</span> <span class="s1">&#39;disjoint&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="s1">&#39;empty&#39;</span><span class="p">,</span> <span class="s1">&#39;envelope&#39;</span><span class="p">,</span> <span class="s1">&#39;equals&#39;</span><span class="p">,</span> <span class="s1">&#39;equals_exact&#39;</span><span class="p">,</span> <span class="s1">&#39;geom_type&#39;</span><span class="p">,</span> <span class="s1">&#39;geometryType&#39;</span><span class="p">,</span> <span class="s1">&#39;has_z&#39;</span><span class="p">,</span> <span class="s1">&#39;hausdorff_distance&#39;</span><span class="p">,</span> <span class="s1">&#39;impl&#39;</span><span class="p">,</span> <span class="s1">&#39;interpolate&#39;</span><span class="p">,</span> <span class="s1">&#39;intersection&#39;</span><span class="p">,</span> <span class="s1">&#39;intersects&#39;</span><span class="p">,</span> <span class="s1">&#39;is_closed&#39;</span><span class="p">,</span> <span class="s1">&#39;is_empty&#39;</span><span class="p">,</span> <span class="s1">&#39;is_ring&#39;</span><span class="p">,</span> <span class="s1">&#39;is_simple&#39;</span><span class="p">,</span> <span class="s1">&#39;is_valid&#39;</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="s1">&#39;minimum_clearance&#39;</span><span class="p">,</span> <span class="s1">&#39;minimum_rotated_rectangle&#39;</span><span class="p">,</span> <span class="s1">&#39;overlaps&#39;</span><span class="p">,</span> <span class="s1">&#39;project&#39;</span><span class="p">,</span> <span class="s1">&#39;relate&#39;</span><span class="p">,</span> <span class="s1">&#39;relate_pattern&#39;</span><span class="p">,</span> <span class="s1">&#39;representative_point&#39;</span><span class="p">,</span> <span class="s1">&#39;simplify&#39;</span><span class="p">,</span> <span class="s1">&#39;svg&#39;</span><span class="p">,</span> <span class="s1">&#39;symmetric_difference&#39;</span><span class="p">,</span> <span class="s1">&#39;to_wkb&#39;</span><span class="p">,</span> <span class="s1">&#39;to_wkt&#39;</span><span class="p">,</span> <span class="s1">&#39;touches&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;union&#39;</span><span class="p">,</span> <span class="s1">&#39;within&#39;</span><span class="p">,</span> <span class="s1">&#39;wkb&#39;</span><span class="p">,</span> <span class="s1">&#39;wkb_hex&#39;</span><span class="p">,</span> <span class="s1">&#39;wkt&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Here, in addition to the <strong>special</strong> or <strong>magic</strong> methods (denoted with
__ at the beginning and end of the method name), there are a number of
methods that we might find useful, including <code class="docutils literal notranslate"><span class="pre">Point.distance()</span></code>. To
see what this method does, we can use <code class="docutils literal notranslate"><span class="pre">help(Point.distance)</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">help</span><span class="p">(</span><span class="n">Point</span><span class="o">.</span><span class="n">distance</span><span class="p">)</span>
<span class="n">Help</span> <span class="n">on</span> <span class="n">method</span> <span class="n">distance</span> <span class="ow">in</span> <span class="n">module</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">base</span><span class="p">:</span>

<span class="n">distance</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="n">method</span> <span class="n">of</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">Point</span> <span class="n">instance</span>
    <span class="n">Unitless</span> <span class="n">distance</span> <span class="n">to</span> <span class="n">other</span> <span class="n">geometry</span> <span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
<p>So, <code class="docutils literal notranslate"><span class="pre">Point.distance()</span></code> provides the distance from the point object to
some other geometry. Because shapely does not directly deal with
coordinate systems, this distance is <strong>unitless</strong>. This means that <strong>we
have to make sure that the two objects have the same reference system -
if we do not, the distance returned will not make sense.</strong> We will cover
working with coordinate reference systems later on in the practical.</p>
<p>Use the cell below to work out how we can access the x, y coordinates of
a Point object. Can you see more than one way to do this? If so, are
there differences between them?</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># write your method to access the x,y coordinates of pt here</span>
</pre></div>
</div>
<p>One of the common operations we might want to do with a Point object is
to create a <strong>buffer</strong> around the point. In the list of associated
methods and attributes of Point objects above, you should see there is a
method called <code class="docutils literal notranslate"><span class="pre">buffer</span></code>. A look at the help for this method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">help</span><span class="p">(</span><span class="n">Point</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span>
<span class="n">Help</span> <span class="n">on</span> <span class="n">method</span> <span class="n">buffer</span> <span class="ow">in</span> <span class="n">module</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">base</span><span class="p">:</span>

<span class="n">buffer</span><span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">quadsegs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cap_style</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">join_style</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mitre_limit</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">single_sided</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="n">method</span> <span class="n">of</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">Point</span> <span class="n">instance</span>
    <span class="n">Get</span> <span class="n">a</span> <span class="n">geometry</span> <span class="n">that</span> <span class="n">represents</span> <span class="nb">all</span> <span class="n">points</span> <span class="n">within</span> <span class="n">a</span> <span class="n">distance</span>
    <span class="n">of</span> <span class="n">this</span> <span class="n">geometry</span><span class="o">.</span>

    <span class="n">A</span> <span class="n">positive</span> <span class="n">distance</span> <span class="n">produces</span> <span class="n">a</span> <span class="n">dilation</span><span class="p">,</span> <span class="n">a</span> <span class="n">negative</span> <span class="n">distance</span> <span class="n">an</span>
    <span class="n">erosion</span><span class="o">.</span> <span class="n">A</span> <span class="n">very</span> <span class="n">small</span> <span class="ow">or</span> <span class="n">zero</span> <span class="n">distance</span> <span class="n">may</span> <span class="n">sometimes</span> <span class="n">be</span> <span class="n">used</span> <span class="n">to</span>
    <span class="s2">&quot;tidy&quot;</span> <span class="n">a</span> <span class="n">polygon</span><span class="o">.</span>

    <span class="n">Parameters</span>
    <span class="o">----------</span>
    <span class="n">distance</span> <span class="p">:</span> <span class="nb">float</span>
        <span class="n">The</span> <span class="n">distance</span> <span class="n">to</span> <span class="n">buffer</span> <span class="n">around</span> <span class="n">the</span> <span class="nb">object</span><span class="o">.</span>
    <span class="n">resolution</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">optional</span>
        <span class="n">The</span> <span class="n">resolution</span> <span class="n">of</span> <span class="n">the</span> <span class="n">buffer</span> <span class="n">around</span> <span class="n">each</span> <span class="n">vertex</span> <span class="n">of</span> <span class="n">the</span>
        <span class="nb">object</span><span class="o">.</span>
<span class="o">...</span>
</pre></div>
</div>
<p>shows that <code class="docutils literal notranslate"><span class="pre">buffer</span></code> takes a <strong>positional parameter</strong> of <em>distance</em>, as
well as a number of <strong>keyword parameters</strong> that determine how the buffer
operation is done. Remember that the buffer distance will be in the same
coordinate system as our point - shapely does not, by itself, do any
conversion between coordinate systems or units.</p>
<p>Note that the object returned by buffer is a Polygon, rather than a
point - this makes sense, as the buffer is a two-dimensional surface
around the point location.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pt_buffer</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span> <span class="c1"># buffer the point by 0.001 in the same coordinates</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">pt_buffer</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="linestrings">
<h4>2.2. LineStrings<a class="headerlink" href="#linestrings" title="Permalink to this headline">#</a></h4>
<p>Instead of using a single x, y coordinate pair, a <strong>LineString</strong> object
takes either a list of <strong>Point</strong> objects, or a list of coordinate
<strong>tuples</strong>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">line1</span> <span class="o">=</span> <span class="n">LineString</span><span class="p">([</span><span class="n">pt</span><span class="p">,</span> <span class="n">pt2</span><span class="p">])</span> <span class="c1"># method one of creating a LineString, using a list of Point objects</span>
<span class="n">line2</span> <span class="o">=</span> <span class="n">LineString</span><span class="p">([(</span><span class="o">-</span><span class="mf">6.677</span><span class="p">,</span> <span class="mf">55.150</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">6.658</span><span class="p">,</span> <span class="mf">55.213</span><span class="p">)])</span> <span class="c1"># method two, using a list of coordinate tuples</span>

<span class="nb">print</span><span class="p">(</span><span class="n">line1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">line2</span><span class="p">)</span>

<span class="n">line1</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">line2</span><span class="p">)</span> <span class="c1"># check to see if these are the same geometry</span>
</pre></div>
</div>
<p>The coordinates of a <strong>LineString</strong> are stored as a <strong>tuple</strong> in an
attribute called <strong>xy</strong>. The <strong>tuple</strong> has two items representing the X
and Y coordinate values. If we want the x and y coordinates as separate
variables, we can access them using their respective indices:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">x</span> <span class="o">=</span> <span class="n">line1</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">y</span> <span class="o">=</span> <span class="n">line1</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>We can also combine this using <strong>tuple assignment</strong>, or <strong>unpacking</strong>,
which assigns values from a <strong>tuple</strong> on the right-hand side of the
assignment to a comma-separated grouping of variables on the left-hand
side:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">line1</span><span class="o">.</span><span class="n">xy</span>

<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>LineString</strong> objects have a number of the same methods that <strong>Point</strong>
objects do, including <code class="docutils literal notranslate"><span class="pre">buffer</span></code> and <code class="docutils literal notranslate"><span class="pre">distance</span></code>. <strong>LineString</strong>
objects also have a <code class="docutils literal notranslate"><span class="pre">length</span></code> (just like with distance, it is
<strong>unitless</strong>):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">line1</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
</pre></div>
</div>
<p>We can also find the <code class="docutils literal notranslate"><span class="pre">centroid</span></code> (center) of the <strong>LineString</strong>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">center</span> <span class="o">=</span> <span class="n">line1</span><span class="o">.</span><span class="n">centroid</span> <span class="c1"># get the centerpoint of the line</span>
<span class="nb">print</span><span class="p">(</span><span class="n">center</span><span class="p">)</span>
</pre></div>
</div>
<p>The last two methods of <strong>LineString</strong> objects that we will explore for
now are <code class="docutils literal notranslate"><span class="pre">project</span></code> and <code class="docutils literal notranslate"><span class="pre">interpolate</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">help</span><span class="p">(</span><span class="n">LineString</span><span class="o">.</span><span class="n">project</span><span class="p">)</span>
<span class="n">Help</span> <span class="n">on</span> <span class="n">function</span> <span class="n">project</span> <span class="ow">in</span> <span class="n">module</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">base</span><span class="p">:</span>

<span class="n">project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">Returns</span> <span class="n">the</span> <span class="n">distance</span> <span class="n">along</span> <span class="n">this</span> <span class="n">geometry</span> <span class="n">to</span> <span class="n">a</span> <span class="n">point</span> <span class="n">nearest</span> <span class="n">the</span>
    <span class="n">specified</span> <span class="n">point</span>

    <span class="n">If</span> <span class="n">the</span> <span class="n">normalized</span> <span class="n">arg</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">,</span> <span class="k">return</span> <span class="n">the</span> <span class="n">distance</span> <span class="n">normalized</span> <span class="n">to</span> <span class="n">the</span>
    <span class="n">length</span> <span class="n">of</span> <span class="n">the</span> <span class="n">linear</span> <span class="n">geometry</span><span class="o">.</span>
</pre></div>
</div>
<p>So <code class="docutils literal notranslate"><span class="pre">project</span></code> returns the distance along the <strong>LineString</strong> that comes
closest to the <strong>Point</strong> (or other object). <code class="docutils literal notranslate"><span class="pre">interpolate</span></code>, on the
other hand, does something a bit different:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">help</span><span class="p">(</span><span class="n">LineString</span><span class="o">.</span><span class="n">interpolate</span><span class="p">)</span>
<span class="n">Help</span> <span class="n">on</span> <span class="n">function</span> <span class="n">interpolate</span> <span class="ow">in</span> <span class="n">module</span> <span class="n">shapely</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">base</span><span class="p">:</span>

<span class="n">interpolate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">Return</span> <span class="n">a</span> <span class="n">point</span> <span class="n">at</span> <span class="n">the</span> <span class="n">specified</span> <span class="n">distance</span> <span class="n">along</span> <span class="n">a</span> <span class="n">linear</span> <span class="n">geometry</span>

    <span class="n">Negative</span> <span class="n">length</span> <span class="n">values</span> <span class="n">are</span> <span class="n">taken</span> <span class="k">as</span> <span class="n">measured</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">reverse</span>
    <span class="n">direction</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">end</span> <span class="n">of</span> <span class="n">the</span> <span class="n">geometry</span><span class="o">.</span> <span class="n">Out</span><span class="o">-</span><span class="n">of</span><span class="o">-</span><span class="nb">range</span> <span class="n">index</span>
    <span class="n">values</span> <span class="n">are</span> <span class="n">handled</span> <span class="n">by</span> <span class="n">clamping</span> <span class="n">them</span> <span class="n">to</span> <span class="n">the</span> <span class="n">valid</span> <span class="nb">range</span> <span class="n">of</span> <span class="n">values</span><span class="o">.</span>
    <span class="n">If</span> <span class="n">the</span> <span class="n">normalized</span> <span class="n">arg</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">,</span> <span class="n">the</span> <span class="n">distance</span> <span class="n">will</span> <span class="n">be</span> <span class="n">interpreted</span> <span class="k">as</span> <span class="n">a</span>
    <span class="n">fraction</span> <span class="n">of</span> <span class="n">the</span> <span class="n">geometry</span><span class="s1">&#39;s length.</span>
</pre></div>
</div>
<p>it returns the point along the line at a specified distance; the
distance can be in the units of the <strong>LineString</strong>’s coordinates
(<code class="docutils literal notranslate"><span class="pre">normalized=False</span></code>), or it can be as a fraction of the total length
of the <strong>LineString</strong> (<code class="docutils literal notranslate"><span class="pre">normalized=True</span></code>).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">line1</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">center</span><span class="p">)</span> <span class="o">/</span> <span class="n">line1</span><span class="o">.</span><span class="n">length</span> <span class="c1"># check to see how far along the line our centerpoint is</span>

<span class="nb">print</span><span class="p">(</span><span class="n">center</span><span class="p">)</span> <span class="c1"># print the WKT representation of the center point</span>
<span class="nb">print</span><span class="p">(</span><span class="n">line1</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="c1"># print the WKT representation of the point 50% along the line</span>
</pre></div>
</div>
</div>
<div class="section" id="polygons">
<h4>2.3. Polygons<a class="headerlink" href="#polygons" title="Permalink to this headline">#</a></h4>
<p>The last basic geometry type we will look at in this practical are
<strong>Polygon</strong> objects. Similar to <strong>LineString</strong> objects, we can create a
<strong>Polygon</strong> object using a list of coordinate pairs, or a list of
<strong>Point</strong> objects:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poly1</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">([(</span><span class="o">-</span><span class="mf">6.677</span><span class="p">,</span> <span class="mf">55.150</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">6.658</span><span class="p">,</span> <span class="mf">55.213</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">6.722</span><span class="p">,</span> <span class="mf">55.189</span><span class="p">)])</span>
<span class="n">poly2</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">([</span><span class="n">pt</span><span class="p">,</span> <span class="n">pt2</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mf">6.722</span><span class="p">,</span> <span class="mf">55.189</span><span class="p">)])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">poly1</span><span class="p">)</span> <span class="c1"># print a wkt representation of the polygon</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly1</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">poly2</span><span class="p">))</span>
</pre></div>
</div>
<p>Note that even though we only passed three <strong>Point</strong> objects (or
coordinate pairs) to the <strong>Polygon</strong> constructor, the <strong>Polygon</strong> has
four vertices, with the first and last vertex being the same - this is
because the <strong>Polygon</strong> exterior is <em>closed</em>. Note also the double
parentheses - this is because a <strong>Polygon</strong> potentially has two sets of
coordinates - the <em>Shell</em>, or <em>exterior</em>, and <em>holes</em>, or <em>interiors</em>.
To create a <strong>Polygon</strong> with a hole in it, we would need to pass a list
of coordinates that describe the <em>holes</em>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">polygon_with_hole</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">shell</span><span class="o">=</span><span class="p">[(</span><span class="o">-</span><span class="mf">6.677</span><span class="p">,</span> <span class="mf">55.150</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">6.658</span><span class="p">,</span> <span class="mf">55.213</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">6.722</span><span class="p">,</span> <span class="mf">55.189</span><span class="p">)],</span>
                            <span class="n">holes</span><span class="o">=</span><span class="p">[[(</span><span class="o">-</span><span class="mf">6.684</span><span class="p">,</span> <span class="mf">55.168</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">6.704</span><span class="p">,</span> <span class="mf">55.187</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">6.672</span><span class="p">,</span> <span class="mf">55.196</span><span class="p">)]])</span> <span class="c1"># note the double brackets</span>

<span class="nb">print</span><span class="p">(</span><span class="n">polygon_with_hole</span><span class="p">)</span>
</pre></div>
</div>
<p>Note the double brackets in the <code class="docutils literal notranslate"><span class="pre">holes</span></code> keyword argument:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">holes</span><span class="o">=</span><span class="p">[[(</span><span class="o">-</span><span class="mf">6.684</span><span class="p">,</span> <span class="mf">55.168</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">6.704</span><span class="p">,</span> <span class="mf">55.187</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">6.672</span><span class="p">,</span> <span class="mf">55.196</span><span class="p">)]]</span>
</pre></div>
</div>
<p>This is necessary, because <code class="docutils literal notranslate"><span class="pre">holes</span></code> is expecting a sequence of
coordinate sequences that describe the <em>holes</em> - effectively, a list of
<strong>Polygon</strong> shells.</p>
<p>Accessing the coordinates of a <strong>Polygon</strong> object is a little more
complicated than it is for <strong>Point</strong> and <strong>LineString</strong> objects - this
is because <strong>Polygon</strong> objects have two sets of coordinates, the
exterior (<em>shell</em>) and interior (<em>holes</em>).</p>
<p>But, the <code class="docutils literal notranslate"><span class="pre">exterior</span></code> attribute of the <strong>Polygon</strong> is just a
<strong>LinearRing</strong> (a special case of <strong>LineString</strong> where the first and
last coordinates are the same), and the <code class="docutils literal notranslate"><span class="pre">interiors</span></code> attribute is an
<strong>InteriorRingSequence</strong> (basically, a collection of <strong>LinearRings</strong>
that have to obey <a class="reference external" href="https://shapely.readthedocs.io/en/stable/manual.html#polygons">additional
rules</a>):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">polygon_with_hole</span><span class="o">.</span><span class="n">exterior</span><span class="p">)</span> <span class="c1"># this is a single LinearRing</span>
<span class="k">for</span> <span class="n">lr</span> <span class="ow">in</span> <span class="n">polygon_with_hole</span><span class="o">.</span><span class="n">interiors</span><span class="p">:</span> <span class="c1"># this is potentially multiple LinearRing objects</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">lr</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Polygon</strong> objects have nonzero <code class="docutils literal notranslate"><span class="pre">area</span></code> and non-zero <code class="docutils literal notranslate"><span class="pre">length</span></code>
(perimeter) - as with the equivalent attributes for <strong>Point</strong> and
<strong>LineString</strong> objects, these are <strong>unitless</strong>. <strong>Polygon</strong> objects also
have a <code class="docutils literal notranslate"><span class="pre">centroid</span></code>, and we can bound the geometry using <em>either</em> the
minimum bounding box parallel to the coordinate axes (<code class="docutils literal notranslate"><span class="pre">envelope</span></code>), or
a rotated minimum bounding box (<code class="docutils literal notranslate"><span class="pre">minimum_rotated_rectangle</span></code>):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;perimeter: &#39;</span><span class="p">,</span> <span class="n">poly1</span><span class="o">.</span><span class="n">length</span><span class="p">)</span> <span class="c1"># print the perimeter</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;area: &#39;</span><span class="p">,</span> <span class="n">poly1</span><span class="o">.</span><span class="n">area</span><span class="p">)</span> <span class="c1"># print the area</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;centroid: &#39;</span><span class="p">,</span> <span class="n">poly1</span><span class="o">.</span><span class="n">centroid</span><span class="p">)</span> <span class="c1"># get the centerpoint of the rectangle</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;bounding coordinates: &#39;</span><span class="p">,</span> <span class="n">poly1</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span> <span class="c1"># get the minimum x, minimum y, maximum x, maximum y coordinates</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;bounding box: &#39;</span><span class="p">,</span> <span class="n">poly1</span><span class="o">.</span><span class="n">envelope</span><span class="p">)</span> <span class="c1"># get the minimum bounding rectangle of the polygon, parallel to the coordinate axes</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rotated bounding box: &#39;</span><span class="p">,</span> <span class="n">poly1</span><span class="o">.</span><span class="n">minimum_rotated_rectangle</span><span class="p">)</span> <span class="c1"># get the smallest possible rectangle that covers the polygon</span>
</pre></div>
</div>
<p>There are a number of additional methods that we will cover more as we
continue through the practicals - for now, this should be enough to give
an idea for how these geometry objects work.</p>
</div>
<div class="section" id="interactions-between-geometry-objects">
<h4>2.4 Interactions between geometry objects<a class="headerlink" href="#interactions-between-geometry-objects" title="Permalink to this headline">#</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">shapely</span></code> also provides a number of methods that we can use to check
the spatial relationship between different objects. For example, the
following code shows how we can use the <code class="docutils literal notranslate"><span class="pre">contains</span></code>
<a class="reference external" href="https://shapely.readthedocs.io/en/stable/manual.html#object.contains">method</a>
of a shapely geometry object to see whether a <strong>Point</strong> (or other
geometry) is located fully within the object:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poly</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="n">pt1</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">pt2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pt1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pt2</span><span class="p">))</span>
</pre></div>
</div>
<p>We can also check to see whether two geometry objects
<a class="reference external" href="https://shapely.readthedocs.io/en/stable/manual.html#object.intersects">intersect</a>
using the <code class="docutils literal notranslate"><span class="pre">intersects</span></code> method. To actually get the intersection of the
two geometries, we use the <code class="docutils literal notranslate"><span class="pre">intersection</span></code> method, which returns the
geometry of the intersection (whether this is a <strong>Point</strong>, a
<strong>LineString</strong>, a <strong>Polygon</strong>, or a mixed collection of geometries
depends on the geometries and how they intersect):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">line1</span> <span class="o">=</span> <span class="n">LineString</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="n">line2</span> <span class="o">=</span> <span class="n">LineString</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">line1</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">line2</span><span class="p">))</span> <span class="c1"># intersects() returns True if the geometries touch/intersect/overlap, False otherwise</span>
<span class="nb">print</span><span class="p">(</span><span class="n">line1</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">poly</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">line1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">line2</span><span class="p">))</span> <span class="c1"># if the geometries intersect, this will be the Point(s) of intersection</span>
</pre></div>
</div>
<p>There are a number of other methods provided by <code class="docutils literal notranslate"><span class="pre">shapely</span></code> that we can
use to determine the relationship between geometry objects, including
<code class="docutils literal notranslate"><span class="pre">touches</span></code>, <code class="docutils literal notranslate"><span class="pre">within</span></code>, and <code class="docutils literal notranslate"><span class="pre">overlaps</span></code>. Have a look at the full list
from the <a class="reference external" href="https://shapely.readthedocs.io/en/stable/manual.html">shapely user
manual</a> to see
the rest.</p>
</div>
</div>
<div class="section" id="geopandas-geodataframes">
<h3>3. geopandas GeoDataFrames<a class="headerlink" href="#geopandas-geodataframes" title="Permalink to this headline">#</a></h3>
<p>We have used geopandas in the past two practicals to read provided
shapefiles and work with the data they contain - in Practical 1, we
translated a comma-separated variable (CSV) file into a shapefile, and
in Practical 2, we read shapefile data and plotted it on a map using
<code class="docutils literal notranslate"><span class="pre">cartopy</span></code>.</p>
<p>This week, we will extend this introduction to look at how we can use
geopandas to do various GIS analyses, such as spatial joins and clipping
operations, as well as projecting from one coordinate reference system
to another.</p>
<p>To begin, load the <strong>NI_roads</strong> dataset from the <strong>data_files</strong> folder
and print the <strong>header</strong> (first 5 lines of the <strong>GeoDataFrame</strong>):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roads</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;data_files/NI_roads.shp&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">roads</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
<p>So this dataset has three columns: <strong>SURVEY</strong>, <strong>Road_class</strong>, and
<strong>geometry</strong>. Note that each of the geometries is a <strong>LineString</strong>
object, which means that we are working with <strong>Line</strong> objects.
Hopefully, given that the data are supposed to represent roads, this
makes sense.</p>
<div class="section" id="coordinate-reference-systems-using-proj">
<h4>3.1 Coordinate reference systems using PROJ<a class="headerlink" href="#coordinate-reference-systems-using-proj" title="Permalink to this headline">#</a></h4>
<p>To start with, let’s see if we can figure out how many kilometers of
motorway are represented in the dataset - i.e., the sum of the length of
all of the <strong>LineString</strong> objects that have the attribute <em>MOTORWAY</em>.
First, Let’s check what the coordinate reference system (CRS) of our
<strong>GeoDataFrame</strong> is, using the <code class="docutils literal notranslate"><span class="pre">crs</span></code> attribute:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roads</span><span class="o">.</span><span class="n">crs</span>
</pre></div>
</div>
<p>So this dataset has a <em>Geographic</em> coordinate reference system,
<strong>EPSG:4326</strong>. EPSG codes (originally organized by the European
Petroleum Survey Group) are a common way of working with coordinate
reference systems. Each CRS in the <a class="reference external" href="https://epsg.org/home.html">EPSG
registry</a> has a unique code and standard
well-known text representation.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">crs</span></code> attribute of the <strong>GeoDataFrame</strong> is actually a
<strong>pyproj.CRS</strong> object.
<a class="reference external" href="https://pyproj4.github.io/pyproj/stable/">pyproj</a> is a python
interface to the <a class="reference external" href="https://proj.org/">PROJ</a> library, which is a
software for transforming geospatial coordinates from one CRS to
another.</p>
<p>Each <strong>pyproj.CRS</strong> object provides a number of methods for converting
to different formats, including well-known text, EPSG codes, JavaScript
Object Notation (JSON), and PROJ string (i.e.,
<code class="docutils literal notranslate"><span class="pre">'+proj=longlat</span> <span class="pre">+datum=WGS84</span> <span class="pre">+no_defs</span> <span class="pre">+type=crs'</span></code>).</p>
<p>For example, to see the JSON representation of the CRS, we would use the
<code class="docutils literal notranslate"><span class="pre">pyproj.CRS.to_json()</span></code> method:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roads</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span> <span class="c1"># show the representation of the CRS in JSON format</span>
</pre></div>
</div>
<p>Because this is a <em>Geographic</em> CRS, the length information provided by
<code class="docutils literal notranslate"><span class="pre">LineString.length</span></code> will also be in geographic units, which doesn’t
really make sense for us - we first have to convert the <strong>GeoDataFrame</strong>
to a different CRS. To do this, we can use the method <code class="docutils literal notranslate"><span class="pre">to_crs</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="n">help</span><span class="p">(</span><span class="n">roads</span><span class="o">.</span><span class="n">to_crs</span><span class="p">)</span>
<span class="n">Help</span> <span class="n">on</span> <span class="n">method</span> <span class="n">to_crs</span> <span class="ow">in</span> <span class="n">module</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">geodataframe</span><span class="p">:</span>

<span class="n">to_crs</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">epsg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="n">method</span> <span class="n">of</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">geodataframe</span><span class="o">.</span><span class="n">GeoDataFrame</span> <span class="n">instance</span>
    <span class="n">Transform</span> <span class="n">geometries</span> <span class="n">to</span> <span class="n">a</span> <span class="n">new</span> <span class="n">coordinate</span> <span class="n">reference</span> <span class="n">system</span><span class="o">.</span>

    <span class="n">Transform</span> <span class="nb">all</span> <span class="n">geometries</span> <span class="ow">in</span> <span class="n">an</span> <span class="n">active</span> <span class="n">geometry</span> <span class="n">column</span> <span class="n">to</span> <span class="n">a</span> <span class="n">different</span> <span class="n">coordinate</span>
    <span class="n">reference</span> <span class="n">system</span><span class="o">.</span>  <span class="n">The</span> <span class="n">crs</span> <span class="n">attribute</span> <span class="n">on</span> <span class="n">the</span> <span class="n">current</span> <span class="n">GeoSeries</span> <span class="n">must</span>
    <span class="n">be</span> <span class="nb">set</span><span class="o">.</span>  <span class="n">Either</span> <span class="n">crs</span> <span class="ow">or</span> <span class="n">epsg</span> <span class="n">may</span> <span class="n">be</span> <span class="n">specified</span> <span class="k">for</span> <span class="n">output</span><span class="o">.</span>

    <span class="n">This</span> <span class="n">method</span> <span class="n">will</span> <span class="n">transform</span> <span class="nb">all</span> <span class="n">points</span> <span class="ow">in</span> <span class="nb">all</span> <span class="n">objects</span><span class="o">.</span> <span class="n">It</span> <span class="n">has</span> <span class="n">no</span> <span class="n">notion</span>
    <span class="ow">or</span> <span class="n">projecting</span> <span class="n">entire</span> <span class="n">geometries</span><span class="o">.</span>  <span class="n">All</span> <span class="n">segments</span> <span class="n">joining</span> <span class="n">points</span> <span class="n">are</span>
    <span class="n">assumed</span> <span class="n">to</span> <span class="n">be</span> <span class="n">lines</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">current</span> <span class="n">projection</span><span class="p">,</span> <span class="ow">not</span> <span class="n">geodesics</span><span class="o">.</span> <span class="n">Objects</span>
    <span class="n">crossing</span> <span class="n">the</span> <span class="n">dateline</span> <span class="p">(</span><span class="ow">or</span> <span class="n">other</span> <span class="n">projection</span> <span class="n">boundary</span><span class="p">)</span> <span class="n">will</span> <span class="n">have</span>
    <span class="n">undesirable</span> <span class="n">behavior</span><span class="o">.</span>
<span class="o">...</span>
</pre></div>
</div>
<p>So, to transform the <strong>GeoDataFrame</strong> to a different CRS, we have to
provide either a CRS or an EPSG code. We can also choose to do this in
place (<code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>), or assign the output to a new <strong>GeoDataFrame</strong>
object (<code class="docutils literal notranslate"><span class="pre">inplace=False</span></code>). Let’s transform the <strong>GeoDataFrame</strong> to
Irish Transverse Mercator, and assign the output to a new variable,
<strong>roads_itm</strong>.</p>
<p>Rather than trying to find the correct JSON or PROJ representation of
this CRS, we can instead use the EPSG code, which can be easier to work
with.</p>
<p>Using the search function on the <a class="reference external" href="https://epsg.org/search/by-name">EPSG
registry</a>, or using an internet
search, look up the EPSG code for the Irish Transverse Mercator CRS and
enter it in the method call below:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roads_itm</span> <span class="o">=</span> <span class="n">roads</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="n">XX</span><span class="p">)</span> <span class="c1"># replace XX with the correct EPSG code for Irish Transverse Mercator</span>

<span class="nb">print</span><span class="p">(</span><span class="n">roads_itm</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
<p>Note that only the <strong>geometry</strong> column has changed - instead of
geographic coordinates (e.g., (-6.21243, 54.48706)), the points in each
<strong>LineString</strong> should be in a projected CRS (e.g., (715821.764,
861315.722)). Now, when we access the <code class="docutils literal notranslate"><span class="pre">length</span></code> attributes of our
<strong>LineString</strong> objects, the units will be in the same units as our CRS,
which is meters.</p>
</div>
<div class="section" id="summarizing-data-using-geopandas">
<h4>3.2 Summarizing data using geopandas<a class="headerlink" href="#summarizing-data-using-geopandas" title="Permalink to this headline">#</a></h4>
<p>So that’s the first part of our problem solved - our coordinates are in
meters, and the lengths will be as well. The next step is to select all
of the features that correspond to Motorways and sum the lengths. We saw
an example of this in Practical 1 - we can slice the <strong>GeoDataFrame</strong> by
returning all of the rows where <code class="docutils literal notranslate"><span class="pre">'Road_class'</span> <span class="pre">==</span> <span class="pre">'MOTORWAY'</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roads_itm</span><span class="p">[</span><span class="n">roads_itm</span><span class="p">[</span><span class="s1">&#39;Road_class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MOTORWAY&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>But first, we might want to add a column to our <strong>GeoDataFrame</strong> that
contains the <code class="docutils literal notranslate"><span class="pre">length</span></code> of each of the features. To do this, we can
<em>iterate</em> over the rows of the <strong>GeoDataFrame</strong> using the <code class="docutils literal notranslate"><span class="pre">iterrows</span></code>
method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="n">help</span><span class="p">(</span><span class="n">roads_itm</span><span class="o">.</span><span class="n">iterrows</span><span class="p">)</span>
<span class="n">Iterate</span> <span class="n">over</span> <span class="n">DataFrame</span> <span class="n">rows</span> <span class="k">as</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">Series</span><span class="p">)</span> <span class="n">pairs</span><span class="o">.</span>

<span class="n">Yields</span>
<span class="o">------</span>
<span class="n">index</span> <span class="p">:</span> <span class="n">label</span> <span class="ow">or</span> <span class="nb">tuple</span> <span class="n">of</span> <span class="n">label</span>
    <span class="n">The</span> <span class="n">index</span> <span class="n">of</span> <span class="n">the</span> <span class="n">row</span><span class="o">.</span> <span class="n">A</span> <span class="nb">tuple</span> <span class="k">for</span> <span class="n">a</span> <span class="n">MultiIndex</span><span class="o">.</span>
<span class="n">data</span> <span class="p">:</span> <span class="n">Series</span>
    <span class="n">The</span> <span class="n">data</span> <span class="n">of</span> <span class="n">the</span> <span class="n">row</span> <span class="k">as</span> <span class="n">a</span> <span class="n">Series</span><span class="o">.</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Because <code class="docutils literal notranslate"><span class="pre">iterrows</span></code> returns an (index, Series) pair at each step, we
use <strong>tuple assignment</strong> in our <code class="docutils literal notranslate"><span class="pre">for</span></code> loop. This gives us two
variables, <code class="docutils literal notranslate"><span class="pre">ind</span></code> and <code class="docutils literal notranslate"><span class="pre">row</span></code>, which we can use in the <code class="docutils literal notranslate"><span class="pre">for</span></code> loop.
<code class="docutils literal notranslate"><span class="pre">ind</span></code> corresponds to the <code class="docutils literal notranslate"><span class="pre">index</span></code> of the <code class="docutils literal notranslate"><span class="pre">row</span></code>, while <code class="docutils literal notranslate"><span class="pre">row</span></code>
corresponds to the actual data of the <code class="docutils literal notranslate"><span class="pre">row</span></code>, with each of the columns
that the full <strong>GeoDataFrame</strong> has.</p>
<p>We can access each column in the same way that we do for the full
<strong>GeoDataFrame</strong> - either <code class="docutils literal notranslate"><span class="pre">row[column]</span></code> or <code class="docutils literal notranslate"><span class="pre">row.column</span></code>. We can
assign a new column in the original <strong>GeoDataFrame</strong> using the <code class="docutils literal notranslate"><span class="pre">.loc</span></code>
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.loc.html">property</a>,
which uses either a <em>label</em> or a <strong>Boolean array</strong> to index the
<strong>GeoDataFrame</strong>. So the line below,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">roads_itm</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="s1">&#39;Length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">length</span>
</pre></div>
</div>
<p>assigns the <code class="docutils literal notranslate"><span class="pre">length</span></code> property of the row’s geometry to a new column,
<strong>Length</strong>, at the corresponding index. Putting it all together, it
looks like this:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">roads_itm</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span> <span class="c1"># iterate over each row in the GeoDataFrame</span>
    <span class="n">roads_itm</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="s1">&#39;Length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">length</span> <span class="c1"># assign the row&#39;s geometry length to a new column, Length</span>

<span class="nb">print</span><span class="p">(</span><span class="n">roads_itm</span><span class="o">.</span><span class="n">head</span><span class="p">())</span> <span class="c1"># print the updated GeoDataFrame to see the changes</span>
</pre></div>
</div>
<p>Finally, we can subset our <strong>GeoDataFrame</strong> to select only <em>MOTORWAY</em>
features, and sum their length using the <code class="docutils literal notranslate"><span class="pre">.sum()</span></code> method:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sum_roads</span> <span class="o">=</span> <span class="n">roads_itm</span><span class="p">[</span><span class="s1">&#39;Length&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">sum_motorway</span> <span class="o">=</span> <span class="n">roads_itm</span><span class="p">[</span><span class="n">roads_itm</span><span class="p">[</span><span class="s1">&#39;Road_class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MOTORWAY&#39;</span><span class="p">][</span><span class="s1">&#39;Length&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1"> total m of roads&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sum_roads</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1"> total m of motorway&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sum_motorway</span><span class="p">))</span>
</pre></div>
</div>
<p>In the cell above, look at the <code class="docutils literal notranslate"><span class="pre">print</span></code> function argument:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1"> total m of motorway&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sum_motorway</span><span class="p">))</span>
</pre></div>
</div>
<p>Here, we use the <code class="docutils literal notranslate"><span class="pre">format</span></code> <a class="reference external" href="https://docs.python.org/3.8/library/string.html#format-string-syntax">string
method</a>
and curly braces ({ }) to insert the value of our <code class="docutils literal notranslate"><span class="pre">sum_motorway</span></code>
variable. Note that within the curly braces, there is a <em>format
specification</em> - rather than printing the string in an unformatted way
(which would contain a lot of extra decimal places), we can tell the
<code class="docutils literal notranslate"><span class="pre">format</span></code> method to clean up the output using <code class="docutils literal notranslate"><span class="pre">:</span></code> and a <a class="reference external" href="https://docs.python.org/3.8/library/string.html#formatspec">format
specification</a>.
In this case, <code class="docutils literal notranslate"><span class="pre">.2f</span></code> tells the <code class="docutils literal notranslate"><span class="pre">format</span></code> method format the number to
have 2 places after the decimal.</p>
<p>Let’s say now that we want to find the sum of all of the different road
classes in our dataset. We could, of course, repeat the exercise above
for each of the different values of <em>Road_class</em>. But, <strong>pandas</strong> (and
by extension, <strong>geopandas</strong>) provide a nicer way to summarize data based
on certain properties: the <code class="docutils literal notranslate"><span class="pre">groupby</span></code>
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html">method</a>.
The <code class="docutils literal notranslate"><span class="pre">groupby</span></code> method returns an object that contains information about
the groups; to see different properties, we can call methods like
<code class="docutils literal notranslate"><span class="pre">mean</span></code>, <code class="docutils literal notranslate"><span class="pre">median</span></code>, <code class="docutils literal notranslate"><span class="pre">sum</span></code>, etc.</p>
<p>If we want to summarize our dataset by <em>Road_class</em> and find the <code class="docutils literal notranslate"><span class="pre">sum</span></code>
of the <em>Length</em> of each group, then, it would like this:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roads_itm</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Road_class&#39;</span><span class="p">])[</span><span class="s1">&#39;Length&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1000</span> <span class="c1"># convert to km</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">groupby</span></code> method returns a <strong>GeoDataFrame</strong>, which we can then
index to return a single column, <em>Length</em>. As this is a numeric column,
we can also use arithmetic on it to divide by a conversion factor. The
<code class="docutils literal notranslate"><span class="pre">groupby</span></code> method is a very useful way to quickly summarize a
<strong>DataFrame</strong> (or a <strong>GeoDataFrame</strong> - remember that this is a <strong>child</strong>
class of <strong>DataFrame</strong>).</p>
</div>
</div>
<div class="section" id="spatial-data-operations-using-geopandas-and-shapely">
<h3>4. Spatial data operations using geopandas and shapely<a class="headerlink" href="#spatial-data-operations-using-geopandas-and-shapely" title="Permalink to this headline">#</a></h3>
<p>Oftentimes in GIS analysis, we want to summarize our data spatially, as
well as thematically. In this section, we will be looking at two
examples of this kind of analysis: first, using a <a class="reference external" href="https://gisgeography.com/spatial-join/">spatial
join</a>, and second, using a
clipping operation.</p>
<p>The cell below will load the Counties shapefile in <strong>data_files</strong> and
test whether the CRS of the <code class="docutils literal notranslate"><span class="pre">counties</span></code> <strong>GeoDataFrame</strong> is the same as
the CRS of the <code class="docutils literal notranslate"><span class="pre">roads_itm</span></code> <strong>GeoDataFrame</strong>. Remember that the
<strong>shapely</strong> geometry objects in the <strong>GeoDataFrame</strong> don’t have any
inherent information about the CRS of the object. So, in order to
perform operations like a spatial join, we have to first ensure that the
two <strong>GeoDataFrame</strong> objects have the same CRS.</p>
<p>If, when you first load the shapefile, the test below returns False,
write a line of code that will ensure that the test returns True.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">counties</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;data_files/Counties.shp&#39;</span><span class="p">)</span> <span class="c1"># load the Counties shapefile</span>
<span class="c1"># your line of code might go here.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">counties</span><span class="o">.</span><span class="n">crs</span> <span class="o">==</span> <span class="n">roads_itm</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span> <span class="c1"># test if the crs is the same for roads_itm and counties.</span>
</pre></div>
</div>
<p>Now that the two <strong>GeoDataFrame</strong> objects have the same CRS, we can
proceed with the spatial join using <code class="docutils literal notranslate"><span class="pre">gpd.sjoin()</span></code>
(<a class="reference external" href="https://geopandas.org/en/stable/docs/reference/api/geopandas.sjoin.html">documentation</a>):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">join</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">sjoin</span><span class="p">(</span><span class="n">counties</span><span class="p">,</span> <span class="n">roads_itm</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">lsuffix</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">rsuffix</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span> <span class="c1"># perform the spatial join</span>
<span class="n">join</span> <span class="c1"># show the joined table</span>
</pre></div>
</div>
<p>Now, we can see that our table has additional columns - we have the
unnamed <em>index</em>, <em>COUNTY_ID</em>, <em>CountyName</em>, <em>Area_SqKM</em>, <em>OBJECTID</em>, and
<em>geometry</em> from the <code class="docutils literal notranslate"><span class="pre">counties</span></code> <strong>GeoDataFrame</strong>, and <em>index_right</em>
(because it has the same name as <em>index</em> in the left <strong>GeoDataFrame</strong>),
<em>SURVEY</em>, <em>Road_class</em>, and <em>Length</em> from the <code class="docutils literal notranslate"><span class="pre">roads_itm</span></code>
<strong>GeoDataFrame</strong>.</p>
<p>Like we did with <code class="docutils literal notranslate"><span class="pre">roads_itm</span></code>, we can again summarize our
<strong>GeoDataFrame</strong> using <code class="docutils literal notranslate"><span class="pre">groupby</span></code>; this time, we’ll use the
<em>CountyName</em> property to see the total length of roads by each county,
and by <em>Road_class</em>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">join_total</span> <span class="o">=</span> <span class="n">join</span><span class="p">[</span><span class="s1">&#39;Length&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1"># find the total length of roads in the join GeoDataFrame</span>
<span class="nb">print</span><span class="p">(</span><span class="n">join</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;CountyName&#39;</span><span class="p">,</span> <span class="s1">&#39;Road_class&#39;</span><span class="p">])[</span><span class="s1">&#39;Length&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span> <span class="c1"># summarize the road lengths by CountyName, Road_class</span>

<span class="c1"># check that the total length of roads is the same between both GeoDataFrames</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total length of roads from original file: </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sum_roads</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total length of roads from spatial join: </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">join_total</span><span class="p">))</span>
</pre></div>
</div>
<p>We can see that the total length of roads is <strong>not</strong> the same in both
<strong>GeoDataFrame</strong> objects - our <code class="docutils literal notranslate"><span class="pre">join</span></code> <strong>GeoDataFrame</strong> has somehow
increased the length of roads.</p>
<p>In reality, what has happened here is that we have double-counted any
road feature that is located in multiple counties - you can also see
this by comparing the total number of objects in the <code class="docutils literal notranslate"><span class="pre">join</span></code>
<strong>GeoDataFrame</strong> and the <code class="docutils literal notranslate"><span class="pre">roads_itm</span></code> <strong>GeoDataFrame</strong>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of features in roads_itm: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">roads_itm</span><span class="o">.</span><span class="n">index</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of features in join: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">join</span><span class="o">.</span><span class="n">index</span><span class="p">)))</span>
</pre></div>
</div>
<p>Obviously, we don’t want to double-count roads - to get around this, we
can use the <code class="docutils literal notranslate"><span class="pre">gpd.clip()</span></code> method
(<a class="reference external" href="https://geopandas.org/en/stable/docs/reference/api/geopandas.clip.html">documentation</a>)
to clip <code class="docutils literal notranslate"><span class="pre">roads_itm</span></code> to each of the county boundaries in the
<code class="docutils literal notranslate"><span class="pre">counties</span></code> <strong>GeoDataFrame</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">help</span><span class="p">(</span><span class="n">gpd</span><span class="o">.</span><span class="n">clip</span><span class="p">)</span>
<span class="n">Help</span> <span class="n">on</span> <span class="n">function</span> <span class="n">clip</span> <span class="ow">in</span> <span class="n">module</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">clip</span><span class="p">:</span>

<span class="n">clip</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">keep_geom_type</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">Clip</span> <span class="n">points</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="ow">or</span> <span class="n">polygon</span> <span class="n">geometries</span> <span class="n">to</span> <span class="n">the</span> <span class="n">mask</span> <span class="n">extent</span><span class="o">.</span>

    <span class="n">Both</span> <span class="n">layers</span> <span class="n">must</span> <span class="n">be</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">same</span> <span class="n">Coordinate</span> <span class="n">Reference</span> <span class="n">System</span> <span class="p">(</span><span class="n">CRS</span><span class="p">)</span><span class="o">.</span>
    <span class="n">The</span> <span class="n">gdf</span> <span class="n">will</span> <span class="n">be</span> <span class="n">clipped</span> <span class="n">to</span> <span class="n">the</span> <span class="n">full</span> <span class="n">extent</span> <span class="n">of</span> <span class="n">the</span> <span class="n">clip</span> <span class="nb">object</span><span class="o">.</span>

    <span class="n">If</span> <span class="n">there</span> <span class="n">are</span> <span class="n">multiple</span> <span class="n">polygons</span> <span class="ow">in</span> <span class="n">mask</span><span class="p">,</span> <span class="n">data</span> <span class="kn">from</span> <span class="nn">gdf</span> <span class="n">will</span> <span class="n">be</span>
    <span class="n">clipped</span> <span class="n">to</span> <span class="n">the</span> <span class="n">total</span> <span class="n">boundary</span> <span class="n">of</span> <span class="nb">all</span> <span class="n">polygons</span> <span class="ow">in</span> <span class="n">mask</span><span class="o">.</span>
<span class="o">...</span>
</pre></div>
</div>
<p>But, we have to do this for each of the boundaries - <code class="docutils literal notranslate"><span class="pre">gpd.clip</span></code> will
take the total boundary for the <strong>GeoDataFrame</strong> if there are multiple
<strong>Polygon</strong> objects. Using a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop to loop over the <code class="docutils literal notranslate"><span class="pre">counties</span></code>
<strong>GeoDataFrame</strong>, we can clip <code class="docutils literal notranslate"><span class="pre">roads_itm</span></code> to each county, and combine
the results in another <strong>GeoDataFrame</strong>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clipped</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># initialize an empty list</span>
<span class="k">for</span> <span class="n">county</span> <span class="ow">in</span> <span class="n">counties</span><span class="p">[</span><span class="s1">&#39;CountyName&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">tmp_clip</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">roads_itm</span><span class="p">,</span> <span class="n">counties</span><span class="p">[</span><span class="n">counties</span><span class="p">[</span><span class="s1">&#39;CountyName&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">county</span><span class="p">])</span> <span class="c1"># clip the roads by county border</span>
    <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tmp_clip</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">tmp_clip</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="s1">&#39;Length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">length</span> <span class="c1"># we have to update the length for any clipped roads</span>
        <span class="n">tmp_clip</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="s1">&#39;CountyName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">county</span> <span class="c1"># set the county name for each road feature</span>
    <span class="n">clipped</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp_clip</span><span class="p">)</span> <span class="c1"># add the clipped GeoDataFrame to the</span>

<span class="c1"># pandas has a function, concat, which will combine (concatenate) a list of DataFrames (or GeoDataFrames)</span>
<span class="c1"># we can then create a GeoDataFrame from the combined DataFrame, as the combined DataFrame will have a geometry column.</span>
<span class="n">clipped_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">clipped</span><span class="p">))</span>
<span class="n">clip_total</span> <span class="o">=</span> <span class="n">clipped_gdf</span><span class="p">[</span><span class="s1">&#39;Length&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total length of roads from original file: </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sum_roads</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total length of roads from clipped join: </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">clip_total</span><span class="p">))</span>
</pre></div>
</div>
<p>So we don’t have perfect overlap, but this has more to do with the fact
that there isn’t perfect overlap between the <code class="docutils literal notranslate"><span class="pre">counties</span></code> boundary and
the <code class="docutils literal notranslate"><span class="pre">roads</span></code> features - there are a good number of places where the
roads extend beyond the boundary:</p>
<a class="reference internal image-reference" href="../../../_images/road_extension.png"><img alt="one of the locations where the road shapefile extends beyond the boundaries of NI" class="align-center" src="../../../_images/road_extension.png" style="width: 720px;" /></a>
<p>To fix this, we could first clip <code class="docutils literal notranslate"><span class="pre">roads_itm</span></code> to the entire
<code class="docutils literal notranslate"><span class="pre">counties</span></code> <strong>GeoDataFrame</strong>, which would eliminate these extraneous
stretches of road.</p>
<p>For now, though, agrement to within .01% is acceptable for our purposes
- much better than the 1.5% disagreement from the spatial join alone.</p>
<p>To wrap up, write a line or two of code in the cell below that will
summarize the <code class="docutils literal notranslate"><span class="pre">clipped_gdf</span></code> GeoDataFrame by county and road type.
Which county has the most Motorways? The most roads in total?</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code goes here!</span>
</pre></div>
</div>
</div>
<div class="section" id="exercise-and-next-steps">
<h3>5. Exercise and next steps<a class="headerlink" href="#exercise-and-next-steps" title="Permalink to this headline">#</a></h3>
<p>Now that you’ve gained some experience working with <code class="docutils literal notranslate"><span class="pre">shapely</span></code> geometry
objects and <code class="docutils literal notranslate"><span class="pre">geopandas</span></code> <strong>GeoDataFrame</strong> objects, have a look at
<strong>exercise_script.py</strong> in this folder. Using the topics covered in the
Week 2 practical and this practical, modify this script to do the
following: 1. Load the counties and ward data 2. Using a spatial join,
summarize the total population by county. What county has the highest
population? What about the lowest? 3. Create a map like the one below to
show population information by census area, with the county boundaries
plotted overtop of the chloropleth map.</p>
<a class="reference internal image-reference" href="../../../_images/sample_map.png"><img alt="the sample map to be produced in the exercise" class="align-center" src="../../../_images/sample_map.png" style="width: 600px;" /></a>
</div>
<div class="section" id="additional-exercise-questions">
<h3>Additional exercise questions<a class="headerlink" href="#additional-exercise-questions" title="Permalink to this headline">#</a></h3>
<ol class="arabic simple">
<li><p>Are there any Wards that are located in more than one county? If so,
how many, and what is the total population of these Wards?</p></li>
<li><p>What Ward has the highest population? What about the lowest
population?</p></li>
<li><p>Repeat the exercise above using <strong>exercise_script.py</strong>, but this time
use the population density (in number of residents per square km).</p></li>
</ol>
</div>
</div>
</div>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="week2.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">mapping with cartopy</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="folium.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">interactive maps with folium</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Bob McNabb<br/>
  
      &copy; Copyright 2023, Bob McNabb. Licensed under Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0).<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>