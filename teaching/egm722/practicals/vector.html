

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>vector data using shapely and geopandas &#8212; space cameras and glaciers</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" href="../../../_static/customstyle.css" type="text/css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'teaching/egm722/practicals/vector';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="interactive maps with folium" href="folium.html" />
    <link rel="prev" title="conflict resolution (using git)" href="conflicts.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">space cameras and glaciers</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../whataboutbob.html">about me</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../index.html">teaching</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../../egm101/index.html">EGM101: skills toolbox</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../egm101/lectures.html">lectures</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../egm101/practicals/index.html">practicals</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../egm101/practicals/week5.html">computation, summary statistics, and graphing in excel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm101/practicals/week6.html">summarizing and graphing data in spss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm101/practicals/week7.html">correlation and regression in spss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm101/practicals/week8.html">hypothesis testing using spss</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../egm101/resources.html">additional resources</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../egm310/index.html">EGM310: introduction to gis and remote sensing</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../egm310/lectures.html">lectures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../egm310/resources.html">additional resources</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../egm702/index.html">EGM702: photogrammetry and advanced image analysis</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../egm702/lectures.html">lectures</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../egm702/practicals/index.html">practicals</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../egm702/practicals/setup.html">software setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm702/practicals/week1.html">dem processing using micmac</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm702/practicals/week2.html">dem differencing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm702/practicals/week3.html">introduction to google earth engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm702/practicals/week4.html">change detection in earth engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm702/practicals/week5.html">classification in earth engine</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../egm702/resources.html">additional resources</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../egm703/index.html">EGM703: advanced active and passive remote sensing</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../egm703/lectures.html">lectures</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../egm703/practicals/index.html">practicals</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../egm703/practicals/week1.html">urban heat islands</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm703/practicals/week2.html">hyperspectral image analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm703/practicals/week3.html">SAR image processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm703/practicals/week4.html">InSAR Processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm703/practicals/week5.html">SAR image interpretation and flood mapping</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../egm703/resources.html">additional resources</a></li>
</ul>
</li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../index.html">EGM722: programming for gis and remote sensing</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="../setup/index.html">setup</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../setup/github.html">setting up github</a></li>
<li class="toctree-l4"><a class="reference internal" href="../setup/git.html">installing git</a></li>
<li class="toctree-l4"><a class="reference internal" href="../setup/desktop.html">installing github desktop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../setup/fork.html">forking the repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="../setup/clone.html">cloning the repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="../setup/conda.html">setting up conda/anaconda</a></li>
<li class="toctree-l4"><a class="reference internal" href="../setup/environment.html">setting up a conda environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../setup/jupyter.html">configuring jupyter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../setup/pycharm.html">pycharm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../setup/pip.html">installing packages with pip</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../lectures.html">lectures</a></li>
<li class="toctree-l3 current active has-children"><a class="reference internal" href="index.html">practicals</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="pythonintro.html">intro to python</a></li>
<li class="toctree-l4"><a class="reference internal" href="debugging.html">debugging exercise</a></li>
<li class="toctree-l4"><a class="reference internal" href="cartopy.html">mapping with cartopy</a></li>
<li class="toctree-l4"><a class="reference internal" href="conflicts.html">conflict resolution (using git)</a></li>
<li class="toctree-l4 current active"><a class="current reference internal" href="#">vector data using shapely and geopandas</a></li>
<li class="toctree-l4"><a class="reference internal" href="folium.html">interactive maps with folium</a></li>
<li class="toctree-l4"><a class="reference internal" href="raster.html">raster data using rasterio</a></li>
<li class="toctree-l4"><a class="reference internal" href="earthaccess.html">searching + downloading satellite data using earthaccess</a></li>
<li class="toctree-l4"><a class="reference internal" href="zonalstats.html">zonal statistics using rasterstats</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../faq/index.html">help! something went wrong!</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../faq/git.html">git troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../faq/python.html">python troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../project/index.html">programming project</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../project/github.html">creating a new github repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="../project/environment.html">environment.yml</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../resources.html">additional resources</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../unis/index.html">unis glaciology (AG-325)</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../unis/optical.html">mapping glacier area change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../unis/dems.html">dem differencing and geodetic mass balance</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python-programming/index.html">programming skills for phd researchers (using python)</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../python-programming/setup/index.html">setup</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/setup/github.html">setting up github</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/setup/git.html">installing git</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/setup/desktop.html">installing github desktop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/setup/fork.html">forking the repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/setup/clone.html">cloning the repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/setup/conda.html">setting up conda/anaconda</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/setup/environment.html">setting up a conda environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/setup/jupyter.html">configuring the jupyterlab terminal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/setup/pycharm.html">pycharm</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../python-programming/lectures.html">lectures</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../python-programming/exercises/index.html">exercises</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/exercises/git.html">introduction to version control using git</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/exercises/project.html">starting a new project</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/exercises/intro.html">introduction to python using jupyterlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/exercises/debugging.html">debugging code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/exercises/plotting.html">plotting data using seaborn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/exercises/pandas.html">working with pandas dataframes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/exercises/stats.html">basic statistical analysis using python</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/exercises/regression.html">linear regression using python</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../python-programming/resources.html">additional resources</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../r-programming/index.html">programming skills for phd researchers (using R)</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../r-programming/setup/index.html">setup</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../r-programming/setup/github.html">setting up github</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../r-programming/setup/git.html">installing git</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../r-programming/setup/desktop.html">installing github desktop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../r-programming/setup/fork.html">forking the repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../r-programming/setup/clone.html">cloning the repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../r-programming/setup/conda.html">setting up conda/anaconda</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../r-programming/setup/environment.html">setting up a conda environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../r-programming/setup/jupyter.html">configuring jupyterlab</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../r-programming/lectures.html">lectures</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../r-programming/exercises/index.html">exercises</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../r-programming/exercises/git.html">introduction to version control using git</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../r-programming/exercises/project.html">starting a new project</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../r-programming/exercises/rintro.html">introduction to <strong>R</strong> using jupyterlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../r-programming/exercises/debugging.html">debugging code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../r-programming/exercises/plotting.html">plotting data using ggplot2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../r-programming/exercises/transform.html">transforming data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../r-programming/exercises/stats.html">basic statistical analysis using <strong>R</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../r-programming/exercises/regression.html">linear regression using <strong>R</strong></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../r-programming/resources.html">additional resources</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../ml-crash-course/index.html">a crash course in machine learning (using python) – under development</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../ml-crash-course/setup.html">setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ml-crash-course/lectures.html">lectures</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../ml-crash-course/exercises/index.html">exercises</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../ml-crash-course/exercises/regression.html">what is machine learning?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../ml-crash-course/exercises/training_testing.html">training, testing, and validation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../ml-crash-course/exercises/feature_design.html">feature design and engineering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../ml-crash-course/exercises/performance.html">measuring model performance</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../ml-crash-course/resources.html">additional resources</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../hpc-intro/index.html">introduction to high performance computing</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../hpc-intro/setup.html">setup</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../hpc-intro/shell/index.html">the unix shell</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../hpc-intro/shell/shell.html">in the beginning was the command line</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../hpc-intro/shell/navigation.html">navigating on the command line</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../hpc-intro/shell/files.html">working with files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../hpc-intro/shell/input.html">input/output</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../hpc-intro/shell/scripts.html">shell scripts</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../hpc-intro/hpc/index.html">high performance computing</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-25"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../hpc-intro/hpc/atlas.html">atlas</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../hpc-intro/hpc/data_transfer.html">transferring data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../hpc-intro/hpc/vulcan.html">vulcan</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../hpc-intro/resources.html">additional resources</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../dissertation/index.html">undergraduate dissertation projects</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-26"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../dissertation/glaciers.html">mapping glacier changes over time</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dissertation/glacial_lakes.html">detection of supraglacial lakes and timing of drainage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dissertation/algae.html">mapping harmful algal blooms using satellite remote sensing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dissertation/floods.html">flood detection and monitoring using remote sensing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dissertation/wildfires.html">detection and mapping of wildfires</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dissertation/heat_islands.html">urban heat islands</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../gee/index.html">google earth engine</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-27"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../gee/tutorials/index.html">gee tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-28"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../gee/tutorials/getting_started/index.html">getting started</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-29"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/getting_started/adding_exporting.html">adding and exporting images</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/getting_started/spectral.html">spectral signatures</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/getting_started/image_collections.html">image collections and vectors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/getting_started/mapping.html">manual mapping (digitizing)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/getting_started/band_maths.html">band maths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/getting_started/zonal_stats.html">zonal statistics</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../gee/tutorials/classification/index.html">image classification</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-30"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/classification/unsupervised.html">unsupervised classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/classification/pixel.html">pixel-based classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/classification/obia.html">object-based classification</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../gee/tutorials/change_detection/index.html">change detection</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-31"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/change_detection/visual_analysis.html">visual analysis of changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/change_detection/thresholding.html">band maths and thresholding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/change_detection/repeat_classification.html">repeat classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/change_detection/cva.html">change vector analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/change_detection/time_series.html">time series analysis</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../gee/tutorials/enhancement/index.html">image enhancement</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-32"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/enhancement/filtering.html">image filtering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/enhancement/pansharpening.html">pansharpening</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/enhancement/edge_detection.html">edge detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/enhancement/unmixing.html">spectral unmixing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/enhancement/pca.html">principle component analysis</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../gee/tutorials/advanced/index.html">advanced topics</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-33"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/advanced/animation.html">creating an animation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../gee/exercises/index.html">sample exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../research/index.html">ongoing and past research projects</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-34"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../research/dar.html">deplete and retreat (DaR)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../writing/index.html">selected writing samples</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-35"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../writing/source.html">source magazine (summer 2022)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../github.html">github projects</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/iamdonovan/iamdonovan.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/iamdonovan/iamdonovan.github.io/edit/main/teaching/egm722/practicals/vector.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/iamdonovan/iamdonovan.github.io/issues/new?title=Issue%20on%20page%20%2Fteaching/egm722/practicals/vector.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/teaching/egm722/practicals/vector.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>vector data using shapely and geopandas</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-started">getting started</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rachel-mcadams">Rachel McAdams</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">overview</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#objectives">objectives</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-provided">data provided</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">getting started</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shapely-geometry-types">shapely geometry types</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#points">Points</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#linestrings">LineStrings</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#polygons">Polygons</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interactions-between-geometry-objects">interactions between geometry objects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#geopandas-geodataframes">geopandas GeoDataFrames</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#coordinate-reference-systems-using-proj">coordinate reference systems using PROJ</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-operations-and-summarizing-data-using-geopandas">vector operations and summarizing data using geopandas</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-data-operations-using-geopandas-and-shapely">spatial data operations using geopandas and shapely</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-and-next-steps">exercise and next steps</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-exercise-questions">additional exercise questions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#next-steps">next steps</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="vector-data-using-shapely-and-geopandas">
<h1>vector data using shapely and geopandas<a class="headerlink" href="#vector-data-using-shapely-and-geopandas" title="Permalink to this heading">#</a></h1>
<p>In this practical, you’ll gain some more experience working with vector data in python. You will learn about the different vector
data types available in the shapely package, and how we can use the geopandas package to perform different vector data
operations and analyses.</p>
<p>The practicals this week are provided as Jupyter Notebooks, where you can interactively work through the different
steps of plotting the data. There is another file, <strong>exercise_script.py</strong>, which you can modify to perform
additional analyses, based on what you’ve learned in the Jupyter Notebook and the mapping exercise in Practical 2.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You should also see an example script, <strong>examples/week3_example.py</strong>. Be sure to try out the exercise and see
if you can’t figure out a solution on your own, before having a look at the (one of many possible) solution
offered there.</p>
</div>
<section id="getting-started">
<h2>getting started<a class="headerlink" href="#getting-started" title="Permalink to this heading">#</a></h2>
<p><a class="reference internal" href="cartopy.html"><span class="doc">Last week</span></a>, we saw how we can synchronize branches of our fork on GitHub. We also saw how we can use
<strong>GitHub Desktop</strong> to merge two branches (in this case, <code class="docutils literal notranslate"><span class="pre">week2</span></code> into <code class="docutils literal notranslate"><span class="pre">main</span></code>). This week, we’re going to see how to
do these things using the command line.</p>
<p>To get started with this week’s practical, open Anaconda Navigator, then launch the <strong>Anaconda Command Prompt</strong> - either
from <strong>Anaconda Navigator</strong> (make sure that your egm722 environment is selected), or from the <strong>Start Menu</strong>.</p>
<p>When the <strong>Command Prompt</strong> opens, navigate to your repository folder using <code class="docutils literal notranslate"><span class="pre">cd</span></code>, then type <code class="docutils literal notranslate"><span class="pre">dir</span></code> and press <strong>Enter</strong>.
For example, if the path to your repository folder is <strong>C:\Users\bob\egm722</strong>, you should run the command:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>cd C:\Users\bob\egm722
</pre></div>
</div>
<p>Followed by <code class="docutils literal notranslate"><span class="pre">dir</span></code>. You should then see something similar to the following:</p>
<a class="reference internal image-reference" href="../../../_images/main_dir.png"><img alt="the dir of the main branch" class="align-center" src="../../../_images/main_dir.png" style="width: 600px;" /></a>
<p><br /> Here, you can see a list of the different files in the directory, similar to what you can see in
<strong>Windows Explorer</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On Mac OS, the command to show the files in the directory is <strong>ls</strong>.</p>
</div>
<p>Switch to the <code class="docutils literal notranslate"><span class="pre">week3</span></code> branch by typing:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git checkout week3
</pre></div>
</div>
<p>and pressing <strong>Enter</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you see some version of the following:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>hint: If you meant to check out a remote tracking branch on, e.g., &#39;origin&#39;,
hint: you can do so by fully qualifying the name with the --track option:
hint:
hint:     git checkout --track origin/&lt;name&gt;
hint:
hint: If you&#39;d like to always have checkouts of an ambiguous &lt;name&gt; prefer
hint: one remote, e.g. the &#39;origin&#39; remote, consider setting
hint: checkout.defaultRemote=origin in your config
</pre></div>
</div>
<p>What this is telling you is that you <em>either</em> have to explicitly specify <strong>which</strong> remote branch
you want to check out (e.g., <code class="docutils literal notranslate"><span class="pre">origin</span></code> or <code class="docutils literal notranslate"><span class="pre">upstream</span></code>), <strong>or</strong> you should set your
<code class="docutils literal notranslate"><span class="pre">defaultRemote</span></code> option using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">config</span></code> by running the following command:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git config --global checkout.defaultRemote origin
</pre></div>
</div>
</div>
<p>Next, type <code class="docutils literal notranslate"><span class="pre">dir</span></code> and press <strong>Enter</strong> again. You should now see this - the files in the current directory have changed,
because <strong>git</strong> has updated the working directory when we switched branches:</p>
<a class="reference internal image-reference" href="../../../_images/week3_dir.png"><img alt="the dir of the week3 branch" class="align-center" src="../../../_images/week3_dir.png" style="width: 600px;" /></a>
<p><br /> To <strong>merge</strong> the <code class="docutils literal notranslate"><span class="pre">week3</span></code> branch of our repository into <code class="docutils literal notranslate"><span class="pre">main</span></code>, we’ll use <strong>git</strong> from the command line.</p>
<p>Remember that at the <a class="reference internal" href="cartopy.html#desktop-branches"><span class="std std-ref">start</span></a> of last week’s practical, we discussed the difference between
<strong>local</strong>, <strong>origin</strong>, and <strong>upstream</strong> branches:</p>
<ul class="simple">
<li><p><strong>local</strong> branches are the ones stored <em>local</em>ly on your computer,</p></li>
<li><p><strong>origin</strong> branches are the branches of your repository stored on GitHub,</p></li>
<li><p><strong>upstream</strong> branches are the branches of the repository that you forked the egm722 repository from
(<a class="github reference external" href="https://github.com/iamdonovan/egm722">iamdonovan/egm722</a>).</p></li>
</ul>
<p>As we saw last week, there may be changes to the <strong>upstream</strong> repository that we want to integrate into our local
version of a repository.</p>
<p>For example, for this module I may have added an additional exercise to the practical in one week, and you
want to make sure that you have this before you <strong>merge</strong> that week’s branch into the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch.</p>
<p>To be able to keep track of the <strong>upstream</strong> changes, we need to make sure that our local repository knows where the
<strong>upstream</strong> repository is. First, double-check what <strong>remote</strong> (not <strong>local</strong>) repositories git is keeping track of
by typing the following at the command line:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git remote -v
</pre></div>
</div>
<p>This will list the <strong>remote</strong> repositories, and their nicknames. You should see an output like this:</p>
<a class="reference internal image-reference" href="../../../_images/remote_v.png"><img alt="the remote repositories for this repository" class="align-center" src="../../../_images/remote_v.png" style="width: 720px;" /></a>
<p><br /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you only see <strong>origin</strong>, then we need to add the <strong>upstream</strong> remote location using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">remote</span> <span class="pre">add</span></code>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git remote add upstream https://github.com/iamdonovan/egm722.git
</pre></div>
</div>
<p>This adds the URL for the <strong>upstream</strong> repository (<a class="github reference external" href="https://github.com/iamdonovan/egm722.git">iamdonovan/egm722.git</a>) to our local
configuration.</p>
<p>You can check that this worked by typing <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">remote</span> <span class="pre">-v</span></code> again - you should now see two lines
for the <strong>upstream</strong> repository, along with two lines for the <strong>origin</strong> repository.</p>
</div>
<p>Now, we can tell <strong>git</strong> to specifically <strong>pull</strong> the <strong>upstream</strong> version of a particular branch:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git pull upstream &lt;branch&gt;
</pre></div>
</div>
<p>This will <strong>pull</strong> (<strong>fetch</strong> and <strong>merge</strong>) the <strong>upstream</strong> version of &lt;<strong>branch</strong>&gt; (if it exists) into the <strong>local</strong>
version of the current branch.</p>
<p>For example, <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span> <span class="pre">upstream</span> <span class="pre">week3</span></code> would merge the <strong>upstream</strong> <code class="docutils literal notranslate"><span class="pre">week3</span></code> branch into our current branch (<code class="docutils literal notranslate"><span class="pre">week3</span></code>).
Go ahead and enter this command now:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git pull upstream week3
</pre></div>
</div>
<p>If you see the following output:</p>
<a class="reference internal image-reference" href="../../../_images/pull_upstream.png"><img alt="pulling the upstream changes into the current branch" class="align-center" src="../../../_images/pull_upstream.png" style="width: 600px;" /></a>
<p><br /> This indicates that there’s been no change to the <strong>upstream</strong> branch that isn’t already in our <strong>origin</strong> branch.</p>
<p>You may also see output that indicates there are changes to the <strong>upstream</strong> branch that aren’t present in our
<strong>origin</strong> (or <strong>local</strong>) branch:</p>
<a class="reference internal image-reference" href="../../../_images/fast_forward.png"><img alt="pulling the upstream changes into the current branch with a fast-forward merge" class="align-center" src="../../../_images/fast_forward.png" style="width: 600px;" /></a>
<p><br /> As long as you don’t have any conflicts between the two branches, you should see that <strong>git</strong> does a
“fast-forward” merge, as shown above - that is, <strong>git</strong> will just update the <strong>local</strong> branch by moving it forward in
the shared history between the <strong>upstream</strong> and <strong>local</strong> versions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you do see a message indicating conflicts between different versions of your branches:</p>
<a class="reference internal image-reference" href="../../../_images/divergent.png"><img alt="a message indicating that the two branches have a divergent history and can't be easily merged" class="align-center" src="../../../_images/divergent.png" style="width: 720px;" /></a>
<p>You will need to resolve those conflicts in a similar way to what you did <a class="reference internal" href="conflicts.html"><span class="doc">last week</span></a> before
you are able to move forward - it’s probably best to ask for some help on blackboard here.</p>
</div>
<p>As long as there are no changes (or git was able to fast-forward), though, let’s switch back to the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git checkout main
</pre></div>
</div>
<p>And enter the following command:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git merge week3
</pre></div>
</div>
<p>You should now see the following output in the window (again, what you see may differ slightly):</p>
<a class="reference internal image-reference" href="../../../_images/updates.png"><img alt="the updates displayed after merging week3 into main" class="align-center" src="../../../_images/updates.png" style="width: 600px;" /></a>
<p><br /> This tells us what files have been changed (<code class="docutils literal notranslate"><span class="pre">18</span> <span class="pre">files</span></code>) and how (<code class="docutils literal notranslate"><span class="pre">854</span> <span class="pre">insertions(+)</span></code>). Because none the files
in the <strong>Week3</strong> folder were present in the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch, we’ll only see additions/insertions. As you work on your
project and commit changes to existing files, you’ll also see deletions (lines that are deleted or changed).</p>
<p>You should also see Weeks 1–3 in your repository folder:</p>
<a class="reference internal image-reference" href="../../../_images/merged_week3.png"><img alt="the repository folder after merging week3 into main" class="align-center" src="../../../_images/merged_week3.png" style="width: 600px;" /></a>
<p><br /> Just as we saw last week, now that we have merged our <code class="docutils literal notranslate"><span class="pre">week3</span></code> branch into <code class="docutils literal notranslate"><span class="pre">main</span></code>, we can <strong>prune</strong> (delete)
it. The command line syntax for this is:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git branch -d &lt;name&gt;
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">&lt;name&gt;</span></code> is the name of the branch we want to delete. If <code class="docutils literal notranslate"><span class="pre">&lt;name&gt;</span></code> has not been fully integrated into our
current branch, you may see a warning like the following:</p>
<a class="reference internal image-reference" href="../../../_images/delete_warning.png"><img alt="a warning that the branch has not been fully merged into the current branch" class="align-center" src="../../../_images/delete_warning.png" style="width: 600px;" /></a>
<p><br /> Otherwise, you should see a message like this:</p>
<a class="reference internal image-reference" href="../../../_images/branch_deleted.png"><img alt="a message indicating that the branch has been deleted" class="align-center" src="../../../_images/branch_deleted.png" style="width: 600px;" /></a>
<p><br /> Once you have deleted the Finally, let’s <strong>push</strong> these changes to your GitHub repository:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>git push
</pre></div>
</div>
<p>As before, you can confirm that the changes are now on your remote repository by heading over to GitHub:</p>
<a class="reference internal image-reference" href="../../../_images/week3_remote.png"><img alt="the github repository, with the merged changes updated" class="align-center" src="../../../_images/week3_remote.png" style="width: 720px;" /></a>
<p><br /> At this point, you can launch Jupyter Notebooks as you have in the previous weeks, and begin to work through the
practical exercise.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Below this point is the <strong>non-interactive</strong> text of the notebook. To actually run the notebook, you’ll need to
follow the instructions above to open the notebook and run it on your own computer!</p>
</div>
</section>
<hr class="docutils" />
<section id="rachel-mcadams">
<h2>Rachel McAdams<a class="headerlink" href="#rachel-mcadams" title="Permalink to this heading">#</a></h2>
<section id="overview">
<h3>overview<a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h3>
<p>Up to now, you have gained some experience working with basic features
of python, and used cartopy and matplotlib to create a map. In each of
these practicals, you have loaded different vector datasets using a
module called geopandas. In this week’s practical, we’ll be looking at
working vector data in a bit more depth, including the different
geometry types available using shapely, analyses like spatial joins and
summarizing based on attributes, and how to reproject vector data from
one coordinate reference system to another.</p>
</section>
<section id="objectives">
<h3>objectives<a class="headerlink" href="#objectives" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Gain experience working with different vector data types using shapely</p></li>
<li><p>Use geopandas to re-project vector datasets from one coordinate
reference system to another</p></li>
<li><p>Learn about and used <strong>vectorized</strong> operations</p></li>
<li><p>Summarize features using the groupby method of a GeoDataFrame</p></li>
<li><p>Learn how to perform different vector data operations using geopandas
and shapely</p></li>
</ul>
</section>
<section id="data-provided">
<h3>data provided<a class="headerlink" href="#data-provided" title="Permalink to this heading">#</a></h3>
<p>In the data_files folder, you should have the following:</p>
<ul class="simple">
<li><p><strong>NI_roads.shp</strong>, a shapefile of roads in Northern Ireland</p></li>
<li><p><strong>Counties.shp</strong>, a shapefile of county outlines for Northern Ireland</p></li>
<li><p><strong>NI_Wards.shp</strong>, a shapefile of electoral wards for Northern Ireland</p></li>
</ul>
</section>
<section id="id1">
<h3>getting started<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p>In this practical, we’ll be working with vector data. As a quick
refresher, the three main types of vector data that we will work with
are:</p>
<ul class="simple">
<li><p><strong>Point</strong>: point data represent a single point in space. For our
purposes, points are either two-dimensional (x, y) or
three-dimensional (x, y, z). In <code class="docutils literal notranslate"><span class="pre">shapely</span></code>, the corresponding
<strong>class</strong> of data is a <strong>Point</strong>.</p></li>
<li><p><strong>Line</strong>: lines are a sequence of at least two points that are joined
together. In <code class="docutils literal notranslate"><span class="pre">shapely</span></code>, the corresponding <strong>class</strong> of data is known
as a <strong>LineString</strong>.</p></li>
<li><p><strong>Polygon</strong>: polygons are a sequence of at least three points that are
connected to form a <strong>ring</strong>, as well as any additional rings that
represent holes in the polygon. In <code class="docutils literal notranslate"><span class="pre">shapely</span></code>, the corresponding
<strong>class</strong> of data is a <strong>Polygon</strong>.</p></li>
</ul>
<p>We can also have <strong>Collections</strong> of vector data, where each feature
represents a collection of <strong>Point</strong>, <strong>Line</strong>, or <strong>Polygon</strong> objects.
In <code class="docutils literal notranslate"><span class="pre">shapely</span></code>, these are represented as <strong>MultiPoint</strong>,
<strong>MultiLineString</strong>, or <strong>MultiPolygon</strong> objects.</p>
<p>To get started, run the following cell to import <code class="docutils literal notranslate"><span class="pre">geopandas</span></code> and
<code class="docutils literal notranslate"><span class="pre">shapely</span></code>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this lets us show the figures, but not interactively</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Point</span><span class="p">,</span> <span class="n">LineString</span><span class="p">,</span> <span class="n">Polygon</span>
</pre></div>
</div>
</section>
<section id="shapely-geometry-types">
<h3>shapely geometry types<a class="headerlink" href="#shapely-geometry-types" title="Permalink to this heading">#</a></h3>
<section id="points">
<h4>Points<a class="headerlink" href="#points" title="Permalink to this heading">#</a></h4>
<p>As we saw in Week 1, to create a <strong>Point</strong>, we pass x, y (and
optionally, z) coordinates to the <strong>Point</strong> class constructor
(<a class="reference external" href="https://shapely.readthedocs.io/en/stable/reference/shapely.Point.html">documentation</a>):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pt</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mf">6.677</span><span class="p">,</span> <span class="mf">55.150</span><span class="p">)</span> <span class="c1"># creates a 2d point with coordinates -6.677, 55.150</span>
<span class="n">pt2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mf">6.658</span><span class="p">,</span> <span class="mf">55.213</span><span class="p">)</span> <span class="c1"># creates a 2d point with coordinates -6.658, 55.213</span>

<span class="n">pt3d</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mf">86.925278</span><span class="p">,</span> <span class="mf">27.988056</span><span class="p">,</span> <span class="mf">8848.86</span><span class="p">)</span> <span class="c1"># creates a 3d point</span>

<span class="nb">print</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="c1"># print a well-known text (WKT) representation of the Point object</span>
</pre></div>
</div>
<p>The last line, <code class="docutils literal notranslate"><span class="pre">print(pt)</span></code>, prints a
<a class="reference external" href="https://en.wikipedia.org/wiki/Well-known_text_representation_of_geometry">well-known-text</a>
(WKT) representation of the <strong>Point</strong> object. WKT is a standard
representation of vector geometry objects - most <code class="docutils literal notranslate"><span class="pre">python</span></code> libraries
and GIS softwares are able to read and/or translate WKT into other
formats, such as ESRI Shapefiles, GeoJSON, etc.</p>
<p>Remember that in python, we can find the attributes and methods for an
object by looking up the documentation (for shapely, this can be found
<a class="reference external" href="https://shapely.readthedocs.io/en/stable/manual.html">here</a>), or
using the built-in function <code class="docutils literal notranslate"><span class="pre">dir()</span></code>. To find out more about a
particular function, we can use the built-in function <code class="docutils literal notranslate"><span class="pre">help()</span></code> (or, in
jupyter notebooks/ipython, the <code class="docutils literal notranslate"><span class="pre">?</span></code> operator).</p>
<p>As an example, let’s use the built-in function <code class="docutils literal notranslate"><span class="pre">dir()</span></code> to look at the
methods and attributes associated with the <strong>Point</strong> class:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">dir</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="c1"># show the attributes and methods associated with the pt object</span>
</pre></div>
</div>
<p>Here, in addition to the <strong>special</strong> or <strong>magic</strong> methods (denoted with
two underscores, __, at the beginning and end of the method name),
there are a number of methods that we might find useful, including
<code class="docutils literal notranslate"><span class="pre">.distance()</span></code>.</p>
<p>To see what this method does, we can use <code class="docutils literal notranslate"><span class="pre">help(Point.distance)</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">distance</span><span class="p">)</span>
</pre></div>
</div>
<p>So, <code class="docutils literal notranslate"><span class="pre">.distance()</span></code> provides the distance from the <strong>Point</strong> object to
some other geometry. Because <code class="docutils literal notranslate"><span class="pre">shapely</span></code> does not directly deal with
coordinate systems, this distance is <strong>unitless</strong>. This means that <strong>we
have to make sure that the two objects have the same reference system -
if we do not, the distance returned will not make sense.</strong> Don’t worry,
we will cover working with coordinate reference systems later on in this
exercise.</p>
<p>Use the cell below, along with the output of dir(pt) above, to work out
how we can access the x, y coordinates of a Point object. Can you see
more than one way to do this? If so, are there differences between them?</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># write your method to access the x,y coordinates of pt here</span>
</pre></div>
</div>
<p>One of the common operations we might want to do with a <strong>Point</strong> object
is to create a <strong>buffer</strong> around the point. In the list of associated
methods and attributes of Point objects above, you should see there is a
method called <code class="docutils literal notranslate"><span class="pre">.buffer()</span></code>.</p>
<p>A look at the help for this method:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span> <span class="c1"># show the help for pt.buffer</span>
</pre></div>
</div>
<p>shows that <code class="docutils literal notranslate"><span class="pre">buffer</span></code> takes a <strong>positional parameter</strong> of <em>distance</em>, as
well as a number of <strong>keyword parameters</strong> that determine how the buffer
operation is done. Remember that the buffer distance will be in the same
coordinate system as our point - <code class="docutils literal notranslate"><span class="pre">shapely</span></code> does not, by itself, do any
conversion between coordinate systems or units.</p>
<p>Note that the object returned by buffer is a <strong>Polygon</strong>, rather than a
point - this makes sense, as the buffer is a two-dimensional surface
around the point location:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pt_buffer</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span> <span class="c1"># buffer the point by 0.001 in the same coordinates</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">pt_buffer</span><span class="p">))</span> <span class="c1"># show the type of the buffer</span>
</pre></div>
</div>
</section>
<section id="linestrings">
<h4>LineStrings<a class="headerlink" href="#linestrings" title="Permalink to this heading">#</a></h4>
<p>Instead of using a single x, y coordinate pair, a <strong>LineString</strong> object
(<a class="reference external" href="https://shapely.readthedocs.io/en/stable/reference/shapely.LineString.html">documentation</a>)
takes either a list of <strong>Point</strong> objects, or a list of coordinate
<strong>tuples</strong>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">line1</span> <span class="o">=</span> <span class="n">LineString</span><span class="p">([</span><span class="n">pt</span><span class="p">,</span> <span class="n">pt2</span><span class="p">])</span> <span class="c1"># method one of creating a LineString, using a list of Point objects</span>
<span class="n">line2</span> <span class="o">=</span> <span class="n">LineString</span><span class="p">([(</span><span class="o">-</span><span class="mf">6.677</span><span class="p">,</span> <span class="mf">55.150</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">6.658</span><span class="p">,</span> <span class="mf">55.213</span><span class="p">)])</span> <span class="c1"># method two, using a list of coordinate tuples</span>

<span class="nb">print</span><span class="p">(</span><span class="n">line1</span><span class="p">)</span> <span class="c1"># show the first line</span>
<span class="nb">print</span><span class="p">(</span><span class="n">line2</span><span class="p">)</span> <span class="c1"># show the second line</span>
</pre></div>
</div>
<p>As we can see from the output above, these two <strong>LineString</strong>s have
the same coordinates. We can also use the <code class="docutils literal notranslate"><span class="pre">.equals()</span></code> method to check
that the two objects are the same geometry:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">line1</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">line2</span><span class="p">)</span> <span class="c1"># check to see if these are the same geometry</span>
</pre></div>
</div>
<p>The coordinates of a <strong>LineString</strong> are stored as a <strong>tuple</strong> in an
attribute called <strong>xy</strong>. The <strong>tuple</strong> has two items representing the X
and Y coordinate values. If we want the x and y coordinates as separate
variables, we can access them using their respective indices:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">x</span> <span class="o">=</span> <span class="n">line1</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">y</span> <span class="o">=</span> <span class="n">line1</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>We can also combine this using <strong>tuple assignment</strong>, or <strong>unpacking</strong>,
which assigns values from a <strong>tuple</strong> on the right-hand side of the
assignment to a comma-separated grouping of variables on the left-hand
side:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">line1</span><span class="o">.</span><span class="n">xy</span>

<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>LineString</strong> objects have a number of the same methods that <strong>Point</strong>
objects do, including <code class="docutils literal notranslate"><span class="pre">.buffer()</span></code> and <code class="docutils literal notranslate"><span class="pre">.distance()</span></code>.</p>
<p><strong>LineString</strong> objects also have a <code class="docutils literal notranslate"><span class="pre">.length</span></code> attribute (just like with
<code class="docutils literal notranslate"><span class="pre">.distance()</span></code>, it is <strong>unitless</strong>):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">line1</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>LineString</strong> objects have a <code class="docutils literal notranslate"><span class="pre">.centroid</span></code> attribute, corresponding to
the midpoint of the <strong>LineString</strong>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">center</span> <span class="o">=</span> <span class="n">line1</span><span class="o">.</span><span class="n">centroid</span> <span class="c1"># get the midpoint of the line</span>
<span class="nb">print</span><span class="p">(</span><span class="n">center</span><span class="p">)</span>
</pre></div>
</div>
<p>The last two methods of <strong>LineString</strong> objects that we will explore for
now are <code class="docutils literal notranslate"><span class="pre">.project()</span></code> and <code class="docutils literal notranslate"><span class="pre">.interpolate()</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">line1</span><span class="o">.</span><span class="n">project</span><span class="p">)</span>
</pre></div>
</div>
<p>So <code class="docutils literal notranslate"><span class="pre">.project()</span></code> returns the distance along the <strong>LineString</strong> that
comes closest to the <strong>Point</strong> (or other geometry object).</p>
<p><code class="docutils literal notranslate"><span class="pre">.interpolate()</span></code>, on the other hand, does something a bit different:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">line1</span><span class="o">.</span><span class="n">interpolate</span><span class="p">)</span>
</pre></div>
</div>
<p>it returns the point along the line at a specified distance; the
distance can be in the units of the <strong>LineString</strong>’s coordinates
(<code class="docutils literal notranslate"><span class="pre">normalized=False</span></code>), or it can be as a fraction of the total length
of the <strong>LineString</strong> (<code class="docutils literal notranslate"><span class="pre">normalized=True</span></code>).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">line1</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">center</span><span class="p">)</span> <span class="o">/</span> <span class="n">line1</span><span class="o">.</span><span class="n">length</span> <span class="c1"># check to see how far along the line our centerpoint is</span>

<span class="nb">print</span><span class="p">(</span><span class="n">center</span><span class="p">)</span> <span class="c1"># print the WKT representation of the center point</span>
<span class="nb">print</span><span class="p">(</span><span class="n">line1</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="c1"># print the WKT representation of the point 50% along the line</span>
</pre></div>
</div>
</section>
<section id="polygons">
<h4>Polygons<a class="headerlink" href="#polygons" title="Permalink to this heading">#</a></h4>
<p>The last basic geometry type we will look at in this practical are
<strong>Polygon</strong> objects. Similar to <strong>LineString</strong> objects, we can construct
a <strong>Polygon</strong> object
(<a class="reference external" href="https://shapely.readthedocs.io/en/stable/reference/shapely.Polygon.html">documentation</a>)
using a list of coordinate pairs, or a list of <strong>Point</strong> objects:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poly1</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">([(</span><span class="o">-</span><span class="mf">6.677</span><span class="p">,</span> <span class="mf">55.150</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">6.658</span><span class="p">,</span> <span class="mf">55.213</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">6.722</span><span class="p">,</span> <span class="mf">55.189</span><span class="p">)])</span>
<span class="n">poly2</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">([</span><span class="n">pt</span><span class="p">,</span> <span class="n">pt2</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span><span class="o">-</span><span class="mf">6.722</span><span class="p">,</span> <span class="mf">55.189</span><span class="p">)])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">poly1</span><span class="p">)</span> <span class="c1"># print a wkt representation of the polygon</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly2</span><span class="p">)</span>
</pre></div>
</div>
<p>and, just like we saw with <strong>LineString</strong> objects, we can use
<code class="docutils literal notranslate"><span class="pre">.equals()</span></code> to check that these two geometries are the same:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poly1</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">poly2</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that even though we only passed three <strong>Point</strong> objects (or
coordinate pairs) to the <strong>Polygon</strong> constructor, the <strong>Polygon</strong> has
four vertices, with the first and last vertex being the same - this is
because the <strong>Polygon</strong> exterior is <em>closed</em>.</p>
<p>Note also the double parentheses - this is because a <strong>Polygon</strong>
potentially has two sets of coordinates - the <em>Shell</em>, or <em>exterior</em>,
and <em>holes</em>, or <em>interiors</em>. To create a <strong>Polygon</strong> with a hole in it,
we can pass a list of coordinates that describe the <code class="docutils literal notranslate"><span class="pre">shell</span></code>, and a
second that describes the <code class="docutils literal notranslate"><span class="pre">holes</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">polygon_with_hole</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">shell</span><span class="o">=</span><span class="p">[(</span><span class="o">-</span><span class="mf">6.677</span><span class="p">,</span> <span class="mf">55.150</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">6.658</span><span class="p">,</span> <span class="mf">55.213</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">6.722</span><span class="p">,</span> <span class="mf">55.189</span><span class="p">)],</span>
                            <span class="n">holes</span><span class="o">=</span><span class="p">[[(</span><span class="o">-</span><span class="mf">6.684</span><span class="p">,</span> <span class="mf">55.168</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">6.704</span><span class="p">,</span> <span class="mf">55.187</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">6.672</span><span class="p">,</span> <span class="mf">55.196</span><span class="p">)]])</span> <span class="c1"># note the double brackets</span>

<span class="nb">print</span><span class="p">(</span><span class="n">polygon_with_hole</span><span class="p">)</span>
</pre></div>
</div>
<p>And, within a jupyter notebook, we can even see what a<code class="docutils literal notranslate"><span class="pre">shapely</span></code>
geometry looks like by running a cell with the name of the object:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">polygon_with_hole</span> <span class="c1"># displays the geometry object within the notebook</span>
</pre></div>
</div>
<p>Note the double brackets in the <code class="docutils literal notranslate"><span class="pre">holes</span></code> keyword argument:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">holes</span><span class="o">=</span><span class="p">[[(</span><span class="o">-</span><span class="mf">6.684</span><span class="p">,</span> <span class="mf">55.168</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">6.704</span><span class="p">,</span> <span class="mf">55.187</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">6.672</span><span class="p">,</span> <span class="mf">55.196</span><span class="p">)]]</span>
</pre></div>
</div>
<p>This is necessary, because <code class="docutils literal notranslate"><span class="pre">holes</span></code> is expecting a sequence of
coordinate sequences - effectively, a list of <strong>Polygon</strong> shells.</p>
<p>Accessing the coordinates of a <strong>Polygon</strong> object is a little more
complicated than it is for <strong>Point</strong> and <strong>LineString</strong> objects - this
is because <strong>Polygon</strong> objects have two sets of coordinates, the
<code class="docutils literal notranslate"><span class="pre">.exterior</span></code> (<em>shell</em>) and <code class="docutils literal notranslate"><span class="pre">.interiors</span></code> (<em>holes</em>).</p>
<p>But, the <code class="docutils literal notranslate"><span class="pre">.exterior</span></code> attribute of the <strong>Polygon</strong> is just a
<strong>LinearRing</strong> (a special case of <strong>LineString</strong> where the first and
last coordinates are the same), and the <code class="docutils literal notranslate"><span class="pre">.interiors</span></code> attribute is an
<strong>InteriorRingSequence</strong> (basically, a collection of <strong>LinearRing</strong>s
that have to obey <a class="reference external" href="https://shapely.readthedocs.io/en/stable/manual.html#polygons">additional
rules</a>):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">polygon_with_hole</span><span class="o">.</span><span class="n">exterior</span><span class="p">)</span> <span class="c1"># this is a single LinearRing</span>
<span class="k">for</span> <span class="n">lr</span> <span class="ow">in</span> <span class="n">polygon_with_hole</span><span class="o">.</span><span class="n">interiors</span><span class="p">:</span> <span class="c1"># this is potentially multiple LinearRing objects</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">lr</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Polygon</strong> objects have nonzero <code class="docutils literal notranslate"><span class="pre">.area</span></code> and non-zero <code class="docutils literal notranslate"><span class="pre">.length</span></code>
(perimeter) attributes - as with the equivalent attributes for <strong>Point</strong>
and <strong>LineString</strong> objects, these are <em>unitless</em>.</p>
<p><strong>Polygon</strong> objects also have a <code class="docutils literal notranslate"><span class="pre">.centroid</span></code> (center), and we can bound
the geometry using <em>either</em> the minimum bounding box parallel to the
coordinate axes (the <code class="docutils literal notranslate"><span class="pre">.envelope</span></code> attribute), or a rotated minimum
bounding box (the <code class="docutils literal notranslate"><span class="pre">.minimum_rotated_rectangle</span></code> attribute):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;perimeter: &#39;</span><span class="p">,</span> <span class="n">poly1</span><span class="o">.</span><span class="n">length</span><span class="p">)</span> <span class="c1"># print the perimeter</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;area: &#39;</span><span class="p">,</span> <span class="n">poly1</span><span class="o">.</span><span class="n">area</span><span class="p">)</span> <span class="c1"># print the area</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;centroid: &#39;</span><span class="p">,</span> <span class="n">poly1</span><span class="o">.</span><span class="n">centroid</span><span class="p">)</span> <span class="c1"># get the centerpoint of the rectangle</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;bounding coordinates: &#39;</span><span class="p">,</span> <span class="n">poly1</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span> <span class="c1"># get the minimum x, minimum y, maximum x, maximum y coordinates</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;bounding box: &#39;</span><span class="p">,</span> <span class="n">poly1</span><span class="o">.</span><span class="n">envelope</span><span class="p">)</span> <span class="c1"># get the minimum bounding rectangle of the polygon, parallel to the coordinate axes</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rotated bounding box: &#39;</span><span class="p">,</span> <span class="n">poly1</span><span class="o">.</span><span class="n">minimum_rotated_rectangle</span><span class="p">)</span> <span class="c1"># get the smallest possible rectangle that covers the polygon</span>
</pre></div>
</div>
<p>There are a number of additional methods that we will cover more as we
continue through the practicals - for now, this should be enough to give
an idea for how these geometry objects work.</p>
</section>
</section>
<section id="interactions-between-geometry-objects">
<h3>interactions between geometry objects<a class="headerlink" href="#interactions-between-geometry-objects" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">shapely</span></code> also provides a number of methods that we can use to check
the spatial relationship between different objects. For example, the
following code shows how we can use the <code class="docutils literal notranslate"><span class="pre">.contains()</span></code> method
(<a class="reference external" href="https://shapely.readthedocs.io/en/stable/manual.html#object.contains">documentation</a>)
of a shapely geometry object to see whether another geometry object is
located fully within the object:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">poly</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="n">pt1</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">pt2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pt1</span><span class="p">))</span> <span class="c1"># should return False, because pt1 is not within the polygon</span>
<span class="nb">print</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pt2</span><span class="p">))</span> <span class="c1"># should return True, because pt2 is within the polygon</span>
</pre></div>
</div>
<p>We can also check to see whether two geometry objects intersect each
other using the <code class="docutils literal notranslate"><span class="pre">.intersects()</span></code> method
(<a class="reference external" href="https://shapely.readthedocs.io/en/stable/manual.html#object.intersects">documentation</a>):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">line1</span> <span class="o">=</span> <span class="n">LineString</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="n">line2</span> <span class="o">=</span> <span class="n">LineString</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">line1</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">line2</span><span class="p">))</span> <span class="c1"># intersects() returns True if the geometries touch/intersect/overlap, False otherwise</span>
</pre></div>
</div>
<p>To actually get the intersection of the two geometries, we use the
<code class="docutils literal notranslate"><span class="pre">.intersection()</span></code> method, which returns the geometry of the
intersection (whether this is a <strong>Point</strong>, a <strong>LineString</strong>, a
<strong>Polygon</strong>, or a mixed collection of geometries depends on the
geometries and how they intersect):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">line1</span> <span class="o">=</span> <span class="n">LineString</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="n">line2</span> <span class="o">=</span> <span class="n">LineString</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">line1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">line2</span><span class="p">))</span> <span class="c1"># if the lines intersect, this will be the Point(s) of intersection</span>
<span class="nb">print</span><span class="p">(</span><span class="n">line1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">poly</span><span class="p">))</span> <span class="c1"># if the line intersects a polygon, the result may be a line or a point</span>
</pre></div>
</div>
<p>There are a number of other methods provided by <code class="docutils literal notranslate"><span class="pre">shapely</span></code> that we can
use to determine the relationship between geometry objects, including
<code class="docutils literal notranslate"><span class="pre">touches</span></code>, <code class="docutils literal notranslate"><span class="pre">within</span></code>, and <code class="docutils literal notranslate"><span class="pre">overlaps</span></code>. Be sure to have a look at the
full list from the <a class="reference external" href="https://shapely.readthedocs.io/en/stable/manual.html">shapely user
manual</a> to see
the rest.</p>
</section>
<section id="geopandas-geodataframes">
<h3>geopandas GeoDataFrames<a class="headerlink" href="#geopandas-geodataframes" title="Permalink to this heading">#</a></h3>
<p>We have used <code class="docutils literal notranslate"><span class="pre">geopandas</span></code> in the previous two practicals to read
provided shapefiles and work with the data they contain - in Practical
1, we translated a comma-separated variable (CSV) file into a shapefile,
and in Practical 2, we read shapefile data and plotted it on a map using
<code class="docutils literal notranslate"><span class="pre">cartopy</span></code>.</p>
<p>This week, we will extend this introduction to look at how we can use
<code class="docutils literal notranslate"><span class="pre">geopandas</span></code> to do various GIS analyses, such as spatial joins and
clipping operations, as well as projecting from one coordinate reference
system to another.</p>
<p>To begin, we’ll load the <strong>NI_roads</strong> dataset from the data_files folder
and use <code class="docutils literal notranslate"><span class="pre">.head()</span></code>
(<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.head.html">documentation</a>)
to show the first 5 rows of the <strong>GeoDataFrame</strong>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roads</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;data_files/NI_roads.shp&#39;</span><span class="p">)</span>

<span class="n">roads</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1"># show the first five rows of the table</span>
</pre></div>
</div>
<p>So this dataset has three columns: <strong>SURVEY</strong>, <strong>Road_class</strong>, and
<strong>geometry</strong>.</p>
<p>Note that each of the geometries is a <strong>LineString</strong> object, which means
that we are working with line geometries. Hopefully, given that the data
are supposed to represent roads, this makes sense.</p>
<section id="coordinate-reference-systems-using-proj">
<h4>coordinate reference systems using PROJ<a class="headerlink" href="#coordinate-reference-systems-using-proj" title="Permalink to this heading">#</a></h4>
<p>To start with, let’s see if we can figure out how many kilometers of
motorway are represented in the dataset - i.e., the sum of the length of
all of the <strong>LineString</strong> objects that have the attribute <code class="docutils literal notranslate"><span class="pre">MOTORWAY</span></code>.</p>
<p>First, though, let’s check what the coordinate reference system (CRS) of
our <strong>GeoDataFrame</strong> is, using the <code class="docutils literal notranslate"><span class="pre">crs</span></code> attribute:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roads</span><span class="o">.</span><span class="n">crs</span>
</pre></div>
</div>
<p>So this dataset has a <em>Geographic</em> coordinate reference system,
<strong>EPSG:4326</strong>. EPSG codes (originally organized by the European
Petroleum Survey Group) are a common way of working with coordinate
reference systems. Each CRS in the <a class="reference external" href="https://epsg.org/home.html">EPSG
registry</a> has a unique code and standard
well-known text representation.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">crs</span></code> attribute of the <strong>GeoDataFrame</strong> is actually a
<strong>pyproj.CRS</strong> object
(<a class="reference external" href="https://pyproj4.github.io/pyproj/stable/api/crs/crs.html">documentation</a>).
<a class="reference external" href="https://pyproj4.github.io/pyproj/stable/">pyproj</a> is a python
interface to the <a class="reference external" href="https://proj.org/">PROJ</a> library, which is a
software for transforming geospatial coordinates from one CRS to
another.</p>
<p>Each <strong>pyproj.CRS</strong> object provides a number of methods for converting
to different formats, including well-known text, EPSG codes, JavaScript
Object Notation (JSON), and PROJ string (i.e.,
<code class="docutils literal notranslate"><span class="pre">'+proj=longlat</span> <span class="pre">+datum=WGS84</span> <span class="pre">+no_defs</span> <span class="pre">+type=crs'</span></code>).</p>
<p>For example, to see the JSON representation of the CRS, we would use the
<code class="docutils literal notranslate"><span class="pre">.to_json()</span></code> method
(<a class="reference external" href="https://pyproj4.github.io/pyproj/stable/api/crs/crs.html#pyproj.crs.CRS.to_json">documentation</a>):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roads</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span> <span class="c1"># show the representation of the CRS in JSON format</span>
</pre></div>
</div>
<p>Because this is a <em>Geographic</em> CRS, the length information provided by
<code class="docutils literal notranslate"><span class="pre">.length</span></code> will also be in geographic units, which doesn’t really make
sense for us. This means that we first have to convert the
<strong>GeoDataFrame</strong> to a <em>projected</em> CRS.</p>
<p>To do this, we can use the method <code class="docutils literal notranslate"><span class="pre">to_crs()</span></code>
(<a class="reference external" href="https://geopandas.org/en/stable/docs/reference/api/geopandas.GeoDataFrame.to_crs.html">documentation</a>):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">roads</span><span class="o">.</span><span class="n">to_crs</span><span class="p">)</span> <span class="c1"># show the help for the .to_crs() method</span>
</pre></div>
</div>
<p>So, to transform the <strong>GeoDataFrame</strong> to a different CRS, we have to
provide either a CRS object or an EPSG code. We can also choose to do
this <em>in place</em> (<code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>), or assign the output to a new
<strong>GeoDataFrame</strong> object (<code class="docutils literal notranslate"><span class="pre">inplace=False</span></code>, the default). Let’s
transform the <strong>GeoDataFrame</strong> to the Irish Transverse Mercator CRS, and
assign the output to a new object called <strong>roads_itm</strong>.</p>
<p>Rather than trying to find the correct JSON or PROJ representation of
this CRS, we can instead use the EPSG code, which can be easier to work
with.</p>
<p>Using the search function on the <a class="reference external" href="https://epsg.org/search/by-name">EPSG
registry</a>, or using an internet
search, look up the EPSG code for the Irish Transverse Mercator CRS and
enter it in the method call below:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roads_itm</span> <span class="o">=</span> <span class="n">roads</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="n">XX</span><span class="p">)</span> <span class="c1"># replace XX with the correct EPSG code for Irish Transverse Mercator</span>

<span class="n">roads_itm</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p>Note that only the <strong>geometry</strong> column has changed - instead of
geographic coordinates (e.g., (-6.21243, 54.48706)), the points in each
<strong>LineString</strong> should be in a projected CRS (e.g., (715821.764,
861315.722)). Now, when we access the <code class="docutils literal notranslate"><span class="pre">.length</span></code> attributes of each
<strong>LineString</strong> object, the units will be in the same units as our CRS
(meters).</p>
</section>
<section id="vector-operations-and-summarizing-data-using-geopandas">
<h4>vector operations and summarizing data using geopandas<a class="headerlink" href="#vector-operations-and-summarizing-data-using-geopandas" title="Permalink to this heading">#</a></h4>
<p>So that’s the first part of our problem solved - our coordinates are in
meters, and the lengths will be as well. The next step is to select all
of the features that correspond to Motorways and sum the lengths. We saw
an example of this in Practical 1 - we can slice the <strong>GeoDataFrame</strong>
with a conditional statement (<code class="docutils literal notranslate"><span class="pre">'Road_class'</span> <span class="pre">==</span> <span class="pre">'MOTORWAY'</span></code>) to select
only those rows where the road type is <code class="docutils literal notranslate"><span class="pre">MOTORWAY</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roads_itm</span><span class="p">[</span><span class="n">roads_itm</span><span class="p">[</span><span class="s1">&#39;Road_class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MOTORWAY&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>But first, we might want to add a column to our <strong>GeoDataFrame</strong> that
contains the <code class="docutils literal notranslate"><span class="pre">.length</span></code> of each of the features in kilometers.</p>
<p>Now, it is possible to do this using a loop and the <code class="docutils literal notranslate"><span class="pre">.iterrows()</span></code>
(<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.iterrows.html">documentation</a>)
method - this might look something like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">roads_itm</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span> <span class="c1"># iterate over each row in the GeoDataFrame</span>
    <span class="n">roads_itm</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="s1">&#39;Length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="mi">1000</span> <span class="c1"># assign the row&#39;s geometry length to a new column, Length, by dividing the geometry length by 1000</span>
</pre></div>
</div>
<p>In fact, we will see examples of using both <code class="docutils literal notranslate"><span class="pre">.iterrows()</span></code> and
<code class="docutils literal notranslate"><span class="pre">.itertuples()</span></code>
(<a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.itertuples.html">documentation</a>)
later on.</p>
<p>But, we can also use a <strong>vectorized</strong> operation to achieve the same
goal. In computing, a <a class="reference external" href="https://en.wikipedia.org/wiki/Array_programming">vectorized
operation</a> is an
operation that allows us to work on an entire squence of values (a
“vector” or “array”), rather than having to work on individual
(“scalar”) values within a loop. Oftentimes, this enables us to write
clearer code, and depending on the language and the operation, it can
even run much faster than an equivalent loop construct.</p>
<p>A number of packages in python, including <code class="docutils literal notranslate"><span class="pre">pandas</span></code> (and, by
inheritance, <code class="docutils literal notranslate"><span class="pre">geopandas</span></code>), support vectorized operations. Let’s see
how this works.</p>
<p>First, we can see that the <strong>geometry</strong> column of our <strong>GeoDataFrame</strong>
is an object of type <strong>GeoSeries</strong>
(<a class="reference external" href="https://geopandas.org/en/stable/docs/reference/api/geopandas.GeoSeries.html">documentation</a>)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">roads_itm</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>A <strong>GeoSeries</strong> has an attribute, <code class="docutils literal notranslate"><span class="pre">.length</span></code>
(<a class="reference external" href="https://geopandas.org/en/stable/docs/reference/api/geopandas.GeoSeries.length.html">documentation</a>),
which provides the length of each geometry in the <strong>GeoSeries</strong>, in the
units of the <strong>GeoSeries</strong>’ CRS:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roads_itm</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">length</span> <span class="c1"># show the length of each geometry in the geodataframe</span>
</pre></div>
</div>
<p>To illustrate how much faster vectorized operations can be, let’s
compare the <code class="docutils literal notranslate"><span class="pre">for</span></code> loop shown above with a vectorized operation, to see
whether there is a speed difference between the two options.</p>
<p>First, we’ll wrap each of these operations in a function to make it
easier to time the results:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># wrap the for loop in a function to make it easier to use with %timeit</span>
<span class="k">def</span> <span class="nf">iterrate_length</span><span class="p">(</span><span class="n">gdf</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">gdf</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">row</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="mi">1000</span>

<span class="c1"># wrap the vector operation in a function to make it easier to use with %timeit</span>
<span class="k">def</span> <span class="nf">vector_length</span><span class="p">(</span><span class="n">gdf</span><span class="p">):</span>
    <span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="mi">1000</span>
</pre></div>
</div>
<p>Next, we’ll use the <code class="docutils literal notranslate"><span class="pre">%timeit</span></code> <a class="reference external" href="https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-timeit">magic
command</a>
to compare the speed of these different operations. First, we’ll use
<code class="docutils literal notranslate"><span class="pre">%timeit</span></code> to calculate the average of iterating over the dataframe
using <code class="docutils literal notranslate"><span class="pre">.iterrows()</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> iterrate_length(roads_itm)
</pre></div>
</div>
<p>Next, we’ll use <code class="docutils literal notranslate"><span class="pre">%timeit</span></code> to calculate the average of using the
equivalent vector operation:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> vector_length(roads_itm)
</pre></div>
</div>
<p>My results show that <code class="docutils literal notranslate"><span class="pre">.iterrows()</span></code> took an average of ~400 ms
(milliseconds, or 10-3 seconds) over 7 runs, while the vector operation
took an average of ~500 µs (microseconds, or 10-6 seconds) over 7 runs -
a difference of about 3 orders of magnitude.</p>
<p>Your results may differ slightly, but they should be fairly similar.
While the difference between ~400 ms and ~500 µs might not seem like
much, it can add up a lot over the course of a program (especially if
you’re working with large datasets).</p>
<p>Note that it’s not always possible to use vectorized operations, and
there are cases where it may be less advantageous to use them; most of
the time, however, it can help keep your code a bit tidier, and it might
mean that your code runs faster.</p>
<p>In the cell below, use a vector operation to write a line of code that
adds a <code class="docutils literal notranslate"><span class="pre">Length</span></code> column to the <strong>GeoDataFrame</strong>, calculated as the
length of each feature in kilometers:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code goes here!</span>
</pre></div>
</div>
<p>Finally, we can subset our <strong>GeoDataFrame</strong> to select only <code class="docutils literal notranslate"><span class="pre">MOTORWAY</span></code>
features, and sum their length using the <code class="docutils literal notranslate"><span class="pre">.sum()</span></code> method
(<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.sum.html">documentation</a>):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sum_roads</span> <span class="o">=</span> <span class="n">roads_itm</span><span class="p">[</span><span class="s1">&#39;Length&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">sum_motorway</span> <span class="o">=</span> <span class="n">roads_itm</span><span class="p">[</span><span class="n">roads_itm</span><span class="p">[</span><span class="s1">&#39;Road_class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MOTORWAY&#39;</span><span class="p">][</span><span class="s1">&#39;Length&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">sum_roads</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> total km of roads&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">sum_motorway</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> total km of motorway&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In the cell above, look at the <code class="docutils literal notranslate"><span class="pre">print</span></code> function argument:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">sum_motorway</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> total km of motorway&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, we are using a “<a class="reference external" href="https://docs.python.org/3/tutorial/inputoutput.html#tut-f-strings">formatted string
literal</a>”
(<strong>f-String</strong>) to insert the value of an object, <code class="docutils literal notranslate"><span class="pre">sum_motorway</span></code>, into
our <code class="docutils literal notranslate"><span class="pre">print()</span></code> statement. We saw this in the very first exercise in
Week 1, but there’s something added here: the <em>format specification</em>,
<code class="docutils literal notranslate"><span class="pre">:.2f</span></code>. Rather than printing the string in an unformatted way (which
would contain a lot of extra decimal places), we can tell the <code class="docutils literal notranslate"><span class="pre">format</span></code>
method to clean up the output using <code class="docutils literal notranslate"><span class="pre">:</span></code> and a <a class="reference external" href="https://docs.python.org/3.8/library/string.html#formatspec">format
specification</a>.
In this case, <code class="docutils literal notranslate"><span class="pre">.2f</span></code> tells python to format as a <strong>float</strong> (<code class="docutils literal notranslate"><span class="pre">f</span></code>),
with 2 places after the decimal.</p>
<p>Let’s say now that we want to find the sum of all of the different road
classes in our dataset. We could, of course, repeat the exercise above
for each of the different values of <strong>Road_class</strong>. But, <code class="docutils literal notranslate"><span class="pre">pandas</span></code> (and
by extension, <code class="docutils literal notranslate"><span class="pre">geopandas</span></code>) provides a nicer way to summarize data
based on certain properties: the <code class="docutils literal notranslate"><span class="pre">.groupby()</span></code> method
(<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html">documentation</a>).</p>
<p><code class="docutils literal notranslate"><span class="pre">.groupby()</span></code> returns an object (a <strong>DataFrameGroupBy</strong> object) that is
similar to a <strong>DataFrame</strong>, but that contains information about how the
data in the table is grouped; to see different properties of those
groups, we can use methods like <code class="docutils literal notranslate"><span class="pre">.mean()</span></code>, <code class="docutils literal notranslate"><span class="pre">.median()</span></code>, <code class="docutils literal notranslate"><span class="pre">.sum()</span></code>,
etc., exactly like we can on a <strong>DataFrame</strong>, <strong>GeoDataFrame</strong>, or
<strong>Series</strong> object.</p>
<p>If we want to summarize our dataset by <code class="docutils literal notranslate"><span class="pre">Road_class</span></code> and use <code class="docutils literal notranslate"><span class="pre">.sum()</span></code>
to find the total length of each type of roadway, then, it would like
this:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roads_itm</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Road_class&#39;</span><span class="p">])[</span><span class="s1">&#39;Length&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">.groupby()</span></code> returns a <strong>GeoDataFrame</strong>, which we can then index to
return a single column, <code class="docutils literal notranslate"><span class="pre">Length</span></code>. As this is a numeric column, we can
also use arithmetic on it to divide by a conversion factor, to convert
the length from meters to kilometers. The <code class="docutils literal notranslate"><span class="pre">.groupby()</span></code> method is a
very useful way to quickly summarize a <strong>DataFrame</strong> (or a
<strong>GeoDataFrame</strong> - remember that this is a <strong>child class</strong> of
<strong>DataFrame</strong>).</p>
</section>
</section>
<section id="spatial-data-operations-using-geopandas-and-shapely">
<h3>spatial data operations using geopandas and shapely<a class="headerlink" href="#spatial-data-operations-using-geopandas-and-shapely" title="Permalink to this heading">#</a></h3>
<p>Oftentimes in GIS analysis, we want to summarize our data spatially, as
well as thematically. In this section, we will be looking at two
examples of this kind of analysis: first, using a <a class="reference external" href="https://gisgeography.com/spatial-join/">spatial
join</a>, and second, using a
clipping operation.</p>
<p>Remember that the <code class="docutils literal notranslate"><span class="pre">shapely</span></code> geometry objects in the <strong>GeoDataFrame</strong>
don’t have any inherent information about the CRS of the object. This
means that in order to perform operations like a spatial join, we have
to first ensure that the two <strong>GeoDataFrame</strong> objects have the same CRS.
The cell below will load the Counties shapefile in the <strong>data_files</strong>
folder, and test whether the CRS of the <code class="docutils literal notranslate"><span class="pre">counties</span></code> <strong>GeoDataFrame</strong> is
the same as the CRS of the <code class="docutils literal notranslate"><span class="pre">roads_itm</span></code> <strong>GeoDataFrame</strong>.</p>
<p>If, when you first load the shapefile, the test below returns False,
write a line of code that will ensure that the test returns True.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">counties</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;data_files/Counties.shp&#39;</span><span class="p">)</span> <span class="c1"># load the Counties shapefile</span>
<span class="c1"># your line of code might go here.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">counties</span><span class="o">.</span><span class="n">crs</span> <span class="o">==</span> <span class="n">roads_itm</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span> <span class="c1"># test if the crs is the same for roads_itm and counties.</span>
</pre></div>
</div>
<p>Now that the two <strong>GeoDataFrame</strong> objects have the same CRS, we can
proceed with the spatial join using <code class="docutils literal notranslate"><span class="pre">gpd.sjoin()</span></code>
(<a class="reference external" href="https://geopandas.org/en/stable/docs/reference/api/geopandas.sjoin.html">documentation</a>):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">join</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">sjoin</span><span class="p">(</span><span class="n">counties</span><span class="p">,</span> <span class="n">roads_itm</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">lsuffix</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">rsuffix</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span> <span class="c1"># perform the spatial join</span>
<span class="n">join</span> <span class="c1"># show the joined table</span>
</pre></div>
</div>
<p>Now, we can see that our table has additional columns - we have the
unnamed <code class="docutils literal notranslate"><span class="pre">index</span></code>, <code class="docutils literal notranslate"><span class="pre">COUNTY_ID</span></code>, <code class="docutils literal notranslate"><span class="pre">CountyName</span></code>, <code class="docutils literal notranslate"><span class="pre">Area_SqKM</span></code>,
<code class="docutils literal notranslate"><span class="pre">OBJECTID</span></code>, and <code class="docutils literal notranslate"><span class="pre">geometry</span></code> from the <code class="docutils literal notranslate"><span class="pre">counties</span></code> <strong>GeoDataFrame</strong>,
and <code class="docutils literal notranslate"><span class="pre">index_right</span></code> (because the original column in <code class="docutils literal notranslate"><span class="pre">roads_itm</span></code> has
the same name as <code class="docutils literal notranslate"><span class="pre">index</span></code> in <code class="docutils literal notranslate"><span class="pre">counties</span></code>), <code class="docutils literal notranslate"><span class="pre">SURVEY</span></code>, <code class="docutils literal notranslate"><span class="pre">Road_class</span></code>,
and <code class="docutils literal notranslate"><span class="pre">Length</span></code> from the <code class="docutils literal notranslate"><span class="pre">roads_itm</span></code> <strong>GeoDataFrame</strong>.</p>
<p>Like we did with <code class="docutils literal notranslate"><span class="pre">roads_itm</span></code>, we can again summarize our new
<strong>GeoDataFrame</strong> using <code class="docutils literal notranslate"><span class="pre">.groupby()</span></code>; this time, we’ll use both the
<code class="docutils literal notranslate"><span class="pre">CountyName</span></code> and <code class="docutils literal notranslate"><span class="pre">Road_class</span></code> properties to see the total length of
roads by each county, and by the type of road:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">group_county_road</span> <span class="o">=</span> <span class="n">join</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;CountyName&#39;</span><span class="p">,</span> <span class="s1">&#39;Road_class&#39;</span><span class="p">])</span> <span class="c1"># group by county name, then road class</span>

<span class="n">group_county_road</span><span class="p">[</span><span class="s1">&#39;Length&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1"># show the total number of km for each category</span>
</pre></div>
</div>
<p>From this, we can quickly see that County Antrim has the most motorway
of any county in Northern Ireland (93.44 km), while County Tyrone has
the most “&lt; 4M Tarred” road surfaces by a factor of two (2809.43 km
vs. 1453.77 km for County Armagh).</p>
<p>One thing to keep in mind is that with a spatial join, any feature in
the “right” table that overlaps multiple features in the “left” table
will be, in effect, double-counted. We can confirm this by calculating
the total length of roads in the joined table and comparing it to the
total length of roads in the original dataset:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">join_total</span> <span class="o">=</span> <span class="n">join</span><span class="p">[</span><span class="s1">&#39;Length&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1"># find the total length of roads in the join GeoDataFrame</span>

<span class="c1"># check that the total length of roads is the same between both GeoDataFrames</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total length of roads from original file: </span><span class="si">{</span><span class="n">sum_roads</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total length of roads from spatial join: </span><span class="si">{</span><span class="n">join_total</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Absolute difference in road length: </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">sum_roads</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">join_total</span><span class="p">)</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1"> km&#39;</span><span class="p">)</span> <span class="c1"># calculate the absolute difference as a percentage</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Absolute difference in road length: </span><span class="si">{</span><span class="p">(</span><span class="mi">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">sum_roads</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">join_total</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">sum_roads</span><span class="p">)</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span> <span class="c1"># calculate the absolute difference as a percentage</span>
</pre></div>
</div>
<p>And indeed, we can see that the total length of roads in the spatial
join is ~300 km longer (1.42%) than the total length of roads in the
original dataset.</p>
<p>We can also see that we have double-counted features by comparing the
total number of road features in the <code class="docutils literal notranslate"><span class="pre">join</span></code> <strong>GeoDataFrame</strong> with the
number of unique road features, which we can find using a combination of
<code class="docutils literal notranslate"><span class="pre">len()</span></code>
(<a class="reference external" href="https://docs.python.org/3/library/functions.html#len">documentation</a>)
and <code class="docutils literal notranslate"><span class="pre">.unique()</span></code>
(<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.unique.html">documentation</a>):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">not_unique</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">join</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">join</span><span class="o">.</span><span class="n">index_right</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="c1"># get the difference between the number of objects in the table and the unique objects in the table</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;There are </span><span class="si">{</span><span class="n">not_unique</span><span class="si">}</span><span class="s1"> duplicated objects in the joined table.&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Obviously, we don’t want to double-count roads - to get around this, we
can use the <code class="docutils literal notranslate"><span class="pre">gpd.clip()</span></code> function
(<a class="reference external" href="https://geopandas.org/en/stable/docs/reference/api/geopandas.clip.html">documentation</a>)
to clip the features of <code class="docutils literal notranslate"><span class="pre">roads_itm</span></code> to each of the county boundaries
in the <code class="docutils literal notranslate"><span class="pre">counties</span></code> <strong>GeoDataFrame</strong>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">gpd</span><span class="o">.</span><span class="n">clip</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that we have to do this for each of county, because -
<code class="docutils literal notranslate"><span class="pre">gpd.clip()</span></code> will take the total boundary for the <strong>GeoDataFrame</strong> if
there are multiple <strong>Polygon</strong> objects.</p>
<p>Using a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop to loop over the <code class="docutils literal notranslate"><span class="pre">counties</span></code> <strong>GeoDataFrame</strong>,
then, we can clip <code class="docutils literal notranslate"><span class="pre">roads_itm</span></code> to each county:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clipped</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># initialize an empty list</span>
<span class="k">for</span> <span class="n">county</span> <span class="ow">in</span> <span class="n">counties</span><span class="p">[</span><span class="s1">&#39;CountyName&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span> <span class="c1"># iterate over unique values of county</span>
    <span class="n">tmp_clip</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">roads_itm</span><span class="p">,</span> <span class="n">counties</span><span class="p">[</span><span class="n">counties</span><span class="p">[</span><span class="s1">&#39;CountyName&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">county</span><span class="p">])</span> <span class="c1"># clip the roads by county border</span>
    <span class="n">tmp_clip</span><span class="p">[</span><span class="s1">&#39;Length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp_clip</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="mi">1000</span> <span class="c1"># remember to update the length for any clipped roads</span>
    <span class="n">tmp_clip</span><span class="p">[</span><span class="s1">&#39;CountyName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">county</span> <span class="c1"># set the county name for each road feature</span>

    <span class="n">clipped</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp_clip</span><span class="p">)</span> <span class="c1"># add the clipped GeoDataFrame to the list</span>
</pre></div>
</div>
<p>Note that this step will likely take some time, as we have to clip a
large number of features.</p>
<p>This creates a <strong>list</strong> of <strong>GeoDataFrame</strong> objects - one for each
unique value of <code class="docutils literal notranslate"><span class="pre">CountyName</span></code>. Now, we can use <code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code>
(<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html">documentation</a>)
to combine these into a single <strong>DataFrame</strong>, then use
<code class="docutils literal notranslate"><span class="pre">gpd.GeoDataFrame()</span></code> to convert this to a <strong>GeoDataFrame</strong>.</p>
<p>Note the use of <code class="docutils literal notranslate"><span class="pre">ignore_index=True</span></code> with <code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code> - this means
that <code class="docutils literal notranslate"><span class="pre">pandas</span></code> will assign each row in the combined <strong>DataFrame</strong> with
a new index, rather than keeping the original index. Because in this
case our index values only correspond to the row number, we don’t need
to keep track of this in the new table.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clipped_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">clipped</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="c1"># create a geodataframe from the combined county geodataframes</span>

<span class="n">clipped_gdf</span> <span class="c1"># show the new, combined geodataframe</span>
</pre></div>
</div>
<p>Now, we can compare the total length of the clipped roads with the total
length of roads from the original dataset:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pandas has a function, concat, which will combine (concatenate) a list of DataFrames (or GeoDataFrames)</span>
<span class="c1"># we can then create a GeoDataFrame from the combined DataFrame, as the combined DataFrame will have a geometry column.</span>
<span class="n">clip_total</span> <span class="o">=</span> <span class="n">clipped_gdf</span><span class="p">[</span><span class="s1">&#39;Length&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total length of roads from original file: </span><span class="si">{</span><span class="n">sum_roads</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> m&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total length of roads from clipped join: </span><span class="si">{</span><span class="n">clip_total</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> m&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Absolute difference in road length: </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">sum_roads</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">clip_total</span><span class="p">)</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1"> km&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Absolute difference in road length: </span><span class="si">{</span><span class="p">(</span><span class="mi">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">sum_roads</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">clip_total</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">sum_roads</span><span class="p">)</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>So we don’t have perfect overlap. This is because there isn’t perfect
overlap between the <code class="docutils literal notranslate"><span class="pre">counties</span></code> boundary and the <code class="docutils literal notranslate"><span class="pre">roads</span></code> features:
there are a number of places where the roads extend beyond the border of
Northern Ireland. One example of this is shown below:</p>
<a class="reference internal image-reference" href="../../../_images/road_extension.png"><img alt="one of the locations where the road shapefile extends beyond the boundaries of NI" class="align-center" src="../../../_images/road_extension.png" style="width: 720px;" /></a>
<p><br /> To fix this, we could first clip <code class="docutils literal notranslate"><span class="pre">roads_itm</span></code> to the entire
<code class="docutils literal notranslate"><span class="pre">counties</span></code> <strong>GeoDataFrame</strong>, which would eliminate these extraneous
stretches of road.</p>
<p>For now, though, agrement to within 0.01% is acceptable for our purposes
- much better than the 1.42% disagreement from the original spatial
join.</p>
<p>To wrap up, write a line or two of code in the cell below that will
summarize the <code class="docutils literal notranslate"><span class="pre">clipped_gdf</span></code> GeoDataFrame by county and road type.
Which county has the most Motorways? The most roads in total?</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code goes here!</span>
</pre></div>
</div>
</section>
<section id="exercise-and-next-steps">
<h3>exercise and next steps<a class="headerlink" href="#exercise-and-next-steps" title="Permalink to this heading">#</a></h3>
<p>Now that you’ve gained some experience working with <code class="docutils literal notranslate"><span class="pre">shapely</span></code> geometry
objects and <code class="docutils literal notranslate"><span class="pre">geopandas</span></code> <strong>GeoDataFrame</strong> objects, have a look at
<strong>exercise_script.py</strong> in this folder.</p>
<p>Using the topics covered in the Week 2 practical and this practical,
modify this script to do the following:</p>
<ol class="arabic simple">
<li><p>Load the counties and ward data</p></li>
<li><p>Using a spatial join, summarize the total population by county.
What county has the highest population? What about the lowest? Note that
there are many wards that extend over county boundaries; for the
purposes of this exercise, let’s ignore that small problem.</p></li>
<li><p>Create a map like the one below to show population information by census area,
with the county boundaries plotted overtop of the chloropleth map. Note
that you may need to re-use some of the code from the Week 2 cartopy
exercise in order to do this.</p></li>
</ol>
<a class="reference internal image-reference" href="../../../_images/sample_map.png"><img alt="the sample map to be produced in the exercise" class="align-center" src="../../../_images/sample_map.png" style="width: 600px;" /></a>
<section id="additional-exercise-questions">
<h4>additional exercise questions<a class="headerlink" href="#additional-exercise-questions" title="Permalink to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Are there any Wards that are located in more than one county? If so,
how many, and what is the total population of these Wards?</p></li>
<li><p>What Ward has the highest population? What about the lowest
population?</p></li>
<li><p>Repeat the exercise above using <strong>exercise_script.py</strong>, but this time
use the population density (in number of residents per square km).</p></li>
</ol>
</section>
</section>
</section>
<section id="next-steps">
<h2>next steps<a class="headerlink" href="#next-steps" title="Permalink to this heading">#</a></h2>
<p>Once you have finished the notebook and the exercise, make sure to send me an e-mail with some ideas for your coding
project. They do not have to be completely fleshed out, but you should try to have a general idea of what you would
like to work on for the final project – ideally, this will be something related to your work, or a potential MSc thesis
topic.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="conflicts.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">conflict resolution (using git)</p>
      </div>
    </a>
    <a class="right-next"
       href="folium.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">interactive maps with folium</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-started">getting started</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rachel-mcadams">Rachel McAdams</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">overview</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#objectives">objectives</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-provided">data provided</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">getting started</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shapely-geometry-types">shapely geometry types</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#points">Points</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#linestrings">LineStrings</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#polygons">Polygons</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interactions-between-geometry-objects">interactions between geometry objects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#geopandas-geodataframes">geopandas GeoDataFrames</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#coordinate-reference-systems-using-proj">coordinate reference systems using PROJ</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#vector-operations-and-summarizing-data-using-geopandas">vector operations and summarizing data using geopandas</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-data-operations-using-geopandas-and-shapely">spatial data operations using geopandas and shapely</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-and-next-steps">exercise and next steps</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-exercise-questions">additional exercise questions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#next-steps">next steps</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Bob McNabb
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, Bob McNabb. Licensed under Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0).
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>