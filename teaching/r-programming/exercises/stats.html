

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>basic statistical analysis using R &#8212; space cameras and glaciers</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" href="../../../_static/customstyle.css" type="text/css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'teaching/r-programming/exercises/stats';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="linear regression using R" href="regression.html" />
    <link rel="prev" title="transforming data" href="transform.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">space cameras and glaciers</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../whataboutbob.html">about me</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../index.html">teaching</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../../egm101/index.html">EGM101: skills toolbox</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../egm101/lectures.html">lectures</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../egm101/practicals/index.html">practicals</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../egm101/practicals/week5.html">computation, summary statistics, and graphing in excel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm101/practicals/week6.html">summarizing and graphing data in spss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm101/practicals/week7.html">correlation and regression in spss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm101/practicals/week8.html">hypothesis testing using spss</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../egm101/resources.html">additional resources</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../egm310/index.html">EGM310: introduction to gis and remote sensing</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../egm310/lectures.html">lectures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../egm310/resources.html">additional resources</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../egm702/index.html">EGM702: photogrammetry and advanced image analysis</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../egm702/lectures.html">lectures</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../egm702/practicals/index.html">practicals</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../egm702/practicals/setup.html">software setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm702/practicals/week1.html">dem processing using micmac</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm702/practicals/week2.html">dem differencing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm702/practicals/week3.html">introduction to google earth engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm702/practicals/week4.html">change detection in earth engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm702/practicals/week5.html">classification in earth engine</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../egm702/resources.html">additional resources</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../egm703/index.html">EGM703: advanced active and passive remote sensing</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../egm703/lectures.html">lectures</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../egm703/practicals/index.html">practicals</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../egm703/practicals/week1.html">urban heat islands</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm703/practicals/week2.html">hyperspectral image analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm703/practicals/week3.html">SAR image processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm703/practicals/week4.html">InSAR Processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm703/practicals/week5.html">SAR image interpretation and flood mapping</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../egm703/resources.html">additional resources</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../egm722/index.html">EGM722: programming for gis and remote sensing</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../egm722/setup/index.html">setup</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/setup/github.html">setting up github</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/setup/git.html">installing git</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/setup/desktop.html">installing github desktop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/setup/fork.html">forking the repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/setup/clone.html">cloning the repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/setup/conda.html">setting up conda/anaconda</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/setup/environment.html">setting up a conda environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/setup/jupyter.html">configuring jupyter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/setup/pycharm.html">pycharm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/setup/pip.html">installing packages with pip</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../egm722/lectures.html">lectures</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../egm722/practicals/index.html">practicals</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/practicals/pythonintro.html">intro to python</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/practicals/debugging.html">debugging exercise</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/practicals/cartopy.html">mapping with cartopy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/practicals/conflicts.html">conflict resolution (using git)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/practicals/vector.html">vector data using shapely and geopandas</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/practicals/folium.html">interactive maps with folium</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/practicals/raster.html">raster data using rasterio</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/practicals/earthaccess.html">searching + downloading satellite data using earthaccess</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/practicals/zonalstats.html">zonal statistics using rasterstats</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../egm722/faq/index.html">help! something went wrong!</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/faq/git.html">git troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/faq/python.html">python troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../egm722/project/index.html">programming project</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/project/github.html">creating a new github repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../egm722/project/environment.html">environment.yml</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../egm722/resources.html">additional resources</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../unis/index.html">unis glaciology (AG-325)</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../unis/optical.html">mapping glacier area change</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../unis/dems.html">dem differencing and geodetic mass balance</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python-programming/index.html">programming skills for phd researchers (using python)</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../python-programming/setup/index.html">setup</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/setup/github.html">setting up github</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/setup/git.html">installing git</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/setup/desktop.html">installing github desktop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/setup/fork.html">forking the repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/setup/clone.html">cloning the repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/setup/conda.html">setting up conda/anaconda</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/setup/environment.html">setting up a conda environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/setup/jupyter.html">configuring the jupyterlab terminal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/setup/pycharm.html">pycharm</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../python-programming/lectures.html">lectures</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../python-programming/exercises/index.html">exercises</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/exercises/git.html">introduction to version control using git</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/exercises/project.html">starting a new project</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/exercises/intro.html">introduction to python using jupyterlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/exercises/debugging.html">debugging code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/exercises/plotting.html">plotting data using seaborn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/exercises/pandas.html">working with pandas dataframes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/exercises/stats.html">basic statistical analysis using python</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python-programming/exercises/regression.html">linear regression using python</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../python-programming/resources.html">additional resources</a></li>
</ul>
</li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../index.html">programming skills for phd researchers (using R)</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="../setup/index.html">setup</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../setup/github.html">setting up github</a></li>
<li class="toctree-l4"><a class="reference internal" href="../setup/git.html">installing git</a></li>
<li class="toctree-l4"><a class="reference internal" href="../setup/desktop.html">installing github desktop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../setup/fork.html">forking the repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="../setup/clone.html">cloning the repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="../setup/conda.html">setting up conda/anaconda</a></li>
<li class="toctree-l4"><a class="reference internal" href="../setup/environment.html">setting up a conda environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../setup/jupyter.html">configuring jupyterlab</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../lectures.html">lectures</a></li>
<li class="toctree-l3 current active has-children"><a class="reference internal" href="index.html">exercises</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="git.html">introduction to version control using git</a></li>
<li class="toctree-l4"><a class="reference internal" href="project.html">starting a new project</a></li>
<li class="toctree-l4"><a class="reference internal" href="rintro.html">introduction to <strong>R</strong> using jupyterlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="debugging.html">debugging code</a></li>
<li class="toctree-l4"><a class="reference internal" href="plotting.html">plotting data using ggplot2</a></li>
<li class="toctree-l4"><a class="reference internal" href="transform.html">transforming data</a></li>
<li class="toctree-l4 current active"><a class="current reference internal" href="#">basic statistical analysis using <strong>R</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="regression.html">linear regression using <strong>R</strong></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../resources.html">additional resources</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../ml-crash-course/index.html">a crash course in machine learning (using python) – under development</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../ml-crash-course/setup.html">setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ml-crash-course/lectures.html">lectures</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../ml-crash-course/exercises/index.html">exercises</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../ml-crash-course/exercises/regression.html">what is machine learning?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../ml-crash-course/exercises/training_testing.html">training, testing, and validation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../ml-crash-course/exercises/feature_design.html">feature design and engineering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../ml-crash-course/exercises/performance.html">measuring model performance</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../ml-crash-course/resources.html">additional resources</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../hpc-intro/index.html">introduction to high performance computing</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../hpc-intro/setup.html">setup</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../hpc-intro/shell/index.html">the unix shell</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../hpc-intro/shell/shell.html">in the beginning was the command line</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../hpc-intro/shell/navigation.html">navigating on the command line</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../hpc-intro/shell/files.html">working with files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../hpc-intro/shell/input.html">input/output</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../hpc-intro/shell/scripts.html">shell scripts</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../hpc-intro/hpc/index.html">high performance computing</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-25"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../hpc-intro/hpc/atlas.html">atlas</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../hpc-intro/hpc/data_transfer.html">transferring data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../hpc-intro/hpc/vulcan.html">vulcan</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../hpc-intro/resources.html">additional resources</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../dissertation/index.html">undergraduate dissertation projects</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-26"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../dissertation/glaciers.html">mapping glacier changes over time</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dissertation/glacial_lakes.html">detection of supraglacial lakes and timing of drainage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dissertation/algae.html">mapping harmful algal blooms using satellite remote sensing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dissertation/floods.html">flood detection and monitoring using remote sensing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dissertation/wildfires.html">detection and mapping of wildfires</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dissertation/heat_islands.html">urban heat islands</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../gee/index.html">google earth engine</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-27"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../gee/tutorials/index.html">gee tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-28"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../gee/tutorials/getting_started/index.html">getting started</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-29"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/getting_started/adding_exporting.html">adding and exporting images</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/getting_started/spectral.html">spectral signatures</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/getting_started/image_collections.html">image collections and vectors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/getting_started/mapping.html">manual mapping (digitizing)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/getting_started/band_maths.html">band maths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/getting_started/zonal_stats.html">zonal statistics</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../gee/tutorials/classification/index.html">image classification</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-30"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/classification/unsupervised.html">unsupervised classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/classification/pixel.html">pixel-based classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/classification/obia.html">object-based classification</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../gee/tutorials/change_detection/index.html">change detection</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-31"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/change_detection/visual_analysis.html">visual analysis of changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/change_detection/thresholding.html">band maths and thresholding</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/change_detection/repeat_classification.html">repeat classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/change_detection/cva.html">change vector analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/change_detection/time_series.html">time series analysis</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../gee/tutorials/enhancement/index.html">image enhancement</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-32"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/enhancement/filtering.html">image filtering</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/enhancement/pansharpening.html">pansharpening</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/enhancement/edge_detection.html">edge detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/enhancement/unmixing.html">spectral unmixing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/enhancement/pca.html">principle component analysis</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../gee/tutorials/advanced/index.html">advanced topics</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-33"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../gee/tutorials/advanced/animation.html">creating an animation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../gee/exercises/index.html">sample exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../research/index.html">ongoing and past research projects</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-34"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../research/dar.html">deplete and retreat (DaR)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../writing/index.html">selected writing samples</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-35"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../writing/source.html">source magazine (summer 2022)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../github.html">github projects</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/iamdonovan/iamdonovan.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/iamdonovan/iamdonovan.github.io/edit/main/teaching/r-programming/exercises/stats.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/iamdonovan/iamdonovan.github.io/issues/new?title=Issue%20on%20page%20%2Fteaching/r-programming/exercises/stats.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/teaching/r-programming/exercises/stats.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>basic statistical analysis using R</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data">data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-libraries">loading libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptive-statistics">descriptive statistics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#describing-variables-using-summary">describing variables using summary()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-summary-to-summarize-groups">using summary() to summarize groups</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-built-in-functions-for-descriptive-statistics">using built-in functions for descriptive statistics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-summarize">using summarize</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-tests">statistical tests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#independent-samples-students-t-test">independent samples student’s <em>t</em>-test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#non-parametric-tests">non-parametric tests</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-of-variance">analysis of variance</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-and-next-steps">exercise and next steps</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="basic-statistical-analysis-using-r">
<h1>basic statistical analysis using <strong>R</strong><a class="headerlink" href="#basic-statistical-analysis-using-r" title="Permalink to this heading">#</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a <strong>non-interactive</strong> version of the exercise. If you want to run through the steps yourself and see the
outputs, you’ll need to do one of the following:</p>
<ul class="simple">
<li><p>follow the setup steps and work through the notebook on your own computer</p></li>
<li><p>open the workshop materials on <a class="reference external" href="https://mybinder.org/v2/gh/iamdonovan/intro-to-r/binder">binder</a> and work
through them online</p></li>
<li><p>open an <strong>R</strong> console or <strong>RStudio</strong>, copy the lines of code here, and paste them into the console to run them</p></li>
</ul>
</div>
<p>In this exercise, we’ll take a look at some basic statistical analysis
with <strong>R</strong> - starting with using <strong>R</strong> to calculate descriptive
statistics for our datasets, before moving on to look at a few common
examples of hypothesis tests.</p>
<section id="data">
<h2>data<a class="headerlink" href="#data" title="Permalink to this heading">#</a></h2>
<p>The data used in this exercise are the historic meteorological
observations from the <a class="reference external" href="https://www.metoffice.gov.uk/weather/learn-about/how-forecasts-are-made/observations/recording-observations-for-over-100-years">Armagh
Observatory</a>
(1853-present), the Oxford Observatory (1853-present), the Southampton
Observatory (1855-2000), and Stornoway Airport (1873-present),
downloaded from the <a class="reference external" href="https://www.metoffice.gov.uk/research/climate/maps-and-data/historic-station-data">UK Met
Office</a>
that we used in previous exercises. I have copied the
<strong>combined_stations.csv</strong> data into this folder - this is the same file
that you created in the process of working through the “transforming
data” exercise.</p>
</section>
<section id="loading-libraries">
<h2>loading libraries<a class="headerlink" href="#loading-libraries" title="Permalink to this heading">#</a></h2>
<p>As before, we load the libraries that we will use in the exercise at the
beginning. This time, we will load a single library,
<a class="reference external" href="https://www.tidyverse.org/packages/">tidyverse</a>, which is actually a
collection of packages, some of which we have seen before:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://readr.tidyverse.org/">readr</a>, for reading data from a
file;</p></li>
<li><p><a class="reference external" href="https://ggplot2.tidyverse.org/">ggplot2</a>, for plotting data;</p></li>
<li><p><a class="reference external" href="https://dplyr.tidyverse.org/">dplyr</a>, for
transforming/manipulating data;</p></li>
<li><p><a class="reference external" href="https://tidyr.tidyverse.org/">tidyr</a>, for tidying “messy” data;</p></li>
<li><p><a class="reference external" href="https://tibble.tidyverse.org/">tibble</a>, for working with tabular
data;</p></li>
<li><p><a class="reference external" href="https://forcats.tidyverse.org/">forcats</a>, for working with
categorical variables;</p></li>
<li><p><a class="reference external" href="https://stringr.tidyverse.org/">stringr</a>, for working with
strings (character data);</p></li>
<li><p><a class="reference external" href="https://lubridate.tidyverse.org/">lubridate</a>, for working with
date-time data;</p></li>
<li><p>and <a class="reference external" href="https://purrr.tidyverse.org/">purrr</a>, for working with
functions and vectors.</p></li>
</ul>
<p>When we load <code class="docutils literal notranslate"><span class="pre">tidyverse</span></code>, we see that all of these packages are loaded
at the same time:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
</pre></div>
</div>
<p>next, we’ll use <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> to load the combined station data:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="s">&#39;data/combined_stations.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="descriptive-statistics">
<h2>descriptive statistics<a class="headerlink" href="#descriptive-statistics" title="Permalink to this heading">#</a></h2>
<p>Before diving into statistical tests, we’ll spend a little bit of time
expanding on calculating <em>descriptive</em> statistics in <strong>R</strong>. We have seen
a little bit of this already, using <code class="docutils literal notranslate"><span class="pre">group_by()</span></code> and <code class="docutils literal notranslate"><span class="pre">summarize()</span></code>
along with <code class="docutils literal notranslate"><span class="pre">mean()</span></code> to calculate the mean value of <code class="docutils literal notranslate"><span class="pre">tmax</span></code> and
<code class="docutils literal notranslate"><span class="pre">rain</span></code> for each station and season.</p>
<section id="describing-variables-using-summary">
<h3>describing variables using summary()<a class="headerlink" href="#describing-variables-using-summary" title="Permalink to this heading">#</a></h3>
<p>First, we’ll have a look at <code class="docutils literal notranslate"><span class="pre">summary()</span></code>
(<a class="reference external" href="https://rdrr.io/r/base/summary.html">documentation</a>), which
provides a summary of the results of model fitting functions (such as
linear regression or statistical tests, which we’ll see more of later).</p>
<p>With a table, <code class="docutils literal notranslate"><span class="pre">summary()</span></code> shows a summary of the distribution of each
variable in the table (apart from <strong>character</strong> variables):</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="n">station_data</span><span class="p">)</span><span class="w"> </span><span class="c1"># show a summary of the variables of the table</span>
</pre></div>
</div>
<p>In the output above, we can see the minimum (<strong>Min.</strong>), 1st quartile
(<strong>1st Qu.</strong>), median (<strong>Median</strong>), mean (<strong>Mean</strong>), 3rd quartile (<strong>3rd
Qu.</strong>), and maximum (<strong>Max.</strong>) values of each numeric variable, as well
as the number of <code class="docutils literal notranslate"><span class="pre">NA</span></code> values.</p>
<p>With this, we can quickly see where we might have errors in our data -
for example, if we have non-physical or nonsense values in our
variables. When first getting started with a dataset, it can be a good
idea to check over the dataset using <code class="docutils literal notranslate"><span class="pre">summary()</span></code>.</p>
</section>
<section id="using-summary-to-summarize-groups">
<h3>using summary() to summarize groups<a class="headerlink" href="#using-summary-to-summarize-groups" title="Permalink to this heading">#</a></h3>
<p>What if we wanted to get a summary based on some grouping - for example,
for each station? We could use <code class="docutils literal notranslate"><span class="pre">filter()</span></code> to create an object for each
value of <code class="docutils literal notranslate"><span class="pre">station</span></code>, then call <code class="docutils literal notranslate"><span class="pre">summary()</span></code> on each of these objects
in turn.</p>
<p>Not surprisingly, however, there is an easier way, using <code class="docutils literal notranslate"><span class="pre">split()</span></code>
(<a class="reference external" href="https://rdrr.io/r/base/split.html">documentation</a>) and <code class="docutils literal notranslate"><span class="pre">map()</span></code>
(<a class="reference external" href="https://purrr.tidyverse.org/reference/map.html">documentation</a>).
First, <code class="docutils literal notranslate"><span class="pre">split()</span></code> divides the table into separate tables based on some
grouping:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nf">split</span><span class="p">(</span><span class="o">~</span><span class="n">station</span><span class="p">)</span><span class="w"> </span><span class="c1"># divide the table into a list of separate tables based on the value of station</span>
</pre></div>
</div>
<p>Here, we are using the “tilde” (<code class="docutils literal notranslate"><span class="pre">~</span></code>) operator. We have used this once
previously, as an input to <code class="docutils literal notranslate"><span class="pre">facet_wrap()</span></code>, but we will introduce it
more thoroughly now. In <strong>R</strong>, <code class="docutils literal notranslate"><span class="pre">~</span></code> is used to create a <strong>formula</strong>, a
special class that allows us to capture the value of an object, without
evaluating them. When we pass them to a function, the formula gets
evaluated by the function.</p>
<p>We’ll see <strong>two-sided formulas</strong> when we look at statistical tests and
regression, but <code class="docutils literal notranslate"><span class="pre">~station</span></code> is an example of a <strong>one-sided formula</strong> -
<code class="docutils literal notranslate"><span class="pre">split()</span></code> interprets this as “divide the table <code class="docutils literal notranslate"><span class="pre">station_data</span></code> into
separate tables based on the value of the <code class="docutils literal notranslate"><span class="pre">station</span></code> variable”.</p>
<p>As you can see in the output above (a <strong>list</strong> object), the result of
this is that we have four separate table objects. Finally, we can use
<code class="docutils literal notranslate"><span class="pre">map()</span></code> to apply a function, like <code class="docutils literal notranslate"><span class="pre">summary()</span></code>, to each of the
elements of the <strong>list</strong>:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">split</span><span class="p">(</span><span class="o">~</span><span class="n">station</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="c1"># divide the table into separate tables based on the value of station</span>
<span class="w">    </span><span class="nf">map</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span><span class="w"> </span><span class="c1"># apply the function summary() to each of the outputs of split()</span>
</pre></div>
</div>
</section>
<section id="using-built-in-functions-for-descriptive-statistics">
<h3>using built-in functions for descriptive statistics<a class="headerlink" href="#using-built-in-functions-for-descriptive-statistics" title="Permalink to this heading">#</a></h3>
<p>This is helpful, but sometimes we want to calculate other descriptive
statistics, or use the values of descriptive statistics in our code.
<strong>R</strong> has a number of built-in functions for this - we have already seen
<code class="docutils literal notranslate"><span class="pre">mean()</span></code> (<a class="reference external" href="https://rdrr.io/r/base/mean.html">documentation</a>), for
calculating the arithmetic mean of an object:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">mean</span><span class="p">(</span><span class="n">station_data</span><span class="o">$</span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="c1"># calculate the arithmetic mean of station_data$tmax, ignoring NA values</span>
</pre></div>
</div>
<p>we can calculate the median in the same way, using <code class="docutils literal notranslate"><span class="pre">median()</span></code>
(<a class="reference external" href="https://rdrr.io/r/stats/median.html">documentation</a>):</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">mean</span><span class="p">(</span><span class="n">station_data</span><span class="o">$</span><span class="n">rain</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
<p>To calculate the variance of an object, we use <code class="docutils literal notranslate"><span class="pre">var()</span></code>
(<a class="reference external" href="https://rdrr.io/r/stats/cor.html">documentation</a>):</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">var</span><span class="p">(</span><span class="n">station_data</span><span class="o">$</span><span class="n">tmin</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
<p>and for the standard deviation, <code class="docutils literal notranslate"><span class="pre">sd()</span></code>
(<a class="reference external" href="https://rdrr.io/r/stats/sd.html">documentation</a>):</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">sd</span><span class="p">(</span><span class="n">station_data</span><span class="o">$</span><span class="n">tmin</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
<p>We can also calculate the inter-quartile range (IQR) using <code class="docutils literal notranslate"><span class="pre">IQR()</span></code>
(<a class="reference external" href="https://rdrr.io/r/stats/IQR.html">documentation</a>):</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">IQR</span><span class="p">(</span><span class="n">station_data</span><span class="o">$</span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
<p>and the median absolute deviation (MAD), using <code class="docutils literal notranslate"><span class="pre">mad()</span></code>
(<a class="reference external" href="https://rdrr.io/r/stats/mad.html">documentation</a>):</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">mad</span><span class="p">(</span><span class="n">station_data</span><span class="o">$</span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
<p>And, finally, we can calculate quantiles for an object using
<code class="docutils literal notranslate"><span class="pre">quantile()</span></code>
(<a class="reference external" href="https://rdrr.io/r/stats/quantile.html">documentation</a>):</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">quantile</span><span class="p">(</span><span class="n">station_data</span><span class="o">$</span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="m">0.99</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="c1"># calculate the 99th percentile value of tmax</span>
</pre></div>
</div>
</section>
<section id="using-summarize">
<h3>using summarize<a class="headerlink" href="#using-summarize" title="Permalink to this heading">#</a></h3>
<p>As we have also seen, we can use <code class="docutils literal notranslate"><span class="pre">summarize()</span></code> and <code class="docutils literal notranslate"><span class="pre">group_by()</span></code> to
calculate any descriptive statistics or values that we want, based on
the groups created by <code class="docutils literal notranslate"><span class="pre">group_by()</span></code>:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">group_by</span><span class="p">(</span><span class="n">station</span><span class="p">,</span><span class="w"> </span><span class="n">season</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">summarize</span><span class="p">(</span>
<span class="w">        </span><span class="n">tmax_mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="c1"># calculate the mean of tmax</span>
<span class="w">        </span><span class="n">tmax_std</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="c1"># calculate the standard deviation of tmax</span>
<span class="w">        </span><span class="n">tmin_mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="c1"># calculate the mean of tmin</span>
<span class="w">        </span><span class="n">tmin_std</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="c1"># calculate the standard deviation of tmin</span>
<span class="w">        </span><span class="n">tmax_med</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">median</span><span class="p">(</span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="c1"># calculate the median of tmax</span>
<span class="w">        </span><span class="n">tmin_med</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">median</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="c1"># calculate the median of tmin</span>
<span class="w">        </span><span class="n">rain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">rain</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="c1"># calculate the median of rain</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">summary_data</span><span class="w"> </span><span class="c1"># assign the output of summarize to an object</span>

<span class="n">summary_data</span>
</pre></div>
</div>
</section>
</section>
<section id="statistical-tests">
<h2>statistical tests<a class="headerlink" href="#statistical-tests" title="Permalink to this heading">#</a></h2>
<p>In addition to descriptive statistics, we can use <strong>R</strong> for <em>inferential
statistics</em> - for example, for hypothesis testing. In the remainder of
the exercise, we’ll look at a few examples of some common statistical
tests and how to perform these in <strong>R</strong>. Please note that these examples
are far from exhaustive - if you’re looking for a specific hypothesis
test, there’s a good chance someone has programmed it into <strong>R</strong>, either
as part of the default <code class="docutils literal notranslate"><span class="pre">stats</span></code> package
(<a class="reference external" href="https://rdrr.io/r/#stats">documentation</a>), or as an additional
package that you can install. You should be able to find what you need
with a quick internet search.</p>
<section id="independent-samples-students-t-test">
<h3>independent samples student’s <em>t</em>-test<a class="headerlink" href="#independent-samples-students-t-test" title="Permalink to this heading">#</a></h3>
<p>To run Student’s <em>t</em>-test, we use <code class="docutils literal notranslate"><span class="pre">t.test()</span></code>
(<a class="reference external" href="https://rdrr.io/r/stats/t.test.html">documentation</a>). One of the
arguments to the function is <code class="docutils literal notranslate"><span class="pre">alternative</span></code>, which allows us to select
whether the test is <code class="docutils literal notranslate"><span class="pre">&quot;two.sided&quot;</span></code> (the default value), <code class="docutils literal notranslate"><span class="pre">&quot;less&quot;</span></code>, or
<code class="docutils literal notranslate"><span class="pre">&quot;greater&quot;</span></code>. We can also use the <code class="docutils literal notranslate"><span class="pre">paired</span></code> argument to choose whether
to run a paired <em>t</em>-test or not (by default, this is <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>).</p>
<p>For a start, let’s test the hypothesis that Stornoway Airport gets more
rain than Armagh. If we first have a look at a box plot:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">filter</span><span class="p">(</span><span class="n">station</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;armagh&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;stornoway&#39;</span><span class="p">))</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">  </span><span class="c1"># select only rows where station is armagh or stornoway</span>
<span class="w">    </span><span class="n">selected</span><span class="w"> </span><span class="c1"># store the result in a new object</span>

<span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">selected</span><span class="p">,</span><span class="w"> </span><span class="n">mapping</span><span class="o">=</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">station</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">rain</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_boxplot</span><span class="p">()</span><span class="w"> </span><span class="c1"># create a box plot of monthly rainfall for each station</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../_images/stats_27_1.png"><img alt="../../../_images/stats_27_1.png" src="../../../_images/stats_27_1.png" style="width: 420px; height: 420px;" /></a>
<p>It does look like Stornoway Airport does get more rain, on average, than
Armagh. Using <code class="docutils literal notranslate"><span class="pre">t.test()</span></code>, we can test this hypothesis at the 99%
confidence level:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">armagh.rain</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">selected</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">filter</span><span class="p">(</span><span class="n">station</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&#39;armagh&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">rain</span><span class="p">))</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="c1"># select only rows where station == &#39;armagh&#39;</span>
<span class="w">    </span><span class="nf">pull</span><span class="p">(</span><span class="n">rain</span><span class="p">)</span><span class="w"> </span><span class="c1"># select only the rain variable as a vector</span>

<span class="n">stornoway.rain</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">selected</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">filter</span><span class="p">(</span><span class="n">station</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&#39;stornoway&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">rain</span><span class="p">))</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="c1"># select only rows where station == &#39;stornoway&#39;</span>
<span class="w">    </span><span class="nf">pull</span><span class="p">(</span><span class="n">rain</span><span class="p">)</span><span class="w"> </span><span class="c1"># select only the rain variable as a vector</span>

<span class="c1"># test whether mean(stornoway.rain) &gt; mean(armagh.rain) at the 99% confidence interval</span>
<span class="nf">t.test</span><span class="p">(</span><span class="n">stornoway.rain</span><span class="p">,</span><span class="w"> </span><span class="n">armagh.rain</span><span class="p">,</span><span class="w"> </span><span class="n">alternative</span><span class="o">=</span><span class="s">&#39;greater&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">conf.level</span><span class="o">=</span><span class="m">0.99</span><span class="p">)</span>
</pre></div>
</div>
<p>The output of <code class="docutils literal notranslate"><span class="pre">t.test()</span></code> tells us the data that we have used, the
value of the <em>t</em> statistic (22.877), the number of degrees of freedom
(<em>df</em> = 3075), and the <em>p</em> value of the test (<em>p</em> &lt; 2.2e-16).</p>
<p>It also formulates the alternative hypothesis, gives us the 99%
confidence interval for the difference in the means, and gives us the
estimates of the mean value for each variable. Based on the results of
the test, we can reject the null hypothesis, and conclude that Stornoway
Airport does get more rain, on average, than Armagh.</p>
<p>Now, let’s look at an example of a one-sample <em>t</em>-test, to see if we can
determine whether the mean of a small sample of summer temperatures
provides a good estimate of the mean of all summer temperatures measured
at Oxford.</p>
<p>First, we’ll select all of the summer values of <code class="docutils literal notranslate"><span class="pre">tmax</span></code> recorded at
Oxford, then calculate the mean value of these temperatures:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">oxford_summer_tmax</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">filter</span><span class="p">(</span><span class="n">station</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&#39;oxford&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">tmax</span><span class="p">),</span><span class="w"> </span><span class="n">season</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&#39;summer&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="c1"># select only rows where station == &#39;armagh&#39;</span>
<span class="w">    </span><span class="nf">pull</span><span class="p">(</span><span class="n">tmax</span><span class="p">)</span><span class="w"> </span><span class="c1"># select only the tmax variable as a vector</span>

<span class="c1"># sample(30) # select a random sample of 50 values</span>

<span class="nf">mean</span><span class="p">(</span><span class="n">oxford_summer_tmax</span><span class="p">)</span>
</pre></div>
</div>
<p>So the mean summer temperature measured in Oxford between 1853-2022 is
21.1°C - now, let’s take a random sample of 30 temperatures using
<code class="docutils literal notranslate"><span class="pre">sample()</span></code>:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># select a random sample of 30 values</span>
<span class="n">sample_tmax</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">oxford_summer_tmax</span><span class="p">,</span><span class="w"> </span><span class="m">30</span><span class="p">)</span>
</pre></div>
</div>
<p>And finally, we conduct a one-sample <em>t</em>-test (two-sided), to see if our
sample leads us to conclude whether the mean monthly maximum temperature
is not equal to 21.1°C:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># test whether average summer monthly maximum temperature is not equal to 21.1</span>
<span class="nf">t.test</span><span class="p">(</span><span class="n">sample_tmax</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="o">=</span><span class="m">21.1</span><span class="p">,</span><span class="w"> </span><span class="n">alternative</span><span class="o">=</span><span class="s">&#39;two.sided&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">conf.level</span><span class="o">=</span><span class="m">0.99</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="non-parametric-tests">
<h3>non-parametric tests<a class="headerlink" href="#non-parametric-tests" title="Permalink to this heading">#</a></h3>
<p>We can also conduct non-parametric hypothesis tests using <strong>R</strong>. The
example we will look at is the one- or two-sample Wilcoxon tests, using
<code class="docutils literal notranslate"><span class="pre">wilcox.test()</span></code>
(<a class="reference external" href="https://rdrr.io/r/stats/wilcox.test.html">documentation</a>). Let’s
start by looking at the Wilcoxon Rank Sum test, which is analogous to
the independent sample <em>t</em>-test. For this, we’ll use the same data that
we did before, again testing whether Stornoway Airport gets more
rainfall, on average, than Armagh:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># test whether mean(stornoway.rain) &gt; mean(armagh.rain) at the 99% confidence interval</span>
<span class="nf">wilcox.test</span><span class="p">(</span><span class="n">stornoway.rain</span><span class="p">,</span><span class="w"> </span><span class="n">armagh.rain</span><span class="p">,</span><span class="w"> </span><span class="n">alternative</span><span class="o">=</span><span class="s">&#39;greater&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">conf.level</span><span class="o">=</span><span class="m">0.99</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="analysis-of-variance">
<h3>analysis of variance<a class="headerlink" href="#analysis-of-variance" title="Permalink to this heading">#</a></h3>
<p>Finally, we’ll see how we can set up and interpret an analysis of
variance test. In this example, we’ll only look at data from Armagh,
Oxford, and Stornoway Airport, because the Southampton time series ends
in 1999. We’ll first calculate the annually-averaged (or annual total)
values of <code class="docutils literal notranslate"><span class="pre">tmax</span></code>, <code class="docutils literal notranslate"><span class="pre">tmin</span></code>, and <code class="docutils literal notranslate"><span class="pre">rain</span></code>. Then, we’ll add a new
variable, <code class="docutils literal notranslate"><span class="pre">period</span></code>, to divide the observations into three different
50-year periods: 1871-1920, 1921-1970, and 1971-2020. Finally, we’ll
remove any remaining <code class="docutils literal notranslate"><span class="pre">NA</span></code> values, and assign this to a new object,
<code class="docutils literal notranslate"><span class="pre">filtered_periods</span></code>:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">filter</span><span class="p">(</span><span class="n">station</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;armagh&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;oxford&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;stornoway&#39;</span><span class="p">))</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="c1"># select only armagh, oxford, and stornoway observations</span>
<span class="w">    </span><span class="nf">group_by</span><span class="p">(</span><span class="n">year</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">summarize</span><span class="p">(</span>
<span class="w">        </span><span class="n">tmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="c1"># calculate the annually-averaged value of tmax</span>
<span class="w">        </span><span class="n">tmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">tmin</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="c1"># calculate the annually-averaged value of tmin</span>
<span class="w">        </span><span class="n">rain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">rain</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="c1"># calculate the annual total rainfall</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">mutate</span><span class="p">(</span>
<span class="w">        </span><span class="n">period</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">case_when</span><span class="p">(</span><span class="w"> </span><span class="c1"># add a new variable, period, corre</span>
<span class="w">            </span><span class="n">year</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="m">1871</span><span class="o">:</span><span class="m">1920</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&#39;1871-1920&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="n">year</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="m">1921</span><span class="o">:</span><span class="m">1970</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&#39;1921-1970&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="n">year</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="m">1971</span><span class="o">:</span><span class="m">2020</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&#39;1971-2020&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">period</span><span class="p">))</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">filtered_periods</span><span class="w"> </span><span class="c1"># remove NA values and store in a new object</span>
</pre></div>
</div>
<p>Before running the test, let’s make a box plot that shows the
distribution of <code class="docutils literal notranslate"><span class="pre">tmax</span></code> values among the three periods:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">filtered_periods</span><span class="p">,</span><span class="w"> </span><span class="n">mapping</span><span class="o">=</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">period</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">tmax</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_boxplot</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../../_images/stats_41_0.png"><img alt="../../../_images/stats_41_0.png" src="../../../_images/stats_41_0.png" style="width: 420px; height: 420px;" /></a>
<p>From this, it certainly appears as though there is a difference in the
mean value of <code class="docutils literal notranslate"><span class="pre">tmax</span></code> between the three periods. To formally test this,
we’ll use <code class="docutils literal notranslate"><span class="pre">aov()</span></code>
(<a class="reference external" href="https://rdrr.io/r/stats/aov.html">documentation</a>).</p>
<p>The first argument to <code class="docutils literal notranslate"><span class="pre">aov()</span></code> is a <strong>formula</strong>, as we discussed
earlier when looking at <code class="docutils literal notranslate"><span class="pre">summary()</span></code>. Here, we’re looking at a
two-sided formula, which has the form
<code class="docutils literal notranslate"><span class="pre">response</span> <span class="pre">variable</span> <span class="pre">~</span> <span class="pre">explanatory</span> <span class="pre">variable(s)</span></code>. Here, we’re
investigating whether there is a relationship between value of
<code class="docutils literal notranslate"><span class="pre">period</span></code> and the value of <code class="docutils literal notranslate"><span class="pre">tmax</span></code>, which means that the <strong>formula</strong>
we use is <code class="docutils literal notranslate"><span class="pre">tmax</span> <span class="pre">~</span> <span class="pre">period</span></code>. We also need to make sure to pass the
<code class="docutils literal notranslate"><span class="pre">filtered_periods</span></code> object to the function using the <code class="docutils literal notranslate"><span class="pre">data</span></code> argument,
otherwise <strong>R</strong> won’t find the variables <code class="docutils literal notranslate"><span class="pre">tmax</span></code> and <code class="docutils literal notranslate"><span class="pre">period</span></code>:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">tmax_aov</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">aov</span><span class="p">(</span><span class="n">tmax</span><span class="o">~</span><span class="n">period</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">filtered_periods</span><span class="p">)</span><span class="w"> </span><span class="c1"># run aov on tmax as a function of period</span>

<span class="n">tmax_aov</span><span class="w"> </span><span class="c1"># show the output of aov()</span>
</pre></div>
</div>
<p>From this, we see the terms of the model - the sum of squares between
groups (11.71181) and within groups (49.15164) in the top row, and the
number of degrees of freedom between groups (2) and within groups (147)
in the second row.</p>
<p>If we want to see the result of the test, we can <code class="docutils literal notranslate"><span class="pre">summary()</span></code> to show
the summary of the model:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="n">tmax_aov</span><span class="p">)</span><span class="w"> </span><span class="c1"># show the summary of the aov model</span>
</pre></div>
</div>
<p>Here, we can see the significance value (<code class="docutils literal notranslate"><span class="pre">Pr(&gt;F)</span></code>) is 1.51e-07, which
is also given a significance code of <code class="docutils literal notranslate"><span class="pre">***</span></code> - meaning that there is a
significant difference between the groups at the 0.001 significance
level.</p>
<p>This doesn’t tell us which pairs of groups are different - for this, we
would need to run an additional test. As one example, we could use the
<code class="docutils literal notranslate"><span class="pre">tmax_aov</span></code> object, along with <code class="docutils literal notranslate"><span class="pre">TukeyHSD()</span></code>
(<a class="reference external" href="https://rdrr.io/r/stats/TukeyHSD.html">documentation</a>), to compute
“Tukey’s Honest Significant Difference” between each pair of groups:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">TukeyHSD</span><span class="p">(</span><span class="n">tmax_aov</span><span class="p">)</span><span class="w"> </span><span class="c1"># compute tukey&#39;s hsd using our aov model</span>
</pre></div>
</div>
<p>From this, we can see the estimated difference in the means for each
pair of groups (<code class="docutils literal notranslate"><span class="pre">diff</span></code>), the lower (<code class="docutils literal notranslate"><span class="pre">lwr</span></code>) and upper (<code class="docutils literal notranslate"><span class="pre">upr</span></code>)
values of the 95% confidence interval of the difference, and the
adjusted <em>p</em>-value for each estimated difference. Using this, we can
clude that, at the 99% significance level, there is a significant
difference in <code class="docutils literal notranslate"><span class="pre">tmax</span></code> between the periods 1971-2020 and 1871-2020, and
between the periods 1971-2020 and 1921-1970.</p>
</section>
</section>
<section id="exercise-and-next-steps">
<h2>exercise and next steps<a class="headerlink" href="#exercise-and-next-steps" title="Permalink to this heading">#</a></h2>
<p>That’s all for this exercise. To help practice your skills, try at least
one of the following:</p>
<ul class="simple">
<li><p>Set up and run an AOV test to compare annual total rainfall at all
four stations, using data from all avaialable years. Are there
significant differences between the stations? Use <code class="docutils literal notranslate"><span class="pre">TukeyHSD()</span></code> or
<code class="docutils literal notranslate"><span class="pre">pairwise.t.test()</span></code>
(<a class="reference external" href="https://rdrr.io/r/stats/pairwise.t.test.html">documentation</a>) to
investigate further.</p></li>
<li><p>Using only observations from Armagh, set up and run a test to see if
there are significant differences in rainfall based on the season.</p></li>
<li><p>Using only observations from Oxford, is there a significant
difference between the values of <code class="docutils literal notranslate"><span class="pre">tmax</span></code> in the spring and the
autumn at the 99.9% confidence level?</p></li>
<li><p>Using only observations from Stornoway Airport, is the value of
<cite>tmin</cite> significantly lower in the winter, compared to the autumn?</p></li>
</ul>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="transform.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">transforming data</p>
      </div>
    </a>
    <a class="right-next"
       href="regression.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">linear regression using <strong>R</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data">data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-libraries">loading libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptive-statistics">descriptive statistics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#describing-variables-using-summary">describing variables using summary()</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-summary-to-summarize-groups">using summary() to summarize groups</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-built-in-functions-for-descriptive-statistics">using built-in functions for descriptive statistics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-summarize">using summarize</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-tests">statistical tests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#independent-samples-students-t-test">independent samples student’s <em>t</em>-test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#non-parametric-tests">non-parametric tests</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-of-variance">analysis of variance</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-and-next-steps">exercise and next steps</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Bob McNabb
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, Bob McNabb. Licensed under Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0).
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>