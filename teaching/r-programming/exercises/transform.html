
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>transforming data &#8212; space cameras and glaciers</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" href="../../../_static/customstyle.css" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="../../../_static/design-tabs.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="basic statistical analysis using R" href="stats.html" />
    <link rel="prev" title="plotting data using ggplot2" href="plotting.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">space cameras and glaciers</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../whataboutbob.html">
   about me
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../index.html">
   teaching
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../egm101/index.html">
     EGM101: skills toolbox
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm101/lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../egm101/practicals/index.html">
       practicals
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
      <label for="toctree-checkbox-3">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm101/practicals/week5.html">
         computation, summary statistics, and graphing in excel
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm101/practicals/week6.html">
         summarizing and graphing data in spss
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm101/practicals/week7.html">
         correlation and regression in spss
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm101/practicals/week8.html">
         hypothesis testing using spss
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm101/resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../egm310/index.html">
     EGM310: introduction to gis and remote sensing
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm310/lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm310/resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../egm702/index.html">
     EGM702: photogrammetry and advanced image analysis
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm702/lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../egm702/practicals/index.html">
       practicals
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
      <label for="toctree-checkbox-6">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/setup.html">
         software setup
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/week1.html">
         dem processing using micmac
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/week2.html">
         dem differencing
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/week3.html">
         introduction to google earth engine
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/week4.html">
         change detection in earth engine
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm702/practicals/week5.html">
         classification in earth engine
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm702/resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../egm703/index.html">
     EGM703: advanced active and passive remote sensing
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm703/lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../egm703/practicals/index.html">
       practicals
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
      <label for="toctree-checkbox-8">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm703/practicals/week1.html">
         urban heat islands
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm703/practicals/week2.html">
         hyperspectral image analysis
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm703/practicals/week3.html">
         SAR image processing
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm703/practicals/week4.html">
         InSAR Processing
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm703/practicals/week5.html">
         SAR image interpretation and flood mapping
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm703/resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../egm722/index.html">
     EGM722: programming for gis and remote sensing
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../egm722/setup/index.html">
       setup
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
      <label for="toctree-checkbox-10">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/setup/github.html">
         setting up github
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/setup/git.html">
         installing git
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/setup/desktop.html">
         installing github desktop
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/setup/fork.html">
         forking the repository
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/setup/clone.html">
         cloning the repository
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/setup/conda.html">
         setting up conda/anaconda
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/setup/environment.html">
         setting up a conda environment
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/setup/jupyter.html">
         configuring jupyter
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/setup/pycharm.html">
         pycharm
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/setup/pip.html">
         installing packages with pip
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm722/lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../egm722/practicals/index.html">
       practicals
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
      <label for="toctree-checkbox-11">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/practicals/week1.html">
         intro to python
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/practicals/debugging.html">
         debugging exercise
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/practicals/week2.html">
         mapping with cartopy
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/practicals/week3.html">
         vector data using shapely and geopandas
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/practicals/folium.html">
         interactive maps with folium
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/practicals/week4.html">
         raster data using rasterio
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/practicals/sentinelsat.html">
         searching for images with sentinelsat
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/practicals/week5.html">
         vector and raster operations using python
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../egm722/faq/index.html">
       help! something went wrong!
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
      <label for="toctree-checkbox-12">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/faq/git.html">
         git troubleshooting
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/faq/python.html">
         python troubleshooting
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../egm722/project/index.html">
       programming project
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
      <label for="toctree-checkbox-13">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/project/github.html">
         creating a new github repository
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../egm722/project/environment.html">
         environment.yml
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../egm722/resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../unis/index.html">
     unis glaciology (AG-325)
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../unis/optical.html">
       mapping glacier area change
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../unis/dems.html">
       dem differencing and geodetic mass balance
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="../index.html">
     programming skills for phd researchers
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../setup/index.html">
       setup
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
      <label for="toctree-checkbox-16">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/github.html">
         setting up github
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/git.html">
         installing git
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/desktop.html">
         installing github desktop
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/fork.html">
         forking the repository
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/clone.html">
         cloning the repository
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/conda.html">
         setting up conda/anaconda
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/environment.html">
         setting up a conda environment
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../setup/jupyter.html">
         configuring jupyterlab
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../lectures.html">
       lectures
      </a>
     </li>
     <li class="toctree-l3 current active has-children">
      <a class="reference internal" href="index.html">
       exercises
      </a>
      <input checked="" class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
      <label for="toctree-checkbox-17">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul class="current">
       <li class="toctree-l4">
        <a class="reference internal" href="git.html">
         introduction to version control using git
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="project.html">
         starting a new project
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="rintro.html">
         introduction to
         <strong>
          R
         </strong>
         using jupyterlab
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="debugging.html">
         debugging code
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="plotting.html">
         plotting data using ggplot2
        </a>
       </li>
       <li class="toctree-l4 current active">
        <a class="current reference internal" href="#">
         transforming data
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="stats.html">
         basic statistical analysis using
         <strong>
          R
         </strong>
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="regression.html">
         linear regression using
         <strong>
          R
         </strong>
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../resources.html">
       additional resources
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../gee/index.html">
   google earth engine
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../gee/tutorials/index.html">
     gee tutorials
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
    <label for="toctree-checkbox-19">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../gee/tutorials/getting_started/index.html">
       getting started
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
      <label for="toctree-checkbox-20">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/adding_exporting.html">
         adding and exporting images
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/spectral.html">
         spectral signatures
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/image_collections.html">
         image collections and vectors
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/mapping.html">
         manual mapping (digitizing)
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/band_maths.html">
         band maths
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/getting_started/zonal_stats.html">
         zonal statistics
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../gee/tutorials/classification/index.html">
       image classification
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/>
      <label for="toctree-checkbox-21">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/classification/unsupervised.html">
         unsupervised classification
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/classification/pixel.html">
         pixel-based classification
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/classification/obia.html">
         object-based classification
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../gee/tutorials/change_detection/index.html">
       change detection
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/>
      <label for="toctree-checkbox-22">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/change_detection/multitemporal_composites.html">
         multi-temporal color composites
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/change_detection/repeat_classification.html">
         repeat classification
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/change_detection/cva.html">
         change vector analysis
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/change_detection/time_series.html">
         time series analysis
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../gee/tutorials/enhancement/index.html">
       image enhancement
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/>
      <label for="toctree-checkbox-23">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/enhancement/filtering.html">
         image filtering
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/enhancement/pansharpening.html">
         pansharpening
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/enhancement/edge_detection.html">
         edge detection
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/enhancement/unmixing.html">
         spectral unmixing
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/enhancement/pca.html">
         principle component analysis
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../../../gee/tutorials/advanced/index.html">
       advanced topics
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/>
      <label for="toctree-checkbox-24">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../../../gee/tutorials/advanced/animation.html">
         creating an animation
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../gee/exercises/index.html">
     sample exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../research/index.html">
   ongoing and past research projects
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/>
  <label for="toctree-checkbox-25">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../research/dar.html">
     deplete and retreat (DaR)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../writing/index.html">
   selected writing samples
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/>
  <label for="toctree-checkbox-26">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../writing/source.html">
     source magazine (summer 2022)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../github.html">
   github projects
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/teaching/r-programming/exercises/transform.rst.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data">
   data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-libraries">
   loading libraries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-the-data">
   loading the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-filter-to-select-rows">
   using filter() to select rows
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-arrange-to-sort-rows">
   using arrange() to sort rows
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-distinct-to-find-unique-rows">
   using distinct() to find unique rows
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#counting-occurrences-with-count">
   counting occurrences with count()
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adding-variables-to-the-table-using-mutate">
   adding variables to the table using mutate()
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-select-to-select-columns">
   using select() to select columns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-rename-to-rename-columns">
   using rename() to rename columns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-relocate-to-move-columns">
   using relocate() to move columns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#saving-data-to-a-file">
   saving data to a file
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grouping-data">
   grouping data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#slicing-the-dataset">
   slicing the dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-ungroup-to-remove-groups">
   using ungroup() to remove groups
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-and-next-steps">
   exercise and next steps
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>transforming data</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data">
   data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-libraries">
   loading libraries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-the-data">
   loading the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-filter-to-select-rows">
   using filter() to select rows
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-arrange-to-sort-rows">
   using arrange() to sort rows
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-distinct-to-find-unique-rows">
   using distinct() to find unique rows
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#counting-occurrences-with-count">
   counting occurrences with count()
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adding-variables-to-the-table-using-mutate">
   adding variables to the table using mutate()
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-select-to-select-columns">
   using select() to select columns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-rename-to-rename-columns">
   using rename() to rename columns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-relocate-to-move-columns">
   using relocate() to move columns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#saving-data-to-a-file">
   saving data to a file
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grouping-data">
   grouping data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#slicing-the-dataset">
   slicing the dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-ungroup-to-remove-groups">
   using ungroup() to remove groups
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-and-next-steps">
   exercise and next steps
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="section" id="transforming-data">
<h1>transforming data<a class="headerlink" href="#transforming-data" title="Permalink to this headline">#</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a <strong>non-interactive</strong> version of the exercise. If you want to run through the steps yourself and see the
outputs, you’ll need to follow the setup steps and work through the notebook on your own computer.</p>
</div>
<p>In this lesson, we’re going to learn how we can work with datasets -
combining tables, creating and re-arranging variables, selecting and
sorting rows, and grouping and summarizing data. Mostly, we will be
using functions from the <code class="docutils literal notranslate"><span class="pre">dplyr</span></code> package, which is designed for data
manipulation (again, read this as “analyzing” or “working with”, not
“fabricating”!).</p>
<div class="section" id="data">
<h2>data<a class="headerlink" href="#data" title="Permalink to this headline">#</a></h2>
<p>The data used in this exercise are the historic meteorological
observations from the <a class="reference external" href="https://www.metoffice.gov.uk/weather/learn-about/how-forecasts-are-made/observations/recording-observations-for-over-100-years">Armagh
Observatory</a>
(1853-present), the Oxford Observatory (1853-present), the Southampton
Observatory (1855-2000), and Stornoway Airport (1873-present),
downloaded from the <a class="reference external" href="https://www.metoffice.gov.uk/research/climate/maps-and-data/historic-station-data">UK Met
Office</a>.</p>
<p>Like with the Armagh dataset we used previously, I have done the
following to make the data slightly easier to work with:</p>
<ul class="simple">
<li><p>Removed the header on lines 1-5</p></li>
<li><p>Replaced multiple spaces with a single space, and replaced single spaces with a comma (<code class="docutils literal notranslate"><span class="pre">,</span></code>)</p></li>
<li><p>Removed <code class="docutils literal notranslate"><span class="pre">---</span></code> to indicate no data, leaving these fields blank</p></li>
<li><p>Removed <code class="docutils literal notranslate"><span class="pre">*</span></code> indicating provisional/estimated values</p></li>
<li><p>Removed the 2023 data</p></li>
<li><p>Renamed the file (e.g., <code class="docutils literal notranslate"><span class="pre">oxforddata.txt</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">oxforddata.csv</span></code>).</p></li>
</ul>
<p>If you wish to use your own data (and there are loads of stations
available!), please feel free. For the best experience, you will likely
need to repeat the steps indicated above.</p>
</div>
<div class="section" id="loading-libraries">
<h2>loading libraries<a class="headerlink" href="#loading-libraries" title="Permalink to this headline">#</a></h2>
<p>As before, we load the libraries that we will use in the exercise at the
beginning. We will be using three libraries:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://readr.tidyverse.org/">readr</a>, for reading the data from a file;</p></li>
<li><p><a class="reference external" href="https://ggplot2.tidyverse.org/">ggplot2</a>, for plotting the data;</p></li>
<li><p>and <a class="reference external" href="https://dplyr.tidyverse.org/">dplyr</a>, for transforming/manipulating the data.</p></li>
</ul>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">readr</span><span class="p">)</span><span class="w"> </span><span class="c1"># this loads the functions we&#39;ll use to load the data</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w"> </span><span class="c1"># this loads the functions, etc. needed for us to plot</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w"> </span><span class="c1"># this loads the functions, etc. needed for us to work with the data</span>
</pre></div>
</div>
</div>
<div class="section" id="loading-the-data">
<h2>loading the data<a class="headerlink" href="#loading-the-data" title="Permalink to this headline">#</a></h2>
<p>In this exercise, we’re going to see a number of different ways that we
can work with data tables. Before we get to this, however, we need to
load the individual data files and combine them into a single data
table.</p>
<p>Rather than loading all four at once and then combining them, however,
we can simplify this slightly using a <strong>for</strong> loop. First, we’ll load
the Armagh Observatory data, because it’s currently in a different
folder.</p>
<p>Rather than typing the path to the file directly, we can use
<code class="docutils literal notranslate"><span class="pre">file.path()</span></code>
(<a class="reference external" href="https://rdrr.io/r/base/file.path.html">documentation</a>) to construct
a path in a <em>platform-independent</em> way. In general, we want to do this
because Windows uses <code class="docutils literal notranslate"><span class="pre">\</span></code> to separate folders, while Unix-style systems
such as Linux and MacOS use <code class="docutils literal notranslate"><span class="pre">/</span></code> - this way, we don’t run into issues
if we share our code with people working on different systems.</p>
<p>To construct the filename, we’re using a <a class="reference external" href="https://en.wikipedia.org/wiki/Path_(computing)#Absolute_and_relative_paths">relative
path</a>
- that is, it is <em>relative</em> to some given working directory (typically
the current working directory). To get to <strong>armaghdata.csv</strong> from the
current directory, we have to go up a directory level (<code class="docutils literal notranslate"><span class="pre">..</span></code>), before
entering the <strong>03.plotting</strong> directory, and the <strong>data</strong> directory after
that:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="nf">file.path</span><span class="p">(</span><span class="s">&#39;..&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;03.plotting&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;data&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;armaghdata.csv&#39;</span><span class="p">))</span><span class="w"> </span><span class="c1"># use file.path to construct a path to the data file</span>
</pre></div>
</div>
<p>Next, we want to make sure that we can keep track of which observation
comes from which station - so, we should add a <code class="docutils literal notranslate"><span class="pre">station</span></code> variable to
the table, and make sure to specify that these observations all come
from the Armagh Observatory:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="o">$</span><span class="n">station</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&#39;armagh&#39;</span><span class="w"> </span><span class="c1"># add the station name as a column</span>
</pre></div>
</div>
<p>Now, we can set up a loop to load the other 3 stations data. First, we
can create a <strong>vector</strong> of station names:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a vector of station names</span>
<span class="n">new_stations</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;oxford&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;southampton&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;stornoway&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now that we have the vector of station names, we can construct the
<strong>for</strong> loop to first read each file:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">fn_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="n">station</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;data.csv&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, we first use <code class="docutils literal notranslate"><span class="pre">paste()</span></code> to combine the <code class="docutils literal notranslate"><span class="pre">station</span></code> variable
(which takes on a value from the <code class="docutils literal notranslate"><span class="pre">new_stations</span></code> <strong>vector</strong> on each
pass through the loop) with <code class="docutils literal notranslate"><span class="pre">'data.csv'</span></code>, using a separator (<code class="docutils literal notranslate"><span class="pre">sep</span></code>)
value of <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> so that the resulting file names will be
<code class="docutils literal notranslate"><span class="pre">'oxforddata.csv'</span></code>, <code class="docutils literal notranslate"><span class="pre">'southamptondata.csv'</span></code>, and
<code class="docutils literal notranslate"><span class="pre">'stornowaydata.csv'</span></code>. We then use <code class="docutils literal notranslate"><span class="pre">file.path()</span></code> to combine this
with the <code class="docutils literal notranslate"><span class="pre">'data'</span></code> directory name, so that the value of <code class="docutils literal notranslate"><span class="pre">fn_data</span></code> is
the complete relative path to each file.</p>
<p>Next, we use <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> to read in the file, and add a <code class="docutils literal notranslate"><span class="pre">station</span></code>
variable to the table, just like we did with the Armagh data.</p>
<p>Finally, we use <code class="docutils literal notranslate"><span class="pre">bind_rows()</span></code>
(<a class="reference external" href="https://dplyr.tidyverse.org/reference/bind_rows.html">documentation</a>)
to combine the existing table, <code class="docutils literal notranslate"><span class="pre">station_data</span></code>, with the newly loaded
table (<code class="docutils literal notranslate"><span class="pre">data</span></code>), and overwrite the value of <code class="docutils literal notranslate"><span class="pre">station_data</span></code> with this
combined table:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">bind_rows</span><span class="p">(</span><span class="n">station_data</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>Each time through the <strong>for</strong> loop, the value of <code class="docutils literal notranslate"><span class="pre">station</span></code> is updated:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">for </span><span class="p">(</span><span class="n">station</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">new_stations</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">fn_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="n">station</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;data.csv&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">))</span><span class="w"> </span><span class="c1"># create the filename for each csv file, using file.path and paste</span>
<span class="w">    </span><span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="n">fn_data</span><span class="p">)</span><span class="w"> </span><span class="c1"># read the csv</span>
<span class="w">    </span><span class="n">data</span><span class="o">$</span><span class="n">station</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">station</span><span class="w"> </span><span class="c1"># add the station to the table</span>

<span class="w">    </span><span class="n">station_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">bind_rows</span><span class="p">(</span><span class="n">station_data</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="c1"># combine the new data with the current data table</span>
<span class="p">}</span>

<span class="nf">print</span><span class="p">(</span><span class="n">station_data</span><span class="p">)</span><span class="w"> </span><span class="c1"># show the data</span>
</pre></div>
</div>
<p>Note that this is one advantage of using clear, consistent naming and
formatting for data files - we can easily write a loop to load multiple
files, instead of having to write individual paths.</p>
</div>
<div class="section" id="using-filter-to-select-rows">
<h2>using filter() to select rows<a class="headerlink" href="#using-filter-to-select-rows" title="Permalink to this headline">#</a></h2>
<p>Now that we have a single table, we can also look at ways that we can
select rows from the table. We have alread seen an example of this - for
example, we could select all observations where the monthly maximum
temperature (<code class="docutils literal notranslate"><span class="pre">tmax</span></code>) is greater than 20°C:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="p">[</span><span class="n">station_data</span><span class="o">$</span><span class="n">tmax</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="p">]</span>
</pre></div>
</div>
<p>However, there’s a small problem with this. In the example above, you
can see that there are a number of rows where the values are all <code class="docutils literal notranslate"><span class="pre">NA</span></code>
- this is because of how <strong>R</strong> handles NA values with the <em>extraction
operators</em> (<code class="docutils literal notranslate"><span class="pre">[]</span></code>). Rows where <code class="docutils literal notranslate"><span class="pre">tmax</span></code> is missing (the value is
<code class="docutils literal notranslate"><span class="pre">NA</span></code>) also show up, because a comparison operator with <code class="docutils literal notranslate"><span class="pre">NA</span></code> returns
<code class="docutils literal notranslate"><span class="pre">NA</span></code>, <strong>not</strong> <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>/<code class="docutils literal notranslate"><span class="pre">FALSE</span></code>:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="o">$</span><span class="n">tmax</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">20</span>
</pre></div>
</div>
<p>When we then use this <strong>vector</strong> to <em>index</em> the <strong>tibble</strong>, the
corresponding rows are filled with <code class="docutils literal notranslate"><span class="pre">NA</span></code> values due to something called
<em>vector recycling</em> (see
<a class="reference external" href="https://homerhanumat.github.io/r-notes/vector-recycling.html">here</a>
for more information if you’re interested).</p>
<p>We could write a combined conditional expression to select the correct
rows:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">station_data</span><span class="o">$</span><span class="n">tmax</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">20</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">station_data</span><span class="o">$</span><span class="n">tmax</span><span class="p">))</span>
</pre></div>
</div>
<p>Here, the conditional is <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> only when <code class="docutils literal notranslate"><span class="pre">tmax</span> <span class="pre">&gt;</span> <span class="pre">20</span></code> <strong>and</strong>
<code class="docutils literal notranslate"><span class="pre">tmax</span></code> is not <code class="docutils literal notranslate"><span class="pre">NA</span></code>. However, there is an easier, clearer way, using
<code class="docutils literal notranslate"><span class="pre">dplyr::filter()</span></code>
(<a class="reference external" href="https://dplyr.tidyverse.org/reference/filter.html">documentation</a>):</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span><span class="n">tmax</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">20</span><span class="p">)</span><span class="w"> </span><span class="c1"># use filter to select rows where tmax &gt; 20</span>
</pre></div>
</div>
<p>Here, we’re using an operator we haven’t seen before: the <code class="docutils literal notranslate"><span class="pre">|&gt;</span></code>
(“pipe”) operator.</p>
<p>In brief, <code class="docutils literal notranslate"><span class="pre">|&gt;</span></code> tells <strong>R</strong> to take the output of the thing on the
left, and pass it to the function call on the right. Thinking about this
mathematically, <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">|&gt;</span> <span class="pre">f(y)</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">f(x,</span> <span class="pre">y)</span></code>. We can also
use this to combine multiple function calls - so, <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">|&gt;</span> <span class="pre">f(y)</span> <span class="pre">|&gt;</span> <span class="pre">g(z)</span></code>
is equivalent to <code class="docutils literal notranslate"><span class="pre">g(f(x,</span> <span class="pre">y),</span> <span class="pre">z)</span></code>, and so on.</p>
<p>So, this:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span><span class="n">tmax</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">20</span><span class="p">)</span><span class="w"> </span><span class="c1"># use filter to select rows where tmax &gt; 20</span>
</pre></div>
</div>
<p>Is the same as this:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">filter</span><span class="p">(</span><span class="n">station_data</span><span class="p">,</span><span class="w"> </span><span class="n">tmax</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">20</span><span class="p">)</span><span class="w"> </span><span class="c1"># use filter to select rows where tmax &gt; 20</span>
</pre></div>
</div>
<p>With only one function call, the difference may not seem like much - as
we will see, the real power comes when we are combining many function
calls together.</p>
<p>We can also use <code class="docutils literal notranslate"><span class="pre">filter()</span></code> with combined conditionals - for example,
to select all monthly observations where <code class="docutils literal notranslate"><span class="pre">tmax</span></code> is greater than 20°C
and <code class="docutils literal notranslate"><span class="pre">rain</span></code> is greater than 100 mm:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span><span class="n">tmax</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">rain</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="c1"># use filter to select rows where tmax &gt; 20 and rain &gt; 100</span>
</pre></div>
</div>
</div>
<div class="section" id="using-arrange-to-sort-rows">
<h2>using arrange() to sort rows<a class="headerlink" href="#using-arrange-to-sort-rows" title="Permalink to this headline">#</a></h2>
<p>Sometimes, we might want to sort our data according to the value of
different variables. For example, we can sort the observations by
rainfall, from smallest to largest values:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nf">arrange</span><span class="p">(</span><span class="n">rain</span><span class="p">)</span><span class="w"> </span><span class="c1"># sort by rainfall, from smallest to largest values</span>
</pre></div>
</div>
<p>By default, the values are sorted in <em>ascending</em> order (from smallest to
largest, or from A to Z for characters). If we want to see the reverse,
we can use <code class="docutils literal notranslate"><span class="pre">desc()</span></code>
(<a class="reference external" href="https://dplyr.tidyverse.org/reference/desc.html">documentation</a>):</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nf">arrange</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">rain</span><span class="p">))</span><span class="w"> </span><span class="c1"># sort by rainfall, from largest to smallest values</span>
</pre></div>
</div>
<p>We can also combine different variables to sort by - for example,
sorting by <code class="docutils literal notranslate"><span class="pre">season</span></code> and <code class="docutils literal notranslate"><span class="pre">rainfall</span></code>:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nf">arrange</span><span class="p">(</span><span class="n">season</span><span class="p">,</span><span class="w"> </span><span class="nf">desc</span><span class="p">(</span><span class="n">rain</span><span class="p">))</span><span class="w"> </span><span class="c1"># sort by season, then rainfall in descending order</span>
</pre></div>
</div>
</div>
<div class="section" id="using-distinct-to-find-unique-rows">
<h2>using distinct() to find unique rows<a class="headerlink" href="#using-distinct-to-find-unique-rows" title="Permalink to this headline">#</a></h2>
<p>To find unique rows in the dataset, we can use <code class="docutils literal notranslate"><span class="pre">distinct()</span></code>
(<a class="reference external" href="https://dplyr.tidyverse.org/reference/distinct.html">documentation</a>).
By itself, <code class="docutils literal notranslate"><span class="pre">distinct()</span></code> uses all of the variables to determine whether
rows are distinct; most of the time, we likely want to use it to find
unique values of a given variable:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nf">distinct</span><span class="p">(</span><span class="n">station</span><span class="p">)</span><span class="w"> </span><span class="c1"># find distinct values of station names</span>
</pre></div>
</div>
<p>We can also use it to find combinations of variables:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nf">distinct</span><span class="p">(</span><span class="n">station</span><span class="p">,</span><span class="w"> </span><span class="n">mm</span><span class="p">)</span><span class="w"> </span><span class="c1"># find distinct pairs of station and month values</span>
</pre></div>
</div>
<p>We can also use the <code class="docutils literal notranslate"><span class="pre">.keep_all</span></code> argument to keep the other columns
while filtering for unique rows:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nf">distinct</span><span class="p">(</span><span class="n">station</span><span class="p">,</span><span class="w"> </span><span class="n">mm</span><span class="p">,</span><span class="w"> </span><span class="n">.keep_all</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="c1"># keep all columns while finding distinct pairs of station and season values</span>
</pre></div>
</div>
<p>Note that the distinct values found above are all from the first year of
each dataset - this is because <code class="docutils literal notranslate"><span class="pre">distinct()</span></code> discards all but the first
occurrence of a unique row.</p>
</div>
<div class="section" id="counting-occurrences-with-count">
<h2>counting occurrences with count()<a class="headerlink" href="#counting-occurrences-with-count" title="Permalink to this headline">#</a></h2>
<p>If we want to count the number times a particular value occurs in the
table, we can use <code class="docutils literal notranslate"><span class="pre">count()</span></code>
(<a class="reference external" href="https://dplyr.tidyverse.org/reference/count.html">documentation</a>).
We can also use this in combination with other functions - for example,
we can count the number of times each station observed rainfall greater
than 150 mm in a month by first using <code class="docutils literal notranslate"><span class="pre">filter()</span></code> to select all rows
where <code class="docutils literal notranslate"><span class="pre">rain</span></code> is greater than 150, then use <code class="docutils literal notranslate"><span class="pre">count()</span></code> to count the
number of unique occurrences of <code class="docutils literal notranslate"><span class="pre">station</span></code> in the resulting table:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span><span class="n">rain</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">150</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nf">count</span><span class="p">(</span><span class="n">station</span><span class="p">,</span><span class="w"> </span><span class="n">sort</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="c1"># select all rows where rain &gt; 150, then count the number of occurrence of station, sorted in descending order</span>
</pre></div>
</div>
<p>From this, we can quickly see that Stornoway Airport, located in the
Outer Hebrides, has far more months with heavy rainfall (278) than any
other station in our dataset; by contrast, Oxford has only recorded 12
such months between 1853 and 2022.</p>
</div>
<div class="section" id="adding-variables-to-the-table-using-mutate">
<h2>adding variables to the table using mutate()<a class="headerlink" href="#adding-variables-to-the-table-using-mutate" title="Permalink to this headline">#</a></h2>
<p>In a previous exercise, we saw how we can use <strong>R</strong>’s built-in
functionality to add variables to a data frame:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">armagh</span><span class="o">$</span><span class="n">date</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.Date</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">armagh</span><span class="o">$</span><span class="n">yyyy</span><span class="p">,</span><span class="w"> </span><span class="n">armagh</span><span class="o">$</span><span class="n">mm</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="o">=</span><span class="s">&quot;/&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">format</span><span class="o">=</span><span class="s">&quot;%Y/%m/%d&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We can also use <code class="docutils literal notranslate"><span class="pre">mutate()</span></code>
(<a class="reference external" href="https://dplyr.tidyverse.org/reference/mutate.html">documentation</a>).
This is more flexible than the built-in functionality, because it also
allows us to add more than one new variable, and it allows us to specify
where to put the new variables(s) using the <code class="docutils literal notranslate"><span class="pre">.before</span></code> or <code class="docutils literal notranslate"><span class="pre">.after</span></code>
arguments. For example, to place the new <code class="docutils literal notranslate"><span class="pre">date</span></code> variable on the
left-hand side of the column, we can use <code class="docutils literal notranslate"><span class="pre">.before</span> <span class="pre">=</span> <span class="pre">1</span></code>:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nf">mutate</span><span class="p">(</span><span class="n">date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.Date</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">yyyy</span><span class="p">,</span><span class="w"> </span><span class="n">mm</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;%Y/%m/%d&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">.before</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="c1"># use mutate to add a date variable, before the other variables</span>
</pre></div>
</div>
<p>Note that we haven’t assigned the output, so <code class="docutils literal notranslate"><span class="pre">station_data</span></code> is
unchanged, and the new variable is only printed. We may want to
overwrite our existing data by assigning the output to the same
<strong>object</strong>, or we may want to create a new <strong>object</strong> with the output.
Ultimately, the choice depends on what we’re planning to do.</p>
<p>We can also use <code class="docutils literal notranslate"><span class="pre">mutate()</span></code> to add multiple variables to the table -
for example, adding the <code class="docutils literal notranslate"><span class="pre">season</span></code> and <code class="docutils literal notranslate"><span class="pre">date</span></code> variables as we saw
previously:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nf">mutate</span><span class="p">(</span>
<span class="w">    </span><span class="n">season</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">case_when</span><span class="p">(</span>
<span class="w">        </span><span class="n">mm</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">12</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&#39;winter&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1"># if month is 1, 2, or 12, set it to winter</span>
<span class="w">        </span><span class="n">mm</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="m">3</span><span class="o">:</span><span class="m">5</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&#39;spring&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1"># if month is 3, 4, 5, set it to spring</span>
<span class="w">        </span><span class="n">mm</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="m">6</span><span class="o">:</span><span class="m">8</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&#39;summer&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1"># if month is 6, 7, 8, set it to summer</span>
<span class="w">        </span><span class="n">mm</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="m">9</span><span class="o">:</span><span class="m">11</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s">&#39;autumn&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1"># if month is 9, 10, 11, set it to autumn</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">    </span><span class="n">date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.Date</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">yyyy</span><span class="p">,</span><span class="w"> </span><span class="n">mm</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="o">=</span><span class="s">&quot;/&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">format</span><span class="o">=</span><span class="s">&quot;%Y/%m/%d&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1"># add a date variable</span>
<span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">station_data</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, <code class="docutils literal notranslate"><span class="pre">mutate()</span></code> adds variables to the right hand side of the
table; in addition to specifying where to put them using <code class="docutils literal notranslate"><span class="pre">.before</span></code> and
<code class="docutils literal notranslate"><span class="pre">.after</span></code>, we will also see how we can re-arrange the variables in the
table later on.</p>
</div>
<div class="section" id="using-select-to-select-columns">
<h2>using select() to select columns<a class="headerlink" href="#using-select-to-select-columns" title="Permalink to this headline">#</a></h2>
<p>Sometimes, we might want to select a single variable, or a handful of
variables from a table - we can do this using <code class="docutils literal notranslate"><span class="pre">select()</span></code>
(<a class="reference external" href="https://dplyr.tidyverse.org/reference/select.html">documentation</a>):</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">station</span><span class="p">)</span><span class="w"> </span><span class="c1"># select only the date, tmax, and station variables</span>
</pre></div>
</div>
<p>We can also select a subset using a range of columns:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="n">tmax</span><span class="o">:</span><span class="n">sun</span><span class="p">)</span><span class="w"> </span><span class="c1"># select columns between tmax and sun (inclusive)</span>
</pre></div>
</div>
<p>and we can also select a subset by specifying which columns not to use:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="o">!</span><span class="n">tmax</span><span class="o">:</span><span class="n">sun</span><span class="p">)</span><span class="w"> </span><span class="c1"># select columns except those between tmax and sun (inclusive)</span>
</pre></div>
</div>
<p>And, we can also select columns by their type using <code class="docutils literal notranslate"><span class="pre">where()</span></code>
(<a class="reference external" href="https://tidyselect.r-lib.org/reference/where.html">documentation</a>).
For example, to select only variables that are <strong>numeric</strong>, we can use
the <code class="docutils literal notranslate"><span class="pre">is.numeric()</span></code> function
(<a class="reference external" href="https://rdrr.io/r/base/numeric.html">documentation</a>):</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="nf">where</span><span class="p">(</span><span class="n">is.numeric</span><span class="p">))</span><span class="w"> </span><span class="c1"># select only numeric variables</span>
</pre></div>
</div>
</div>
<div class="section" id="using-rename-to-rename-columns">
<h2>using rename() to rename columns<a class="headerlink" href="#using-rename-to-rename-columns" title="Permalink to this headline">#</a></h2>
<p>Often, we may also want to rename variables to make them easier to
read/understand. For example, the <code class="docutils literal notranslate"><span class="pre">yyyy</span></code>, <code class="docutils literal notranslate"><span class="pre">mm</span></code>, and <code class="docutils literal notranslate"><span class="pre">af</span></code> variables
in our table are not necessarily the easiest to understand. We can
rename them to more clear names, such as <code class="docutils literal notranslate"><span class="pre">year</span></code>, <code class="docutils literal notranslate"><span class="pre">month</span></code>, and
<code class="docutils literal notranslate"><span class="pre">air_frost</span></code>, using the <code class="docutils literal notranslate"><span class="pre">rename()</span></code> function
(<a class="reference external" href="https://dplyr.tidyverse.org/reference/rename.html">documentation</a>):</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nf">rename</span><span class="p">(</span><span class="n">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yyyy</span><span class="p">,</span><span class="w"> </span><span class="n">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mm</span><span class="p">,</span><span class="w"> </span><span class="n">air_frost</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">af</span><span class="p">)</span><span class="w"> </span><span class="c1"># rename yyyy to year, mm to month, and af to air_frost</span>

<span class="nf">print</span><span class="p">(</span><span class="n">station_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="using-relocate-to-move-columns">
<h2>using relocate() to move columns<a class="headerlink" href="#using-relocate-to-move-columns" title="Permalink to this headline">#</a></h2>
<p>With <code class="docutils literal notranslate"><span class="pre">mutate()</span></code>, we saw how we can specify where to put new variables,
using the <code class="docutils literal notranslate"><span class="pre">.before</span></code> and <code class="docutils literal notranslate"><span class="pre">.after</span></code> arguments. If we aren’t creating
new variables, we can still re-arrange variables using <code class="docutils literal notranslate"><span class="pre">relocate()</span></code>
(<a class="reference external" href="https://dplyr.tidyverse.org/reference/relocate.html">documentation</a>),
which works in much the same way. We can specify which column to move a
variable <code class="docutils literal notranslate"><span class="pre">.before</span></code> or <code class="docutils literal notranslate"><span class="pre">.after</span></code>; like with <code class="docutils literal notranslate"><span class="pre">select()</span></code>, we can also
move a range or selection of columns at once. In the cell below, we’re
going to first move <code class="docutils literal notranslate"><span class="pre">date</span></code> so that it is the first column (before
<code class="docutils literal notranslate"><span class="pre">year</span></code>); then, we move <code class="docutils literal notranslate"><span class="pre">season</span></code> so that it comes after <code class="docutils literal notranslate"><span class="pre">month</span></code>:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">relocate</span><span class="p">(</span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">.before</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">year</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w">  </span><span class="c1"># move date to before year</span>
<span class="w">    </span><span class="nf">relocate</span><span class="p">(</span><span class="n">season</span><span class="p">,</span><span class="w"> </span><span class="n">.after</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">month</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="c1"># move season to be after month</span>
<span class="n">station_data</span><span class="w"> </span><span class="c1"># use the -&gt; assignment operator to assign the output to station_data</span>

<span class="nf">print</span><span class="p">(</span><span class="n">station_data</span><span class="p">)</span>
</pre></div>
</div>
<p>In the cell above, note that we have used <code class="docutils literal notranslate"><span class="pre">-&gt;</span></code> (the <strong>right-hand
assignment operator</strong>) to assign the ouput of the second <code class="docutils literal notranslate"><span class="pre">relocate()</span></code>
function to the object <code class="docutils literal notranslate"><span class="pre">station_data</span></code>. Unlike the expression operator
we have used so far (<code class="docutils literal notranslate"><span class="pre">&lt;-</span></code>, the <strong>left-hand assignment operator</strong>),
<code class="docutils literal notranslate"><span class="pre">-&gt;</span></code> assigns the value of the expression on the left side of the
operator, and assigns it to the object on the <em>right-hand</em> side.</p>
<p>Normally, we tend to use <code class="docutils literal notranslate"><span class="pre">&lt;-</span></code>, but sometimes, especially with long
“sentences” with multiple function calls, it can make sense to use
<code class="docutils literal notranslate"><span class="pre">-&gt;</span></code> at the end, rather than the beginning - the end result will be
the same.</p>
</div>
<div class="section" id="saving-data-to-a-file">
<h2>saving data to a file<a class="headerlink" href="#saving-data-to-a-file" title="Permalink to this headline">#</a></h2>
<p>Finally, let’s save our cleaned, re-arranged dataset to a file, using
<code class="docutils literal notranslate"><span class="pre">write_csv()</span></code>
(<a class="reference external" href="https://readr.tidyverse.org/reference/write_delim.html">documentation</a>).
In the simplest case, <code class="docutils literal notranslate"><span class="pre">write_csv()</span></code> takes two arguments: first, the
data table to be written to disk, and second, the filename to write the
data to. We’ll save our file to the <code class="docutils literal notranslate"><span class="pre">'data'</span></code> folder, with a filename
of <strong>combined_stations.csv</strong>:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">write_csv</span><span class="p">(</span><span class="n">station_data</span><span class="p">,</span><span class="w"> </span><span class="nf">file.path</span><span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;combined_stations.csv&#39;</span><span class="p">))</span><span class="w"> </span><span class="c1"># write station_data to a file in the data folder</span>
</pre></div>
</div>
<p>Now, we’ll be able to load this file when we want to do further
analysis, rather than needing to re-run the steps to load each file,
combine the tables, create new variables, and so on. We’re continuing to
use a <strong>comma-separated variable</strong> (<strong>.csv</strong>) file format, though there
are a number of different format options available - for more
information, check the
<a class="reference external" href="https://readr.tidyverse.org/reference/write_delim.html">documentation</a>.</p>
</div>
<div class="section" id="grouping-data">
<h2>grouping data<a class="headerlink" href="#grouping-data" title="Permalink to this headline">#</a></h2>
<p>Next, we’ll see how we can use different tools to aggregate and
summarize our data, starting with <code class="docutils literal notranslate"><span class="pre">group_by()</span></code>
(<a class="reference external" href="https://dplyr.tidyverse.org/reference/group_by.html">documentation</a>).
To start, we’ll group the data by <code class="docutils literal notranslate"><span class="pre">station</span></code>:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="nf">group_by</span><span class="p">(</span><span class="n">station</span><span class="p">)</span><span class="w"> </span><span class="c1"># group the data by station</span>
</pre></div>
</div>
<p>This looks largely the same as the previous output, with one important
distinction: this is now a <strong>grouped_df</strong>, rather than a <strong>spec_tbl_df</strong>
- this means that when we call the <code class="docutils literal notranslate"><span class="pre">summarize()</span></code>
(<a class="reference external" href="https://dplyr.tidyverse.org/reference/summarise.html">documentation</a>)
function on the output, the summary is calculated based on each <em>group</em>,
rather than all values of the variable. For example, if we want to
calculate the mean of <code class="docutils literal notranslate"><span class="pre">tmax</span></code> for each station:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">group_by</span><span class="p">(</span><span class="n">station</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="c1"># group the data by station</span>
<span class="w">    </span><span class="nf">summarize</span><span class="p">(</span>
<span class="w">        </span><span class="n">tmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="c1"># calculate the mean of tmax, ignoring NA values</span>
<span class="w">    </span><span class="p">)</span>
</pre></div>
</div>
<p>We can also group based on multiple variables - for example, by both
<code class="docutils literal notranslate"><span class="pre">station</span></code> and <code class="docutils literal notranslate"><span class="pre">season</span></code>:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">group_by</span><span class="p">(</span><span class="n">station</span><span class="p">,</span><span class="w"> </span><span class="n">season</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="c1"># group the data by station, then season</span>
<span class="w">    </span><span class="nf">summarize</span><span class="p">(</span>
<span class="w">        </span><span class="n">tmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="c1"># calculate the mean of tmax, ignoring NA values</span>
<span class="w">        </span><span class="n">rain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">rain</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">  </span><span class="c1"># calculate the mean of rain, ignoring NA values</span>
<span class="w">    </span><span class="p">)</span>
</pre></div>
</div>
<p>Now, let’s combine this with what we learned in the previous lesson (the
plotting exercise) to create a plot that shows the distribution of
rainfall by season, separated by station.</p>
<p>First, we want to create a plot that shows the density distribution of
rainfall for each season, using <code class="docutils literal notranslate"><span class="pre">facet_wrap()</span></code> to create a single
panel for each station:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">station_data</span><span class="p">,</span><span class="w"> </span><span class="n">mapping</span><span class="o">=</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">rain</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="c1"># create a plot with tmax on the x-axis, colored by season</span>
<span class="w">    </span><span class="nf">geom_density</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="nf">aes</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">season</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">season</span><span class="p">),</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.4</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="c1"># add a density plot with transparency of 0.4 and lines of width 1</span>
<span class="w">    </span><span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">station</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="c1"># create one panel for each station</span>
<span class="n">rain_plot</span><span class="w"> </span><span class="c1"># assign the plot to a variable</span>

<span class="n">rain_plot</span>
</pre></div>
</div>
<p>Next, we can use <code class="docutils literal notranslate"><span class="pre">group_by()</span></code> and <code class="docutils literal notranslate"><span class="pre">summarize()</span></code> to calculate the
mean rainfall for each station, and assign this to a new object,
<code class="docutils literal notranslate"><span class="pre">mean_values</span></code>:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mean_values</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">group_by</span><span class="p">(</span><span class="n">station</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="c1"># group by station value</span>
<span class="w">    </span><span class="nf">summarize</span><span class="p">(</span><span class="n">rain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">rain</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span><span class="w"> </span><span class="c1"># calculate the mean of rain, ignoring NA values</span>
</pre></div>
</div>
<p>Now, to add a vertical line to our plot, we use <code class="docutils literal notranslate"><span class="pre">geom_vline()</span></code>
(<a class="reference external" href="https://ggplot2.tidyverse.org/reference/geom_abline.html">documentation</a>),
along with <code class="docutils literal notranslate"><span class="pre">mean_values</span></code>, to place a vertical line in each panel where
the mean rainfall value is:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">rain_plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rain_plot</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean_values</span><span class="p">,</span><span class="w"> </span><span class="n">mapping</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">xintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rain</span><span class="p">),</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;dashed&#39;</span><span class="p">)</span><span class="w"> </span><span class="c1"># add dashed vertical lines at the mean rainfall value</span>

<span class="n">rain_plot</span>
</pre></div>
</div>
<p>In the next panel, write some lines of code to change the axes labels
and increase the font size for the tick labels, axis labels, and panel
labels.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code goes here!</span>
</pre></div>
</div>
<p>Now that you have finished the plot, be sure to save it to a file:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggsave</span><span class="p">(</span><span class="s">&#39;seasonal_rain_distribution.png&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">plot</span><span class="o">=</span><span class="n">rain_plot</span><span class="p">)</span><span class="w"> </span><span class="c1"># save the plot to a file</span>
</pre></div>
</div>
</div>
<div class="section" id="slicing-the-dataset">
<h2>slicing the dataset<a class="headerlink" href="#slicing-the-dataset" title="Permalink to this headline">#</a></h2>
<p>We’ll finish up by looking at a few functions that we can use to <em>slice</em>
a dataset - that is, extract specific rows from a group. For example, we
can combine <code class="docutils literal notranslate"><span class="pre">group_by()</span></code> and <code class="docutils literal notranslate"><span class="pre">slice_max()</span></code>
(<a class="reference external" href="https://dplyr.tidyverse.org/reference/slice.html">documentation</a>)
to find the maximum monthly temperature from each season:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">group_by</span><span class="p">(</span><span class="n">season</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">slice_max</span><span class="p">(</span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="c1"># take the top n rows based on the value of tmax</span>
</pre></div>
</div>
<p>This lets us quickly see the observations corresponding to the highest
temperature in each season - split between Southampton for autumn and
spring, and Oxford for summer and winter. If we want to select the
minimum, we can use <code class="docutils literal notranslate"><span class="pre">slice_min()</span></code>:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">group_by</span><span class="p">(</span><span class="n">season</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">slice_min</span><span class="p">(</span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="c1"># take the bottom n rows based on the value of tmax</span>
</pre></div>
</div>
<p>Here, you can also see that by default, <code class="docutils literal notranslate"><span class="pre">slice_min()</span></code> (and
<code class="docutils literal notranslate"><span class="pre">slice_max()</span></code>) keep tied values - so we end up with 6 rows instead of
4. If we want to discard ties, we can use the <code class="docutils literal notranslate"><span class="pre">.with_ties</span></code> argument
set to <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>.</p>
<p>If we only want the first or last row from a group, regardless of the
value, we can use <code class="docutils literal notranslate"><span class="pre">slice_head()</span></code> to select the first n rows, and
<code class="docutils literal notranslate"><span class="pre">slice_tail()</span></code> to select the last n rows:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">group_by</span><span class="p">(</span><span class="n">season</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">slice_head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="c1"># take the first n rows</span>
</pre></div>
</div>
<p>Finally, we can select a random sample from each group using
<code class="docutils literal notranslate"><span class="pre">slice_sample()</span></code>:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">group_by</span><span class="p">(</span><span class="n">season</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">slice_sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="c1"># take a random sample of 5 rows from each season</span>
</pre></div>
</div>
</div>
<div class="section" id="using-ungroup-to-remove-groups">
<h2>using ungroup() to remove groups<a class="headerlink" href="#using-ungroup-to-remove-groups" title="Permalink to this headline">#</a></h2>
<p>Sometimes, we want to group data using <code class="docutils literal notranslate"><span class="pre">group_by()</span></code> to do some kind of
calculations, but then we want to get rid of the groups - for example,
if we want to find the top 5 warmest average months, regardless of what
station they are measured at.</p>
<p>To do this, we can use <code class="docutils literal notranslate"><span class="pre">ungroup()</span></code>
(<a class="reference external" href="https://dplyr.tidyverse.org/reference/group_by.html">documentation</a>)
to remove the grouping:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">group_by</span><span class="p">(</span><span class="n">station</span><span class="p">,</span><span class="w"> </span><span class="n">month</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="c1"># group by station, season</span>
<span class="w">    </span><span class="nf">summarize</span><span class="p">(</span><span class="n">tmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="c1"># calculate the average of tmax</span>
<span class="w">    </span><span class="nf">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="c1"># use ungroup to remove the grouping by station and season on the output of summarize</span>
<span class="w">    </span><span class="nf">slice_max</span><span class="p">(</span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="c1"># select the 5 rows with the highest value of tmax</span>
</pre></div>
</div>
<p>Note that without this, we would end up with 20 rows - 5 for each group:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">group_by</span><span class="p">(</span><span class="n">station</span><span class="p">,</span><span class="w"> </span><span class="n">month</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="c1"># group by station, season</span>
<span class="w">    </span><span class="nf">summarize</span><span class="p">(</span><span class="n">tmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="c1"># calculate the average of tmax</span>
<span class="w">    </span><span class="nf">slice_max</span><span class="p">(</span><span class="n">tmax</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="c1"># select the 5 rows with the highest value of tmax</span>
</pre></div>
</div>
</div>
<div class="section" id="exercise-and-next-steps">
<h2>exercise and next steps<a class="headerlink" href="#exercise-and-next-steps" title="Permalink to this headline">#</a></h2>
<p>That’s all for this exercise. To practice your skills, create a notebook
file that does the following:</p>
<ul class="simple">
<li><p>loads the libraries that you need</p></li>
<li><p>loads the saved data file (<strong>combined_stations.csv</strong>)</p></li>
<li><p>helps you answer the following questions:</p>
<ul>
<li><p>what station has the highest recorded rainfall in the past 20
years, and on what date?</p></li>
<li><p>what season has the lowest average rainfall? is it the same season
for all four stations?</p></li>
<li><p>what station has recorded the most months with <code class="docutils literal notranslate"><span class="pre">tmin</span></code> &lt; 1°C? are
all these observations from a single season?</p></li>
<li><p>what is the median rainfall in months where <code class="docutils literal notranslate"><span class="pre">tmax</span></code> is greater
than 20°C? make sure that your result is a number, not a tibble!</p></li>
<li><p>what year saw the most total rainfall, using data from all four
stations?</p></li>
<li><p>what are the top 5 driest years, using only data from stations in
Britain?</p></li>
<li><p>what is the lowest annually-averaged monthly minimum temperature
in the dataset, as measured by a single station?</p></li>
<li><p>what is the sunniest month, on average, in Armagh?</p>
<ul>
<li><p>bonus: write a line that will rename the months from the number
to a 3-letter abbreviation
(<a class="reference external" href="https://r-lang.com/month-abb-in-r-with-example/">hint</a>)</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>For a bonus, try downloading at least one additional dataset from the
<a class="reference external" href="https://www.metoffice.gov.uk/research/climate/maps-and-data/historic-station-data">Met
Office</a>,
saving it to the <strong>data</strong> folder. Next, open a <strong>Terminal</strong> and enter
the following:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>python convert_metoffice.py data/{station}
</pre></div>
</div>
<p>remembering to replace <code class="docutils literal notranslate"><span class="pre">{station}</span></code> with the name of the file that you
just downloaded (e.g., <code class="docutils literal notranslate"><span class="pre">durhamdata.txt</span></code>). This will convert the
<code class="docutils literal notranslate"><span class="pre">.txt</span></code> file into a <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file, using the steps outlined at the top
of the exercise.</p>
</div>
</div>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="plotting.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">plotting data using ggplot2</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="stats.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">basic statistical analysis using <strong>R</strong></p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Bob McNabb<br/>
  
      &copy; Copyright 2023, Bob McNabb. Licensed under Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0).<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>